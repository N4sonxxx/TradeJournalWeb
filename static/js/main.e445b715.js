/*! For license information please see main.e445b715.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,g(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,_={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var s,i={},a=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)k.call(t,s)&&!N.hasOwnProperty(s)&&(i[s]=t[s]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===i[s]&&(i[s]=l[s]);return{$$typeof:n,type:e,key:a,ref:o,props:i,_owner:_.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,s,i,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===i?"."+C(l,0):i,w(a)?(s="",null!=e&&(s=e.replace(T,"$&/")+"/"),I(a,t,s,"",function(e){return e})):null!=a&&(S(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,s+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(T,"$&/")+"/")+e)),t.push(a)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var u=i+C(o=e[c],c);l+=I(o,t,s,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=I(o=o.value,t,s,u=i+C(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function j(e,t,n){if(null==e)return e;var r=[],s=0;return I(e,r,"","",function(e){return t.call(n,e,s++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},D={transition:null},P={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:D,ReactCurrentOwner:_};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:j,forEach:function(e,t,n){j(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return j(e,function(){t++}),t},toArray:function(e){return j(e,function(e){return e})||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=s,t.Profiler=a,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=g({},e.props),i=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=_.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!N.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:n,type:e.type,key:i,ref:a,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,s=e[r];if(!(0<i(s,t)))break e;e[r]=t,e[n]=s,n=r}}function r(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,s=e.length,a=s>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<s&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<s&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)s(u);else{if(!(t.startTime<=e))break;s(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(m=!1,x(e),!g)if(null!==r(c))g=!0,D(k);else{var t=r(u);null!==t&&P(w,t.startTime-e)}}function k(e,n){g=!1,m&&(m=!1,v(S),S=-1),p=!0;var i=f;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!I());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&s(c),x(n)}else s(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&P(w,d.startTime-n),l=!1}return l}finally{h=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,N=!1,E=null,S=-1,T=5,C=-1;function I(){return!(t.unstable_now()-C<T)}function j(){if(null!==E){var e=t.unstable_now();C=e;var n=!0;try{n=E(!0,e)}finally{n?_():(N=!1,E=null)}}else N=!1}if("function"===typeof b)_=function(){b(j)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,R=A.port2;A.port1.onmessage=j,_=function(){R.postMessage(null)}}else _=function(){y(j,0)};function D(e){E=e,N||(N=!0,_())}function P(e,n){S=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,D(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,s,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>a?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(m?(v(S),S=-1):m=!0,P(w,i-a))):(e.sortIndex=o,n(c,e),g||p||(g=!0,D(k))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),s=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,s,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var s=m.hasOwnProperty(t)?m[t]:null;(null!==s?0!==s.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,r)&&(n=null),r||null===s?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,r=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),T=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var O,M=Object.assign;function F(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),i=r.stack.split("\n"),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(1!==a||1!==o)do{if(a--,0>--o||s[a]!==i[o]){var l="\n"+s[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case k:return"Portal";case E:return"Profiler";case N:return"StrictMode";case I:return"Suspense";case j:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){J(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(r&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function ie(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),s=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,_e=null,Ne=null;function Ee(e){if(e=bs(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=ws(t),ke(e.stateNode,e.type,t))}}function Se(e){_e?Ne?Ne.push(e):Ne=[e]:_e=e}function Te(){if(_e){var e=_e,t=Ne;if(Ne=_e=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ce(e,t){return e(t)}function Ie(){}var je=!1;function Ae(e,t,n){if(je)return e(t,n);je=!0;try{return Ce(e,t,n)}finally{je=!1,(null!==_e||null!==Ne)&&(Ie(),Te())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=ws(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ue){De=!1}function Le(e,t,n,r,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Me=null,Fe=!1,Ue=null,Ve={onError:function(e){Oe=!0,Me=e}};function ze(e,t,n,r,s,i,a,o,l){Oe=!1,Me=null,Le.apply(Ve,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Be(e)!==e)throw Error(i(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var a=s.alternate;if(null===a){if(null!==(r=s.return)){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return qe(s),e;if(a===r)return qe(s),t;a=a.sibling}throw Error(i(188))}if(n.return!==r.return)n=s,r=a;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ge=s.unstable_scheduleCallback,Ke=s.unstable_cancelCallback,Qe=s.unstable_shouldYield,Ye=s.unstable_requestPaint,Je=s.unstable_now,Xe=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,rt=s.unstable_IdlePriority,st=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~s;0!==o?r=dt(o):0!==(i&=a)&&(r=dt(i))}else 0!==(a=n&~s)?r=dt(a):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(i=t&-t)||16===s&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)s=1<<(n=31-at(t)),r|=e[n],t&=~s;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,_t,Nt,Et,St=!1,Tt=[],Ct=null,It=null,jt=null,At=new Map,Rt=new Map,Dt=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":jt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Ot(e,t,n,r,s,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},null!==t&&(null!==(t=bs(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Mt(e){var t=vs(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void Et(e.priority,function(){_t(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bs(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Vt(){St=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==It&&Ft(It)&&(It=null),null!==jt&&Ft(jt)&&(jt=null),At.forEach(Ut),Rt.forEach(Ut)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Vt)))}function Bt(e){function t(t){return zt(t,e)}if(0<Tt.length){zt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&zt(Ct,e),null!==It&&zt(It,e),null!==jt&&zt(jt,e),At.forEach(t),Rt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Dt.shift()}var $t=x.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var s=bt,i=$t.transition;$t.transition=null;try{bt=1,Gt(e,t,n,r)}finally{bt=s,$t.transition=i}}function Wt(e,t,n,r){var s=bt,i=$t.transition;$t.transition=null;try{bt=4,Gt(e,t,n,r)}finally{bt=s,$t.transition=i}}function Gt(e,t,n,r){if(qt){var s=Qt(e,t,n,r);if(null===s)qr(e,t,r,Kt,n),Lt(e,r);else if(function(e,t,n,r,s){switch(t){case"focusin":return Ct=Ot(Ct,e,t,n,r,s),!0;case"dragenter":return It=Ot(It,e,t,n,r,s),!0;case"mouseover":return jt=Ot(jt,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return At.set(i,Ot(At.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Rt.set(i,Ot(Rt.get(i)||null,e,t,n,r,s)),!0}return!1}(s,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==s;){var i=bs(s);if(null!==i&&wt(i),null===(i=Qt(e,t,n,r))&&qr(e,t,r,Kt,n),i===s)break;s=i}null!==s&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Kt=null;function Qt(e,t,n,r){if(Kt=null,null!==(e=vs(e=we(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,s="value"in Jt?Jt.value:Jt.textContent,i=s.length;for(e=0;e<r&&n[e]===s[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===s[i-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,s,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=M({},cn,{view:0,detail:0}),hn=sn(dn),fn=M({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),gn=sn(M({},fn,{dataTransfer:0})),mn=sn(M({},dn,{relatedTarget:0})),yn=sn(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),xn=sn(M({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function En(){return Nn}var Sn=M({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=sn(Sn),Cn=sn(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=sn(M({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),jn=sn(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(An),Dn=[9,13,27,32],Pn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var On=u&&"TextEvent"in window&&!Ln,Mn=u&&(!Pn||Ln&&8<Ln&&11>=Ln),Fn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function Hn(e,t,n,r){Se(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Gn=null;function Kn(e){Fr(e,0)}function Qn(e){if(G(xs(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Gn=Wn=null)}function nr(e){if("value"===e.propertyName&&Qn(Gn)){var t=[];Hn(t,Gn,e,we(e)),Ae(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Gn)}function ir(e,t){if("click"===e)return Qn(t)}function ar(e,t){if("input"===e||"change"===e)return Qn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!d.call(t,s)||!or(e[s],t[s]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=void 0===r.end?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=ur(n,i);var a=ur(n,r);s&&a&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,vr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Wr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},_r={},Nr={};function Er(e){if(_r[e])return _r[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Nr)return _r[e]=n[t];return e}u&&(Nr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Sr=Er("animationend"),Tr=Er("animationiteration"),Cr=Er("animationstart"),Ir=Er("transitionend"),jr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){jr.set(e,t),l(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Pr=Ar[Dr];Rr(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Rr(Sr,"onAnimationEnd"),Rr(Tr,"onAnimationIteration"),Rr(Cr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Ir,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,a,o,l,c){if(ze.apply(this,arguments),Oe){if(!Oe)throw Error(i(198));var u=Me;Oe=!1,Me=null,Fe||(Fe=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;Mr(s,o,c),i=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;Mr(s,o,c),i=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[gs];void 0===n&&(n=t[gs]=new Set);var r=e+"__bubble";n.has(r)||($r(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),$r(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[zr]){e[zr]=!0,a.forEach(function(t){"selectionchange"!==t&&(Or.has(t)||Vr(t,!1,e),Vr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Vr("selectionchange",!1,t))}}function $r(e,t,n,r){switch(Yt(t)){case 1:var s=Ht;break;case 4:s=Wt;break;default:s=Gt}n=s.bind(null,t,n,e),s=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),r?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,s){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;a=a.return}for(;null!==o;){if(null===(a=vs(o)))return;if(5===(l=a.tag)||6===l){r=i=a;continue e}o=o.parentNode}}r=r.return}Ae(function(){var r=i,s=we(n),a=[];e:{var o=jr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Sr:case Tr:case Cr:l=yn;break;case Ir:l=jn;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Re(p,h))&&u.push(Hr(p,g,f)))),d)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,s),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!vs(c)&&!c[ps])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vs(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:xs(l),f=null==c?o:xs(c),(o=new u(g,p+"leave",l,n,s)).target=d,o.relatedTarget=f,g=null,vs(s)===r&&((u=new u(h,p+"enter",c,n,s)).target=f,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Gr(f))p++;for(f=0,g=h;g;g=Gr(g))f++;for(;0<p-f;)u=Gr(u),p--;for(;0<f-p;)h=Gr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Gr(u),h=Gr(h)}u=null}else u=null;null!==l&&Kr(a,o,l,u,!1),null!==c&&null!==d&&Kr(a,d,c,u,!0)}if("select"===(l=(o=r?xs(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var m=Yn;else if(qn(o))if(Jn)m=ar;else{m=sr;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=ir);switch(m&&(m=m(e,r))?Hn(a,m,n,s):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?xs(r):window,e){case"focusin":(qn(y)||"true"===y.contentEditable)&&(mr=y,yr=r,vr=null);break;case"focusout":vr=yr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(a,n,s);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":xr(a,n,s)}var v;if(Pn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Mn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(v=en()):(Xt="value"in(Jt=s)?Jt.value:Jt.textContent,Bn=!0)),0<(y=Wr(r,b)).length&&(b=new xn(b,e,null,n,s),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=zn(n))&&(b.data=v))),(v=On?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Pn&&Vn(e,t)?(e=en(),Zt=Xt=Jt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(s=new xn("onBeforeInput","beforeinput",null,n,s),a.push({event:s,listeners:r}),s.data=v))}Fr(a,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var s=e,i=s.stateNode;5===s.tag&&null!==i&&(s=i,null!=(i=Re(e,n))&&r.unshift(Hr(e,i,s)),null!=(i=Re(e,t))&&r.push(Hr(e,i,s))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,s){for(var i=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=Re(n,i))&&a.unshift(Hr(n,l,o)):s||null!=(l=Re(n,i))&&a.push(Hr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(i(425))}function Zr(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,is="function"===typeof Promise?Promise:void 0,as="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof is?function(e){return is.resolve(null).then(e).catch(os)}:rs;function os(e){setTimeout(function(){throw e})}function ls(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===r)return e.removeChild(s),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=s}while(n);Bt(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function us(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ds=Math.random().toString(36).slice(2),hs="__reactFiber$"+ds,fs="__reactProps$"+ds,ps="__reactContainer$"+ds,gs="__reactEvents$"+ds,ms="__reactListeners$"+ds,ys="__reactHandles$"+ds;function vs(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ps]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=us(e);null!==e;){if(n=e[hs])return n;e=us(e)}return t}n=(e=n).parentNode}return null}function bs(e){return!(e=e[hs]||e[ps])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ws(e){return e[fs]||null}var ks=[],_s=-1;function Ns(e){return{current:e}}function Es(e){0>_s||(e.current=ks[_s],ks[_s]=null,_s--)}function Ss(e,t){_s++,ks[_s]=e.current,e.current=t}var Ts={},Cs=Ns(Ts),Is=Ns(!1),js=Ts;function As(e,t){var n=e.type.contextTypes;if(!n)return Ts;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s,i={};for(s in n)i[s]=t[s];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Rs(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ds(){Es(Is),Es(Cs)}function Ps(e,t,n){if(Cs.current!==Ts)throw Error(i(168));Ss(Cs,t),Ss(Is,n)}function Ls(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(i(108,$(e)||"Unknown",s));return M({},n,r)}function Os(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ts,js=Cs.current,Ss(Cs,e),Ss(Is,Is.current),!0}function Ms(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ls(e,t,js),r.__reactInternalMemoizedMergedChildContext=e,Es(Is),Es(Cs),Ss(Cs,e)):Es(Is),Ss(Is,n)}var Fs=null,Us=!1,Vs=!1;function zs(e){null===Fs?Fs=[e]:Fs.push(e)}function Bs(){if(!Vs&&null!==Fs){Vs=!0;var e=0,t=bt;try{var n=Fs;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fs=null,Us=!1}catch(s){throw null!==Fs&&(Fs=Fs.slice(e+1)),Ge(Ze,Bs),s}finally{bt=t,Vs=!1}}return null}var $s=[],qs=0,Hs=null,Ws=0,Gs=[],Ks=0,Qs=null,Ys=1,Js="";function Zs(e,t){$s[qs++]=Ws,$s[qs++]=Hs,Hs=e,Ws=t}function ei(e,t,n){Gs[Ks++]=Ys,Gs[Ks++]=Js,Gs[Ks++]=Qs,Qs=e;var r=Ys;e=Js;var s=32-at(r)-1;r&=~(1<<s),n+=1;var i=32-at(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Ys=1<<32-at(t)+s|n<<s|r,Js=i+e}else Ys=1<<i|n<<s|r,Js=e}function ti(e){null!==e.return&&(Zs(e,1),ei(e,1,0))}function ni(e){for(;e===Hs;)Hs=$s[--qs],$s[qs]=null,Ws=$s[--qs],$s[qs]=null;for(;e===Qs;)Qs=Gs[--Ks],Gs[Ks]=null,Js=Gs[--Ks],Gs[Ks]=null,Ys=Gs[--Ks],Gs[Ks]=null}var ri=null,si=null,ii=!1,ai=null;function oi(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function li(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,si=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,si=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qs?{id:Ys,overflow:Js}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ri=e,si=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ui(e){if(ii){var t=si;if(t){var n=t;if(!li(e,t)){if(ci(e))throw Error(i(418));t=cs(n.nextSibling);var r=ri;t&&li(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ii=!1,ri=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ii=!1,ri=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function hi(e){if(e!==ri)return!1;if(!ii)return di(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=si)){if(ci(e))throw fi(),Error(i(418));for(;t;)oi(e,t),t=cs(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){si=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}si=null}}else si=ri?cs(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=si;e;)e=cs(e.nextSibling)}function pi(){si=ri=null,ii=!1}function gi(e){null===ai?ai=[e]:ai.push(e)}var mi=x.ReactCurrentBatchConfig;function yi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var s=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=s.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===_?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===R&&bi(i)===t.type)?((r=s(t,n.props)).ref=yi(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=yi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vc(n,e.mode,r)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,i)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=yi(e,null,t),n.return=e,n;case k:return(t=Vc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Mc(t,e.mode,n,null)).return=e,t;vi(e,t)}return null}function f(e,t,n,r){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,r):null;case k:return n.key===s?u(e,t,n,r):null;case R:return f(e,t,(s=n._init)(n._payload),r)}if(te(n)||L(n))return null!==s?null:d(e,t,n,r,null);vi(e,n)}return null}function p(e,t,n,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,s);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,s);case R:return p(e,t,n,(0,r._init)(r._payload),s)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,s,null);vi(t,r)}return null}function g(s,i,o,l){for(var c=null,u=null,d=i,g=i=0,m=null;null!==d&&g<o.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=f(s,d,o[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(s,d),i=a(y,i,g),null===u?c=y:u.sibling=y,u=y,d=m}if(g===o.length)return n(s,d),ii&&Zs(s,g),c;if(null===d){for(;g<o.length;g++)null!==(d=h(s,o[g],l))&&(i=a(d,i,g),null===u?c=d:u.sibling=d,u=d);return ii&&Zs(s,g),c}for(d=r(s,d);g<o.length;g++)null!==(m=p(d,s,g,o[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),i=a(m,i,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(s,e)}),ii&&Zs(s,g),c}function m(s,o,l,c){var u=L(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,g=o,m=o=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=f(s,g,v.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(s,g),o=a(b,o,m),null===d?u=b:d.sibling=b,d=b,g=y}if(v.done)return n(s,g),ii&&Zs(s,m),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(s,v.value,c))&&(o=a(v,o,m),null===d?u=v:d.sibling=v,d=v);return ii&&Zs(s,m),u}for(g=r(s,g);!v.done;m++,v=l.next())null!==(v=p(g,s,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),o=a(v,o,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach(function(e){return t(s,e)}),ii&&Zs(s,m),u}return function e(r,i,a,l){if("object"===typeof a&&null!==a&&a.type===_&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,u=i;null!==u;){if(u.key===c){if((c=a.type)===_){if(7===u.tag){n(r,u.sibling),(i=s(u,a.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&bi(c)===u.type){n(r,u.sibling),(i=s(u,a.props)).ref=yi(r,u,a),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===_?((i=Mc(a.props.children,r.mode,l,a.key)).return=r,r=i):((l=Oc(a.type,a.key,a.props,null,r.mode,l)).ref=yi(r,i,a),l.return=r,r=l)}return o(r);case k:e:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(r,i.sibling),(i=s(i,a.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Vc(a,r.mode,l)).return=r,r=i}return o(r);case R:return e(r,i,(u=a._init)(a._payload),l)}if(te(a))return g(r,i,a,l);if(L(a))return m(r,i,a,l);vi(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(r,i.sibling),(i=s(i,a)).return=r,r=i):(n(r,i),(i=Uc(a,r.mode,l)).return=r,r=i),o(r)):n(r,i)}}var wi=xi(!0),ki=xi(!1),_i=Ns(null),Ni=null,Ei=null,Si=null;function Ti(){Si=Ei=Ni=null}function Ci(e){var t=_i.current;Es(_i),e._currentValue=t}function Ii(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ji(e,t){Ni=e,Si=Ei=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wo=!0),e.firstContext=null)}function Ri(e){var t=e._currentValue;if(Si!==e)if(e={context:e,memoizedValue:t,next:null},null===Ei){if(null===Ni)throw Error(i(308));Ei=e,Ni.dependencies={lanes:0,firstContext:e}}else Ei=Ei.next=e;return t}var Di=null;function Pi(e){null===Di?Di=[e]:Di.push(e)}function Li(e,t,n,r){var s=t.interleaved;return null===s?(n.next=n,Pi(t)):(n.next=s.next,s.next=n),t.interleaved=n,Oi(e,r)}function Oi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Mi=!1;function Fi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ui(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Vi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&jl)){var s=r.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Oi(e,n)}return null===(s=r.interleaved)?(t.next=t,Pi(r)):(t.next=s.next,s.next=t),r.interleaved=t,Oi(e,n)}function Bi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function $i(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var s=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?s=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?s=i=t:i=i.next=t}else s=i=t;return n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qi(e,t,n,r){var s=e.updateQueue;Mi=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=s.baseState;for(a=0,u=c=l=null,o=i;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,g=o;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=M({},d,h);break e;case 2:Mi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(h=o).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===u&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(t=s.shared.interleaved)){s=t;do{a|=s.lane,s=s.next}while(s!==t)}else null===i&&(s.shared.lanes=0);Fl|=a,e.lanes=a,e.memoizedState=d}}function Hi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!==typeof s)throw Error(i(191,s));s.call(r)}}}var Wi={},Gi=Ns(Wi),Ki=Ns(Wi),Qi=Ns(Wi);function Yi(e){if(e===Wi)throw Error(i(174));return e}function Ji(e,t){switch(Ss(Qi,t),Ss(Ki,e),Ss(Gi,Wi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Es(Gi),Ss(Gi,t)}function Xi(){Es(Gi),Es(Ki),Es(Qi)}function Zi(e){Yi(Qi.current);var t=Yi(Gi.current),n=le(t,e.type);t!==n&&(Ss(Ki,e),Ss(Gi,n))}function ea(e){Ki.current===e&&(Es(Gi),Es(Ki))}var ta=Ns(0);function na(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ra=[];function sa(){for(var e=0;e<ra.length;e++)ra[e]._workInProgressVersionPrimary=null;ra.length=0}var ia=x.ReactCurrentDispatcher,aa=x.ReactCurrentBatchConfig,oa=0,la=null,ca=null,ua=null,da=!1,ha=!1,fa=0,pa=0;function ga(){throw Error(i(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ya(e,t,n,r,s,a){if(oa=a,la=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?eo:to,e=n(r,s),ha){a=0;do{if(ha=!1,fa=0,25<=a)throw Error(i(301));a+=1,ua=ca=null,t.updateQueue=null,ia.current=no,e=n(r,s)}while(ha)}if(ia.current=Za,t=null!==ca&&null!==ca.next,oa=0,ua=ca=la=null,da=!1,t)throw Error(i(300));return e}function va(){var e=0!==fa;return fa=0,e}function ba(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ua?la.memoizedState=ua=e:ua=ua.next=e,ua}function xa(){if(null===ca){var e=la.alternate;e=null!==e?e.memoizedState:null}else e=ca.next;var t=null===ua?la.memoizedState:ua.next;if(null!==t)ua=t,ca=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ca=e).memoizedState,baseState:ca.baseState,baseQueue:ca.baseQueue,queue:ca.queue,next:null},null===ua?la.memoizedState=ua=e:ua=ua.next=e}return ua}function wa(e,t){return"function"===typeof t?t(e):t}function ka(e){var t=xa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ca,s=r.baseQueue,a=n.pending;if(null!==a){if(null!==s){var o=s.next;s.next=a.next,a.next=o}r.baseQueue=s=a,n.pending=null}if(null!==s){a=s.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((oa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,la.lanes|=d,Fl|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(wo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{a=s.lane,la.lanes|=a,Fl|=a,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _a(e){var t=xa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,a=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{a=e(a,o.action),o=o.next}while(o!==s);or(a,t.memoizedState)||(wo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Na(){}function Ea(e,t){var n=la,r=xa(),s=t(),a=!or(r.memoizedState,s);if(a&&(r.memoizedState=s,wo=!0),r=r.queue,Ma(Ca.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ua&&1&ua.memoizedState.tag){if(n.flags|=2048,Ra(9,Ta.bind(null,n,r,s,t),void 0,null),null===Al)throw Error(i(349));0!==(30&oa)||Sa(n,t,s)}return s}function Sa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=la.updateQueue)?(t={lastEffect:null,stores:null},la.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ta(e,t,n,r){t.value=n,t.getSnapshot=r,Ia(t)&&ja(e)}function Ca(e,t,n){return n(function(){Ia(t)&&ja(e)})}function Ia(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function ja(e){var t=Oi(e,1);null!==t&&sc(t,e,1,-1)}function Aa(e){var t=ba();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:e},t.queue=e,e=e.dispatch=Qa.bind(null,la,e),[t.memoizedState,e]}function Ra(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=la.updateQueue)?(t={lastEffect:null,stores:null},la.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Da(){return xa().memoizedState}function Pa(e,t,n,r){var s=ba();la.flags|=e,s.memoizedState=Ra(1|t,n,void 0,void 0===r?null:r)}function La(e,t,n,r){var s=xa();r=void 0===r?null:r;var i=void 0;if(null!==ca){var a=ca.memoizedState;if(i=a.destroy,null!==r&&ma(r,a.deps))return void(s.memoizedState=Ra(t,n,i,r))}la.flags|=e,s.memoizedState=Ra(1|t,n,i,r)}function Oa(e,t){return Pa(8390656,8,e,t)}function Ma(e,t){return La(2048,8,e,t)}function Fa(e,t){return La(4,2,e,t)}function Ua(e,t){return La(4,4,e,t)}function Va(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function za(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,La(4,4,Va.bind(null,t,e),n)}function Ba(){}function $a(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qa(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ha(e,t,n){return 0===(21&oa)?(e.baseState&&(e.baseState=!1,wo=!0),e.memoizedState=n):(or(n,t)||(n=gt(),la.lanes|=n,Fl|=n,e.baseState=!0),t)}function Wa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=aa.transition;aa.transition={};try{e(!1),t()}finally{bt=n,aa.transition=r}}function Ga(){return xa().memoizedState}function Ka(e,t,n){var r=rc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e))Ja(t,n);else if(null!==(n=Li(e,t,n,r))){sc(n,e,r,nc()),Xa(n,t,r)}}function Qa(e,t,n){var r=rc(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Ja(t,s);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=i(a,n);if(s.hasEagerState=!0,s.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(s.next=s,Pi(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Li(e,t,s,r))&&(sc(n,e,r,s=nc()),Xa(n,t,r))}}function Ya(e){var t=e.alternate;return e===la||null!==t&&t===la}function Ja(e,t){ha=da=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Za={readContext:Ri,useCallback:ga,useContext:ga,useEffect:ga,useImperativeHandle:ga,useInsertionEffect:ga,useLayoutEffect:ga,useMemo:ga,useReducer:ga,useRef:ga,useState:ga,useDebugValue:ga,useDeferredValue:ga,useTransition:ga,useMutableSource:ga,useSyncExternalStore:ga,useId:ga,unstable_isNewReconciler:!1},eo={readContext:Ri,useCallback:function(e,t){return ba().memoizedState=[e,void 0===t?null:t],e},useContext:Ri,useEffect:Oa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4194308,4,Va.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var n=ba();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ba();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ka.bind(null,la,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ba().memoizedState=e},useState:Aa,useDebugValue:Ba,useDeferredValue:function(e){return ba().memoizedState=e},useTransition:function(){var e=Aa(!1),t=e[0];return e=Wa.bind(null,e[1]),ba().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=la,s=ba();if(ii){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Al)throw Error(i(349));0!==(30&oa)||Sa(r,t,n)}s.memoizedState=n;var a={value:n,getSnapshot:t};return s.queue=a,Oa(Ca.bind(null,r,a,e),[e]),r.flags|=2048,Ra(9,Ta.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ba(),t=Al.identifierPrefix;if(ii){var n=Js;t=":"+t+"R"+(n=(Ys&~(1<<32-at(Ys)-1)).toString(32)+n),0<(n=fa++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},to={readContext:Ri,useCallback:$a,useContext:Ri,useEffect:Ma,useImperativeHandle:za,useInsertionEffect:Fa,useLayoutEffect:Ua,useMemo:qa,useReducer:ka,useRef:Da,useState:function(){return ka(wa)},useDebugValue:Ba,useDeferredValue:function(e){return Ha(xa(),ca.memoizedState,e)},useTransition:function(){return[ka(wa)[0],xa().memoizedState]},useMutableSource:Na,useSyncExternalStore:Ea,useId:Ga,unstable_isNewReconciler:!1},no={readContext:Ri,useCallback:$a,useContext:Ri,useEffect:Ma,useImperativeHandle:za,useInsertionEffect:Fa,useLayoutEffect:Ua,useMemo:qa,useReducer:_a,useRef:Da,useState:function(){return _a(wa)},useDebugValue:Ba,useDeferredValue:function(e){var t=xa();return null===ca?t.memoizedState=e:Ha(t,ca.memoizedState,e)},useTransition:function(){return[_a(wa)[0],xa().memoizedState]},useMutableSource:Na,useSyncExternalStore:Ea,useId:Ga,unstable_isNewReconciler:!1};function ro(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function so(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=nc(),s=rc(e),i=Vi(r,s);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=zi(e,i,s))&&(sc(t,e,s,r),Bi(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=nc(),s=rc(e),i=Vi(r,s);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=zi(e,i,s))&&(sc(t,e,s,r),Bi(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=nc(),r=rc(e),s=Vi(n,r);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=zi(e,s,r))&&(sc(t,e,r,n),Bi(t,e,r))}};function ao(e,t,n,r,s,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(s,i))}function oo(e,t,n){var r=!1,s=Ts,i=t.contextType;return"object"===typeof i&&null!==i?i=Ri(i):(s=Rs(t)?js:Cs.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?As(e,s):Ts),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function lo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function co(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Fi(e);var i=t.contextType;"object"===typeof i&&null!==i?s.context=Ri(i):(i=Rs(t)?js:Cs.current,s.context=As(e,i)),s.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(so(e,t,i,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&io.enqueueReplaceState(s,s.state,null),qi(e,n,s,r),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function uo(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var s=n}catch(i){s="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:s,digest:null}}function ho(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var po="function"===typeof WeakMap?WeakMap:Map;function go(e,t,n){(n=Vi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=r),fo(0,t)},n}function mo(e,t,n){(n=Vi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){fo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){fo(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new po;var s=new Set;r.set(t,s)}else void 0===(s=r.get(t))&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bo(e,t,n,r,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Vi(-1,1)).tag=2,zi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var xo=x.ReactCurrentOwner,wo=!1;function ko(e,t,n,r){t.child=null===e?ki(t,null,n,r):wi(t,e.child,n,r)}function _o(e,t,n,r,s){n=n.render;var i=t.ref;return ji(t,s),r=ya(e,t,n,r,i,s),n=va(),null===e||wo?(ii&&n&&ti(t),t.flags|=1,ko(e,t,r,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Wo(e,t,s))}function No(e,t,n,r,s){if(null===e){var i=n.type;return"function"!==typeof i||Pc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Eo(e,t,i,r,s))}if(i=e.child,0===(e.lanes&s)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Wo(e,t,s)}return t.flags|=1,(e=Lc(i,r)).ref=t.ref,e.return=t,t.child=e}function Eo(e,t,n,r,s){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(wo=!1,t.pendingProps=r=i,0===(e.lanes&s))return t.lanes=e.lanes,Wo(e,t,s);0!==(131072&e.flags)&&(wo=!0)}}return Co(e,t,n,r,s)}function So(e,t,n){var r=t.pendingProps,s=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ss(Ll,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ss(Ll,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ss(Ll,Pl),Pl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ss(Ll,Pl),Pl|=r;return ko(e,t,s,n),t.child}function To(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,r,s){var i=Rs(n)?js:Cs.current;return i=As(t,i),ji(t,s),n=ya(e,t,n,r,i,s),r=va(),null===e||wo?(ii&&r&&ti(t),t.flags|=1,ko(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Wo(e,t,s))}function Io(e,t,n,r,s){if(Rs(n)){var i=!0;Os(t)}else i=!1;if(ji(t,s),null===t.stateNode)Ho(e,t),oo(t,n,r),co(t,n,r,s),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ri(c):c=As(t,c=Rs(n)?js:Cs.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&lo(t,a,r,c),Mi=!1;var h=t.memoizedState;a.state=h,qi(t,r,a,s),l=t.memoizedState,o!==r||h!==l||Is.current||Mi?("function"===typeof u&&(so(t,n,u,r),l=t.memoizedState),(o=Mi||ao(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ui(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ro(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ri(l):l=As(t,l=Rs(n)?js:Cs.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&lo(t,a,r,l),Mi=!1,h=t.memoizedState,a.state=h,qi(t,r,a,s);var p=t.memoizedState;o!==d||h!==p||Is.current||Mi?("function"===typeof f&&(so(t,n,f,r),p=t.memoizedState),(c=Mi||ao(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return jo(e,t,n,r,i,s)}function jo(e,t,n,r,s,i){To(e,t);var a=0!==(128&t.flags);if(!r&&!a)return s&&Ms(t,n,!1),Wo(e,t,i);r=t.stateNode,xo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,o,i)):ko(e,t,o,i),t.memoizedState=r.state,s&&Ms(t,n,!0),t.child}function Ao(e){var t=e.stateNode;t.pendingContext?Ps(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ps(0,t.context,!1),Ji(e,t.containerInfo)}function Ro(e,t,n,r,s){return pi(),gi(s),t.flags|=256,ko(e,t,n,r),t.child}var Do,Po,Lo,Oo,Mo={dehydrated:null,treeContext:null,retryLane:0};function Fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uo(e,t,n){var r,s=t.pendingProps,a=ta.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ss(ta,1&a),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Fc(l,s,0,null),e=Mc(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Fo(n),t.memoizedState=Mo,e):Vo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,s,a,o){if(n)return 256&t.flags?(t.flags&=-257,zo(e,t,o,r=ho(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=Fc({mode:"visible",children:r.children},s,0,null),(a=Mc(a,s,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&wi(t,e.child,null,o),t.child.memoizedState=Fo(o),t.memoizedState=Mo,a);if(0===(1&t.mode))return zo(e,t,o,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,zo(e,t,o,r=ho(a=Error(i(419)),r,void 0))}if(l=0!==(o&e.childLanes),wo||l){if(null!==(r=Al)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|o))?0:s)&&s!==a.retryLane&&(a.retryLane=s,Oi(e,s),sc(r,e,s,-1))}return yc(),zo(e,t,o,r=ho(Error(i(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,si=cs(s.nextSibling),ri=t,ii=!0,ai=null,null!==e&&(Gs[Ks++]=Ys,Gs[Ks++]=Js,Gs[Ks++]=Qs,Ys=e.id,Js=e.overflow,Qs=t),t=Vo(t,r.children),t.flags|=4096,t)}(e,t,l,s,r,a,n);if(o){o=s.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==a?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Lc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Lc(r,o):(o=Mc(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Fo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Mo,s}return e=(o=e.child).sibling,s=Lc(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Vo(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,n,r){return null!==r&&gi(r),wi(t,e.child,null,n),(e=Vo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ii(e.return,t,n)}function $o(e,t,n,r,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function qo(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(ko(e,t,r.children,n),0!==(2&(r=ta.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,n,t);else if(19===e.tag)Bo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ss(ta,r),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===na(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),$o(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===na(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}$o(t,!0,n,null,i);break;case"together":$o(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qo(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Rs(t.type)&&Ds(),Ko(t),null;case 3:return r=t.stateNode,Xi(),Es(Is),Es(Cs),sa(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ai&&(lc(ai),ai=null))),Po(e,t),Ko(t),null;case 5:ea(t);var s=Yi(Qi.current);if(n=t.type,null!==e&&null!=t.stateNode)Lo(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Ko(t),null}if(e=Yi(Gi.current),hi(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hs]=t,r[fs]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(s=0;s<Lr.length;s++)Ur(Lr[s],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Y(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":se(r,a),Ur("invalid",r)}for(var l in ve(n,a),s=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Xr(r.textContent,c,e),s=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Xr(r.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":W(r),Z(r,a,!0);break;case"textarea":W(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=s,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hs]=t,e[fs]=r,Do(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),s=r;break;case"iframe":case"object":case"embed":Ur("load",e),s=r;break;case"video":case"audio":for(s=0;s<Lr.length;s++)Ur(Lr[s],e);s=r;break;case"source":Ur("error",e),s=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),s=r;break;case"details":Ur("toggle",e),s=r;break;case"input":Y(e,r),s=Q(e,r),Ur("invalid",e);break;case"option":default:s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":se(e,r),s=re(e,r),Ur("invalid",e)}for(a in ve(n,s),c=s)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?me(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ur("scroll",e):null!=u&&b(e,a,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Oo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Yi(Qi.current),Yi(Gi.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[hs]=t,(a=r.nodeValue!==n)&&null!==(e=ri))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hs]=t,t.stateNode=r}return Ko(t),null;case 13:if(Es(ta),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==si&&0!==(1&t.mode)&&0===(128&t.flags))fi(),pi(),t.flags|=98560,a=!1;else if(a=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[hs]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),a=!1}else null!==ai&&(lc(ai),ai=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ta.current)?0===Ol&&(Ol=3):yc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Xi(),Po(e,t),null===e&&Br(t.stateNode.containerInfo),Ko(t),null;case 10:return Ci(t.type._context),Ko(t),null;case 19:if(Es(ta),null===(a=t.memoizedState))return Ko(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Go(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=na(e))){for(t.flags|=128,Go(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ss(ta,1&ta.current|2),t.child}e=e.sibling}null!==a.tail&&Je()>ql&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=na(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!ii)return Ko(t),null}else 2*Je()-a.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Je(),t.sibling=null,n=ta.current,Ss(ta,r?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Yo(e,t){switch(ni(t),t.tag){case 1:return Rs(t.type)&&Ds(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xi(),Es(Is),Es(Cs),sa(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ea(t),null;case 13:if(Es(ta),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Es(ta),null;case 4:return Xi(),null;case 10:return Ci(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Do=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(){},Lo=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Yi(Gi.current);var i,a=null;switch(n){case"input":s=Q(e,s),r=Q(e,r),a=[];break;case"select":s=M({},s,{value:void 0}),r=M({},r,{value:void 0}),a=[];break;case"textarea":s=re(e,s),r=re(e,r),a=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=s?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Jo=!1,Xo=!1,Zo="function"===typeof WeakSet?WeakSet:Set,el=null;function tl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function nl(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var rl=!1;function sl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,void 0!==i&&nl(t,n,i)}s=s.next}while(s!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[fs],delete t[gs],delete t[ms],delete t[ys])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ll(e){return 5===e.tag||3===e.tag||4===e.tag}function cl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ll(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}function dl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var hl=null,fl=!1;function pl(e,t,n){for(n=n.child;null!==n;)gl(e,t,n),n=n.sibling}function gl(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:Xo||tl(n,t);case 6:var r=hl,s=fl;hl=null,pl(e,t,n),fl=s,null!==(hl=r)&&(fl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(fl?(e=hl,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Bt(e)):ls(hl,n.stateNode));break;case 4:r=hl,s=fl,hl=n.stateNode.containerInfo,fl=!0,pl(e,t,n),hl=r,fl=s;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&nl(n,t,a),s=s.next}while(s!==r)}pl(e,t,n);break;case 1:if(!Xo&&(tl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Sc(n,t,o)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Xo=(r=Xo)||null!==n.memoizedState,pl(e,t,n),Xo=r):pl(e,t,n);break;default:pl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zo),t.forEach(function(t){var r=jc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function yl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,fl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,fl=!0;break e}l=l.return}if(null===hl)throw Error(i(160));gl(a,o,s),hl=null,fl=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){Sc(s,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yl(t,e),bl(e),4&r){try{sl(3,e,e.return),il(3,e)}catch(m){Sc(e,e.return,m)}try{sl(5,e,e.return)}catch(m){Sc(e,e.return,m)}}break;case 1:yl(t,e),bl(e),512&r&&null!==n&&tl(n,n.return);break;case 5:if(yl(t,e),bl(e),512&r&&null!==n&&tl(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(m){Sc(e,e.return,m)}}if(4&r&&null!=(s=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(s,a),be(l,o);var u=be(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?me(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):b(s,d,h,u)}switch(l){case"input":X(s,a);break;case"textarea":ie(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(s,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(s,!!a.multiple,a.defaultValue,!0):ne(s,!!a.multiple,a.multiple?[]:"",!1))}s[fs]=a}catch(m){Sc(e,e.return,m)}}break;case 6:if(yl(t,e),bl(e),4&r){if(null===e.stateNode)throw Error(i(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(m){Sc(e,e.return,m)}}break;case 3:if(yl(t,e),bl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(m){Sc(e,e.return,m)}break;case 4:default:yl(t,e),bl(e);break;case 13:yl(t,e),bl(e),8192&(s=e.child).flags&&(a=null!==s.memoizedState,s.stateNode.isHidden=a,!a||null!==s.alternate&&null!==s.alternate.memoizedState||($l=Je())),4&r&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xo=(u=Xo)||d,yl(t,e),Xo=u):yl(t,e),bl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(el=e,d=e.child;null!==d;){for(h=el=d;null!==el;){switch(p=(f=el).child,f.tag){case 0:case 11:case 14:case 15:sl(4,f,f.return);break;case 1:tl(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Sc(r,n,m)}}break;case 5:tl(f,f.return);break;case 22:if(null!==f.memoizedState){_l(h);continue}}null!==p?(p.return=f,el=p):_l(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,u?"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",o))}catch(m){Sc(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Sc(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yl(t,e),bl(e),4&r&&ml(e);case 21:}}function bl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ll(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(he(s,""),r.flags&=-33),dl(e,cl(e),s);break;case 3:case 4:var a=r.stateNode.containerInfo;ul(e,cl(e),a);break;default:throw Error(i(161))}}catch(Ai){Sc(e,e.return,Ai)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,n){el=e,wl(e,t,n)}function wl(e,t,n){for(var r=0!==(1&e.mode);null!==el;){var s=el,i=s.child;if(22===s.tag&&r){var a=null!==s.memoizedState||Jo;if(!a){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=Jo;var c=Xo;if(Jo=a,(Xo=l)&&!c)for(el=s;null!==el;)l=(a=el).child,22===a.tag&&null!==a.memoizedState?Nl(s):null!==l?(l.return=a,el=l):Nl(s);for(;null!==i;)el=i,wl(i,t,n),i=i.sibling;el=s,Jo=o,Xo=c}kl(e)}else 0!==(8772&s.subtreeFlags)&&null!==i?(i.return=s,el=i):kl(e)}}function kl(e){for(;null!==el;){var t=el;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xo)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:ro(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Hi(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hi(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(i(163))}Xo||512&t.flags&&al(t)}catch(f){Sc(t,t.return,f)}}if(t===e){el=null;break}if(null!==(n=t.sibling)){n.return=t.return,el=n;break}el=t.return}}function _l(e){for(;null!==el;){var t=el;if(t===e){el=null;break}var n=t.sibling;if(null!==n){n.return=t.return,el=n;break}el=t.return}}function Nl(e){for(;null!==el;){var t=el;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(Ai){Sc(t,n,Ai)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var s=t.return;try{r.componentDidMount()}catch(Ai){Sc(t,s,Ai)}}var i=t.return;try{al(t)}catch(Ai){Sc(t,i,Ai)}break;case 5:var a=t.return;try{al(t)}catch(Ai){Sc(t,a,Ai)}}}catch(Ai){Sc(t,t.return,Ai)}if(t===e){el=null;break}var o=t.sibling;if(null!==o){o.return=t.return,el=o;break}el=t.return}}var El,Sl=Math.ceil,Tl=x.ReactCurrentDispatcher,Cl=x.ReactCurrentOwner,Il=x.ReactCurrentBatchConfig,jl=0,Al=null,Rl=null,Dl=0,Pl=0,Ll=Ns(0),Ol=0,Ml=null,Fl=0,Ul=0,Vl=0,zl=null,Bl=null,$l=0,ql=1/0,Hl=null,Wl=!1,Gl=null,Kl=null,Ql=!1,Yl=null,Jl=0,Xl=0,Zl=null,ec=-1,tc=0;function nc(){return 0!==(6&jl)?Je():-1!==ec?ec:ec=Je()}function rc(e){return 0===(1&e.mode)?1:0!==(2&jl)&&0!==Dl?Dl&-Dl:null!==mi.transition?(0===tc&&(tc=gt()),tc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function sc(e,t,n,r){if(50<Xl)throw Xl=0,Zl=null,Error(i(185));yt(e,n,r),0!==(2&jl)&&e===Al||(e===Al&&(0===(2&jl)&&(Ul|=n),4===Ol&&cc(e,Dl)),ic(e,r),1===n&&0===jl&&0===(1&t.mode)&&(ql=Je()+500,Us&&Bs()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),o=1<<a,l=s[a];-1===l?0!==(o&n)&&0===(o&r)||(s[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Al?Dl:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Us=!0,zs(e)}(uc.bind(null,e)):zs(uc.bind(null,e)),as(function(){0===(6&jl)&&Bs()}),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ac(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(ec=-1,tc=0,0!==(6&jl))throw Error(i(327));var n=e.callbackNode;if(Nc()&&e.callbackNode!==n)return null;var r=ht(e,e===Al?Dl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var s=jl;jl|=2;var a=mc();for(Al===e&&Dl===t||(Hl=null,ql=Je()+500,pc(e,t));;)try{xc();break}catch(l){gc(e,l)}Ti(),Tl.current=a,jl=s,null!==Rl?t=0:(Al=null,Dl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(s=pt(e))&&(r=s,t=oc(e,s))),1===t)throw n=Ml,pc(e,0),cc(e,r),ic(e,Je()),n;if(6===t)cc(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!or(i(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=vc(e,r))&&(0!==(a=pt(e))&&(r=a,t=oc(e,a))),1===t))throw n=Ml,pc(e,0),cc(e,r),ic(e,Je()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:_c(e,Bl,Hl);break;case 3:if(cc(e,r),(130023424&r)===r&&10<(t=$l+500-Je())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&r)!==r){nc(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rs(_c.bind(null,e,Bl,Hl),t);break}_c(e,Bl,Hl);break;case 4:if(cc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>s&&(s=o),r&=~a}if(r=s,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=rs(_c.bind(null,e,Bl,Hl),r);break}_c(e,Bl,Hl);break;default:throw Error(i(329))}}}return ic(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function oc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Bl,Bl=n,null!==t&&lc(t)),e}function lc(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function cc(e,t){for(t&=~Vl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function uc(e){if(0!==(6&jl))throw Error(i(327));Nc();var t=ht(e,0);if(0===(1&t))return ic(e,Je()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Ml,pc(e,0),cc(e,t),ic(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,Bl,Hl),ic(e,Je()),null}function dc(e,t){var n=jl;jl|=1;try{return e(t)}finally{0===(jl=n)&&(ql=Je()+500,Us&&Bs())}}function hc(e){null!==Yl&&0===Yl.tag&&0===(6&jl)&&Nc();var t=jl;jl|=1;var n=Il.transition,r=bt;try{if(Il.transition=null,bt=1,e)return e()}finally{bt=r,Il.transition=n,0===(6&(jl=t))&&Bs()}}function fc(){Pl=Ll.current,Es(Ll)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(ni(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ds();break;case 3:Xi(),Es(Is),Es(Cs),sa();break;case 5:ea(r);break;case 4:Xi();break;case 13:case 19:Es(ta);break;case 10:Ci(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Al=e,Rl=e=Lc(e.current,null),Dl=Pl=t,Ol=0,Ml=null,Vl=Ul=Fl=0,Bl=zl=null,null!==Di){for(t=0;t<Di.length;t++)if(null!==(r=(n=Di[t]).interleaved)){n.interleaved=null;var s=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=s,r.next=a}n.pending=r}Di=null}return e}function gc(e,t){for(;;){var n=Rl;try{if(Ti(),ia.current=Za,da){for(var r=la.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}da=!1}if(oa=0,ua=ca=la=null,ha=!1,fa=0,Cl.current=null,null===n||null===n.return){Ol=1,Ml=t,Rl=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=vo(o);if(null!==p){p.flags&=-257,bo(p,o,l,0,t),1&p.mode&&yo(a,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){yo(a,u,t),yc();break e}c=Error(i(426))}else if(ii&&1&l.mode){var y=vo(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),bo(y,o,l,0,t),gi(uo(c,l));break e}}a=c=uo(c,l),4!==Ol&&(Ol=2),null===zl?zl=[a]:zl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,$i(a,go(0,c,t));break e;case 1:l=c;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kl||!Kl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,$i(a,mo(a,l,t));break e}}a=a.return}while(null!==a)}kc(n)}catch(x){t=x,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function mc(){var e=Tl.current;return Tl.current=Za,null===e?Za:e}function yc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Al||0===(268435455&Fl)&&0===(268435455&Ul)||cc(Al,Dl)}function vc(e,t){var n=jl;jl|=2;var r=mc();for(Al===e&&Dl===t||(Hl=null,pc(e,t));;)try{bc();break}catch(s){gc(e,s)}if(Ti(),jl=n,Tl.current=r,null!==Rl)throw Error(i(261));return Al=null,Dl=0,Ol}function bc(){for(;null!==Rl;)wc(Rl)}function xc(){for(;null!==Rl&&!Qe();)wc(Rl)}function wc(e){var t=El(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?kc(e):Rl=t,Cl.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qo(n,t,Pl)))return void(Rl=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Ol=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Ol&&(Ol=5)}function _c(e,t,n){var r=bt,s=Il.transition;try{Il.transition=null,bt=1,function(e,t,n,r){do{Nc()}while(null!==Yl);if(0!==(6&jl))throw Error(i(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-at(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}(e,a),e===Al&&(Rl=Al=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ql||(Ql=!0,Ac(tt,function(){return Nc(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Il.transition,Il.transition=null;var o=bt;bt=1;var l=jl;jl|=4,Cl.current=null,function(e,t){if(es=qt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(Xs){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===s&&(l=o),f===a&&++d===r&&(c=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},qt=!1,el=t;null!==el;)if(e=(t=el).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,el=e;else for(;null!==el;){t=el;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:ro(t.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(Xs){Sc(t,t.return,Xs)}if(null!==(e=t.sibling)){e.return=t.return,el=e;break}el=t.return}g=rl,rl=!1}(e,n),vl(n,e),pr(ts),qt=!!es,ts=es=null,e.current=n,xl(n,e,s),Ye(),jl=l,bt=o,Il.transition=a}else e.current=n;if(Ql&&(Ql=!1,Yl=e,Jl=s),a=e.pendingLanes,0===a&&(Kl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&Jl)&&0!==e.tag&&Nc(),a=e.pendingLanes,0!==(1&a)?e===Zl?Xl++:(Xl=0,Zl=e):Xl=0,Bs()}(e,t,n,r)}finally{Il.transition=s,bt=r}return null}function Nc(){if(null!==Yl){var e=xt(Jl),t=Il.transition,n=bt;try{if(Il.transition=null,bt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Jl=0,0!==(6&jl))throw Error(i(331));var s=jl;for(jl|=4,el=e.current;null!==el;){var a=el,o=a.child;if(0!==(16&el.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(el=u;null!==el;){var d=el;switch(d.tag){case 0:case 11:case 15:sl(8,d,a)}var h=d.child;if(null!==h)h.return=d,el=h;else for(;null!==el;){var f=(d=el).sibling,p=d.return;if(ol(d),d===u){el=null;break}if(null!==f){f.return=p,el=f;break}el=p}}}var g=a.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}el=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,el=o;else e:for(;null!==el;){if(0!==(2048&(a=el).flags))switch(a.tag){case 0:case 11:case 15:sl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,el=v;break e}el=a.return}}var b=e.current;for(el=b;null!==el;){var x=(o=el).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,el=x;else e:for(o=b;null!==el;){if(0!==(2048&(l=el).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(k){Sc(l,l.return,k)}if(l===o){el=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,el=w;break e}el=l.return}}if(jl=s,Bs(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(st,e)}catch(k){}r=!0}return r}finally{bt=n,Il.transition=t}}return!1}function Ec(e,t,n){e=zi(e,t=go(0,t=uo(n,t),1),1),t=nc(),null!==e&&(yt(e,1,t),ic(e,t))}function Sc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=zi(t,e=mo(t,e=uo(n,e),1),1),e=nc(),null!==t&&(yt(t,1,e),ic(t,e));break}}t=t.return}}function Tc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=nc(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Dl&n)===n&&(4===Ol||3===Ol&&(130023424&Dl)===Dl&&500>Je()-$l?pc(e,0):Vl|=n),ic(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=nc();null!==(e=Oi(e,t))&&(yt(e,t,n),ic(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function jc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Cc(e,n)}function Ac(e,t){return Ge(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,r){return new Rc(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,s,a){var o=2;if(r=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case _:return Mc(n.children,s,a,t);case N:o=8,s|=8;break;case E:return(e=Dc(12,n,t,2|s)).elementType=E,e.lanes=a,e;case I:return(e=Dc(13,n,t,s)).elementType=I,e.lanes=a,e;case j:return(e=Dc(19,n,t,s)).elementType=j,e.lanes=a,e;case D:return Fc(n,s,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case T:o=9;break e;case C:o=11;break e;case A:o=14;break e;case R:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Dc(o,n,t,s)).elementType=e,t.type=r,t.lanes=a,t}function Mc(e,t,n,r){return(e=Dc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Dc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Vc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,s,i,a,o,l){return e=new zc(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Dc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fi(i),e}function $c(e){if(!e)return Ts;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Rs(n))return Ls(e,n,t)}return t}function qc(e,t,n,r,s,i,a,o,l){return(e=Bc(n,r,!0,e,0,i,0,o,l)).context=$c(null),n=e.current,(i=Vi(r=nc(),s=rc(n))).callback=void 0!==t&&null!==t?t:null,zi(n,i,s),e.current.lanes=s,yt(e,s,r),ic(e,r),e}function Hc(e,t,n,r){var s=t.current,i=nc(),a=rc(s);return n=$c(n),null===t.context?t.context=n:t.pendingContext=n,(t=Vi(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=zi(s,t,a))&&(sc(e,s,a,i),Bi(e,s,a)),a}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Is.current)wo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wo=!1,function(e,t,n){switch(t.tag){case 3:Ao(t),pi();break;case 5:Zi(t);break;case 1:Rs(t.type)&&Os(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ss(_i,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ss(ta,1&ta.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Uo(e,t,n):(Ss(ta,1&ta.current),null!==(e=Wo(e,t,n))?e.sibling:null);Ss(ta,1&ta.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ss(ta,ta.current),r)break;return null;case 22:case 23:return t.lanes=0,So(e,t,n)}return Wo(e,t,n)}(e,t,n);wo=0!==(131072&e.flags)}else wo=!1,ii&&0!==(1048576&t.flags)&&ei(t,Ws,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var s=As(t,Cs.current);ji(t,n),s=ya(null,t,r,e,s,n);var a=va();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rs(r)?(a=!0,Os(t)):a=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Fi(t),s.updater=io,t.stateNode=s,s._reactInternals=t,co(t,r,e,n),t=jo(null,t,r,!0,a,n)):(t.tag=0,ii&&a&&ti(t),ko(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===A)return 14}return 2}(r),e=ro(r,e),s){case 0:t=Co(null,t,r,e,n);break e;case 1:t=Io(null,t,r,e,n);break e;case 11:t=_o(null,t,r,e,n);break e;case 14:t=No(null,t,r,ro(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,Co(e,t,r,s=t.elementType===r?s:ro(r,s),n);case 1:return r=t.type,s=t.pendingProps,Io(e,t,r,s=t.elementType===r?s:ro(r,s),n);case 3:e:{if(Ao(t),null===e)throw Error(i(387));r=t.pendingProps,s=(a=t.memoizedState).element,Ui(e,t),qi(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ro(e,t,r,n,s=uo(Error(i(423)),t));break e}if(r!==s){t=Ro(e,t,r,n,s=uo(Error(i(424)),t));break e}for(si=cs(t.stateNode.containerInfo.firstChild),ri=t,ii=!0,ai=null,n=ki(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===s){t=Wo(e,t,n);break e}ko(e,t,r,n)}t=t.child}return t;case 5:return Zi(t),null===e&&ui(t),r=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,o=s.children,ns(r,s)?o=null:null!==a&&ns(r,a)&&(t.flags|=32),To(e,t),ko(e,t,o,n),t.child;case 6:return null===e&&ui(t),null;case 13:return Uo(e,t,n);case 4:return Ji(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):ko(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,_o(e,t,r,s=t.elementType===r?s:ro(r,s),n);case 7:return ko(e,t,t.pendingProps,n),t.child;case 8:case 12:return ko(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,Ss(_i,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===s.children&&!Is.current){t=Wo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Vi(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ii(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ii(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}ko(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ji(t,n),r=r(s=Ri(s)),t.flags|=1,ko(e,t,r,n),t.child;case 14:return s=ro(r=t.type,t.pendingProps),No(e,t,r,s=ro(r.type,s),n);case 15:return Eo(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:ro(r,s),Ho(e,t),t.tag=1,Rs(r)?(e=!0,Os(t)):e=!1,ji(t,n),oo(t,r,s),co(t,r,s,n),jo(null,t,r,!0,e,n);case 19:return qo(e,t,n);case 22:return So(e,t,n)}throw Error(i(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function eu(){}function tu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof s){var o=s;s=function(){var e=Wc(a);o.call(e)}}Hc(t,a,e,s)}else a=function(e,t,n,r,s){if(s){if("function"===typeof r){var i=r;r=function(){var e=Wc(a);i.call(e)}}var a=qc(t,r,e,0,null,!1,0,"",eu);return e._reactRootContainer=a,e[ps]=a.current,Br(8===e.nodeType?e.parentNode:e),hc(),a}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof r){var o=r;r=function(){var e=Wc(l);o.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",eu);return e._reactRootContainer=l,e[ps]=l.current,Br(8===e.nodeType?e.parentNode:e),hc(function(){Hc(t,l,n,r)}),l}(n,t,e,s,r);return Wc(a)}Jc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Hc(e,t,null,null)},Jc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc(function(){Hc(null,e,null,null)}),t[ps]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Mt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),ic(t,Je()),0===(6&jl)&&(ql=Je()+500,Bs()))}break;case 13:hc(function(){var t=Oi(e,1);if(null!==t){var n=nc();sc(t,e,1,n)}}),Kc(e,1)}},kt=function(e){if(13===e.tag){var t=Oi(e,134217728);if(null!==t)sc(t,e,134217728,nc());Kc(e,134217728)}},_t=function(e){if(13===e.tag){var t=rc(e),n=Oi(e,t);if(null!==n)sc(n,e,t,nc());Kc(e,t)}},Nt=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ws(r);if(!s)throw Error(i(90));G(r),X(r,s)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=dc,Ie=hc;var nu={usingClientEntryPoint:!1,Events:[bs,xs,ws,Se,Te,dc]},ru={findFiberByHostInstance:vs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},su={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{st=iu.inject(su),it=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(i(299));var n=!1,r="",s=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,s),e[ps]=t.current,Br(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(i(200));return tu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,s=!1,a="",o=Qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,s,0,a,o),e[ps]=t.current,Br(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Jc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(i(200));return tu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(i(40));return!!e._reactRootContainer&&(hc(function(){tu(null,null,e,!1,function(){e._reactRootContainer=null,e[ps]=null})}),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return tu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var r=n(43),s=n(391);const i=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296===(64512&s)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],i=s+1<e.length,a=i?e[s+1]:0,o=s+2<e.length,l=o?e[s+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,i||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],i=s<e.length?n[e.charAt(s)]:0;++s;const a=s<e.length?n[e.charAt(s)]:64;++s;const l=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==i||null==a||null==l)throw new o;const c=t<<2|i>>4;if(r.push(c),64!==a){const e=i<<4&240|a>>2;if(r.push(e),64!==l){const e=a<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l=function(e){return function(e){const t=i(e);return a.encodeByteArray(t,!0)}(e).replace(/\./g,"")},c=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function u(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const d=()=>{try{return u().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/TradeJournalWeb",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyDJTS2-XcoJCIR3OYDTE2-oqsUjorA4P-M",REACT_APP_FIREBASE_AUTH_DOMAIN:"jurnal-trading-saya.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"jurnal-trading-saya",REACT_APP_FIREBASE_STORAGE_BUCKET:"jurnal-trading-saya.appspot.com",REACT_APP_FIREBASE_SENDER_ID:"55282716936",REACT_APP_FIREBASE_APP_ID:"1:55282716936:web:0d631d8ada6f89c7411cbd",REACT_APP_MEASUREMENT_ID:"G-BZ0D0MZXJV"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&c(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>d()?.emulatorHosts?.[e],f=e=>{const t=h(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},p=()=>d()?.config,g=e=>d()?.[`_${e}`];class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function y(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function v(e){return(await fetch(e,{credentials:"include"})).ok}function b(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e};return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(i)),""].join(".")}const x={};let w=!1;function k(e,t){if("undefined"===typeof window||"undefined"===typeof document||!y(window.location.host)||x[e]===t||x[e]||w)return;function n(e){return`__firebase__banner__${e}`}x[e]=t;const r="__firebase__banner",s=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(x))x[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{w=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),a=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,a,l,n),document.body.appendChild(t)}s?(a.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function _(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function N(){const e=d()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function E(){return!N()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function S(){try{return"object"===typeof indexedDB}catch(e){return!1}}class T extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,T.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C.prototype.create)}}class C{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(I,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",i=`${this.serviceName}: ${s} (${n}).`;return new T(n,i,t)}}const I=/\{\$([^}]+)}/g;function j(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],i=t[s];if(A(n)&&A(i)){if(!j(n,i))return!1}else if(n!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function A(e){return null!==e&&"object"===typeof e}function R(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function D(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function P(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class L{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=O),void 0===r.error&&(r.error=O),void 0===r.complete&&(r.complete=O);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function O(){}function M(e){return e&&e._delegate?e._delegate:e}class F{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const U="[DEFAULT]";class V{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new m;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:U})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&i.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&e(s,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===U?void 0:s),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var s;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U;return this.component?this.component.multipleInstances?e:U:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class z{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new V(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const B=[];var $;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}($||($={}));const q={debug:$.DEBUG,verbose:$.VERBOSE,info:$.INFO,warn:$.WARN,error:$.ERROR,silent:$.SILENT},H=$.INFO,W={[$.DEBUG]:"log",[$.VERBOSE]:"log",[$.INFO]:"info",[$.WARN]:"warn",[$.ERROR]:"error"},G=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=W[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var s=arguments.length,i=new Array(s>2?s-2:0),a=2;a<s;a++)i[a-2]=arguments[a];console[r](`[${n}]  ${e.name}:`,...i)};class K{constructor(e){this.name=e,this._logLevel=H,this._logHandler=G,this._userLogHandler=null,B.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?q[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$.DEBUG,...t),this._logHandler(this,$.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$.VERBOSE,...t),this._logHandler(this,$.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$.INFO,...t),this._logHandler(this,$.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$.WARN,...t),this._logHandler(this,$.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,$.ERROR,...t),this._logHandler(this,$.ERROR,...t)}}let Q,Y;const J=new WeakMap,X=new WeakMap,Z=new WeakMap,ee=new WeakMap,te=new WeakMap;let ne={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return X.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Z.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ie(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function re(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Y||(Y=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(ae(this),n),ie(J.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ie(e.apply(ae(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const i=e.call(ae(this),t,...r);return Z.set(i,t.sort?t.sort():[t]),ie(i)}}function se(e){return"function"===typeof e?re(e):(e instanceof IDBTransaction&&function(e){if(X.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});X.set(e,t)}(e),t=e,(Q||(Q=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,ne):e);var t}function ie(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(ie(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&J.set(t,e)}).catch(()=>{}),te.set(t,e),t}(e);if(ee.has(e))return ee.get(e);const t=se(e);return t!==e&&(ee.set(e,t),te.set(t,e)),t}const ae=e=>te.get(e);const oe=["get","getKey","getAll","getAllKeys","count"],le=["put","add","delete","clear"],ce=new Map;function ue(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(ce.get(t))return ce.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=le.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!oe.includes(n))return;const i=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let i=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(i=i.index(o.shift())),(await Promise.all([i[n](...o),s&&t.done]))[0]};return ce.set(t,i),i}ne=(e=>({...e,get:(t,n,r)=>ue(t,n)||e.get(t,n,r),has:(t,n)=>!!ue(t,n)||e.has(t,n)}))(ne);class de{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===t?.type}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const he="@firebase/app",fe="0.14.0",pe=new K("@firebase/app"),ge="@firebase/app-compat",me="@firebase/analytics-compat",ye="@firebase/analytics",ve="@firebase/app-check-compat",be="@firebase/app-check",xe="@firebase/auth",we="@firebase/auth-compat",ke="@firebase/database",_e="@firebase/data-connect",Ne="@firebase/database-compat",Ee="@firebase/functions",Se="@firebase/functions-compat",Te="@firebase/installations",Ce="@firebase/installations-compat",Ie="@firebase/messaging",je="@firebase/messaging-compat",Ae="@firebase/performance",Re="@firebase/performance-compat",De="@firebase/remote-config",Pe="@firebase/remote-config-compat",Le="@firebase/storage",Oe="@firebase/storage-compat",Me="@firebase/firestore",Fe="@firebase/ai",Ue="@firebase/firestore-compat",Ve="firebase",ze="[DEFAULT]",Be={[he]:"fire-core",[ge]:"fire-core-compat",[ye]:"fire-analytics",[me]:"fire-analytics-compat",[be]:"fire-app-check",[ve]:"fire-app-check-compat",[xe]:"fire-auth",[we]:"fire-auth-compat",[ke]:"fire-rtdb",[_e]:"fire-data-connect",[Ne]:"fire-rtdb-compat",[Ee]:"fire-fn",[Se]:"fire-fn-compat",[Te]:"fire-iid",[Ce]:"fire-iid-compat",[Ie]:"fire-fcm",[je]:"fire-fcm-compat",[Ae]:"fire-perf",[Re]:"fire-perf-compat",[De]:"fire-rc",[Pe]:"fire-rc-compat",[Le]:"fire-gcs",[Oe]:"fire-gcs-compat",[Me]:"fire-fst",[Ue]:"fire-fst-compat",[Fe]:"fire-vertex","fire-js":"fire-js",[Ve]:"fire-js-all"},$e=new Map,qe=new Map,He=new Map;function We(e,t){try{e.container.addComponent(t)}catch(n){pe.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ge(e){const t=e.name;if(He.has(t))return pe.debug(`There were multiple attempts to register component ${t}.`),!1;He.set(t,e);for(const n of $e.values())We(n,e);for(const n of qe.values())We(n,e);return!0}function Ke(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Qe(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Ye=new C("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Je{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new F("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ye.create("app-deleted",{appName:this._name})}}const Xe="12.0.0";function Ze(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r={name:ze,automaticDataCollectionEnabled:!0,...t},s=r.name;if("string"!==typeof s||!s)throw Ye.create("bad-app-name",{appName:String(s)});if(n||(n=p()),!n)throw Ye.create("no-options");const i=$e.get(s);if(i){if(j(n,i.options)&&j(r,i.config))return i;throw Ye.create("duplicate-app",{appName:s})}const a=new z(s);for(const l of He.values())a.addComponent(l);const o=new Je(n,r,a);return $e.set(s,o),o}function et(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze;const t=$e.get(e);if(!t&&e===ze&&p())return Ze();if(!t)throw Ye.create("no-app",{appName:e});return t}function tt(e,t,n){let r=Be[e]??e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=t.match(/\s|\//);if(s||i){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&e.push("and"),i&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void pe.warn(e.join(" "))}Ge(new F(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const nt="firebase-heartbeat-store";let rt=null;function st(){return rt||(rt=function(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=ie(a);return r&&a.addEventListener("upgradeneeded",e=>{r(ie(a.result),e.oldVersion,e.newVersion,ie(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{i&&e.addEventListener("close",()=>i()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(nt)}catch(n){console.warn(n)}}}).catch(e=>{throw Ye.create("idb-open",{originalErrorMessage:e.message})})),rt}async function it(e,t){try{const n=(await st()).transaction(nt,"readwrite"),r=n.objectStore(nt);await r.put(t,at(e)),await n.done}catch(n){if(n instanceof T)pe.warn(n.message);else{const e=Ye.create("idb-set",{originalErrorMessage:n?.message});pe.warn(e.message)}}}function at(e){return`${e.name}!${e.options.appId}`}class ot{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ct(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=lt();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){pe.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const e=lt(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const s of e){const e=n.find(e=>e.agent===s.agent);if(e){if(e.dates.push(s.date),ut(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),ut(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=l(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return pe.warn(e),""}}}function lt(){return(new Date).toISOString().substring(0,10)}class ct{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!S()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await st()).transaction(nt),n=await t.objectStore(nt).get(at(e));return await t.done,n}catch(t){if(t instanceof T)pe.warn(t.message);else{const e=Ye.create("idb-get",{originalErrorMessage:t?.message});pe.warn(e.message)}}}(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return it(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return it(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function ut(e){return l(JSON.stringify({version:2,heartbeats:e})).length}var dt;dt="",Ge(new F("platform-logger",e=>new de(e),"PRIVATE")),Ge(new F("heartbeat",e=>new ot(e),"PRIVATE")),tt(he,fe,dt),tt(he,fe,"esm2020"),tt("fire-js","");tt("firebase","12.0.0","app");function ht(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ft=ht,pt=new C("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),gt=new K("@firebase/auth");function mt(e){if(gt.logLevel<=$.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gt.error(`Auth (${Xe}): ${e}`,...n)}}function yt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw wt(e,...n)}function vt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return wt(e,...n)}function bt(e,t,n){const r={...ft(),[t]:n};return new C("auth","Firebase",r).create(t,{appName:e.name})}function xt(e){return bt(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return pt.create(e,...n)}function kt(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];throw wt(t,...r)}}function _t(e){const t="INTERNAL ASSERTION FAILED: "+e;throw mt(t),new Error(t)}function Nt(e,t){e||_t(t)}function Et(){return"undefined"!==typeof self&&self.location?.href||""}function St(){return"http:"===Tt()||"https:"===Tt()}function Tt(){return"undefined"!==typeof self&&self.location?.protocol||null}function Ct(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(St()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class It{constructor(e,t){this.shortDelay=e,this.longDelay=t,Nt(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Ct()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function jt(e,t){Nt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class At{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void _t("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void _t("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void _t("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Rt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Dt=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Pt=new It(3e4,6e4);function Lt(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function Ot(e,t,n,r){return Mt(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let s={},i={};r&&("GET"===t?i=r:s={body:JSON.stringify(r)});const a=R({key:e.config.apiKey,...i}).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l={method:t,headers:o,...s};return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&y(e.emulatorConfig.host)&&(l.credentials="include"),At.fetch()(await Ut(e,e.config.apiHost,n,a),l)})}async function Mt(e,t,n){e._canInitEmulator=!1;const r={...Rt,...t};try{const t=new zt(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw Bt(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const t=s.ok?i.errorMessage:i.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Bt(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw Bt(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw Bt(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw bt(e,o,a);yt(e,o)}}catch(s){if(s instanceof T)throw s;yt(e,"network-request-failed",{message:String(s)})}}async function Ft(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await Ot(e,t,n,r,s);return"mfaPendingCredential"in i&&yt(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function Ut(e,t,n,r){const s=`${t}${n}?${r}`,i=e,a=i.config.emulator?jt(e.config,s):`${e.config.apiScheme}://${s}`;if(Dt.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(a).toString()}return a}function Vt(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zt{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(vt(this.auth,"network-request-failed")),Pt.get())})}}function Bt(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=vt(e,t,r);return s.customData._tokenResponse=n,s}function $t(e){return void 0!==e&&void 0!==e.enterprise}class qt{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Vt(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Ht(e,t){return Ot(e,"GET","/v2/recaptchaConfig",Lt(e,t))}async function Wt(e,t){return Ot(e,"POST","/v1/accounts:lookup",t)}function Gt(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Kt(e){return 1e3*Number(e)}function Qt(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return mt("JWT malformed, contained fewer than 3 sections"),null;try{const e=c(n);return e?JSON.parse(e):(mt("Failed to decode base64 JWT payload"),null)}catch(s){return mt("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Yt(e){const t=Qt(e);return kt(t,"internal-error"),kt("undefined"!==typeof t.exp,"internal-error"),kt("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Jt(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof T&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Xt{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class Zt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gt(this.lastLoginAt),this.creationTime=Gt(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function en(e){const t=e.auth,n=await e.getIdToken(),r=await Jt(e,Wt(t,{idToken:n}));kt(r?.users.length,t,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const i=s.providerUserInfo?.length?tn(s.providerUserInfo):[],a=(o=e.providerData,l=i,[...o.filter(e=>!l.some(t=>t.providerId===e.providerId)),...l]);var o,l;const c=e.isAnonymous,u=!(e.email&&s.passwordHash)&&!a?.length,d=!!c&&u,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Zt(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,h)}function tn(e){return e.map(e=>{let{providerId:t,...n}=e;return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class nn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){kt(e.idToken,"internal-error"),kt("undefined"!==typeof e.idToken,"internal-error"),kt("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Yt(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){kt(0!==e.length,"internal-error");const t=Yt(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(kt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await Mt(e,{},async()=>{const n=R({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,i=await Ut(e,r,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:a,body:n};return e.emulatorConfig&&y(e.emulatorConfig.host)&&(o.credentials="include"),At.fetch()(i,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new nn;return n&&(kt("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(kt("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(kt("number"===typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nn,this.toJSON())}_performRefresh(){return _t("not implemented")}}function rn(e,t){kt("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class sn{constructor(e){let{uid:t,auth:n,stsTokenManager:r,...s}=e;this.providerId="firebase",this.proactiveRefresh=new Xt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zt(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Jt(this,this.stsTokenManager.getToken(this.auth,e));return kt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=M(e),r=await n.getIdToken(t),s=Qt(r);kt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i="object"===typeof s.firebase?s.firebase:void 0,a=i?.sign_in_provider;return{claims:s,token:r,authTime:Gt(Kt(s.auth_time)),issuedAtTime:Gt(Kt(s.iat)),expirationTime:Gt(Kt(s.exp)),signInProvider:a||null,signInSecondFactor:i?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=M(e);await en(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(kt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new sn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){kt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await en(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qe(this.auth.app))return Promise.reject(xt(this.auth));const e=await this.getIdToken();return await Jt(this,async function(e,t){return Ot(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,i=t.photoURL??void 0,a=t.tenantId??void 0,o=t._redirectEventId??void 0,l=t.createdAt??void 0,c=t.lastLoginAt??void 0,{uid:u,emailVerified:d,isAnonymous:h,providerData:f,stsTokenManager:p}=t;kt(u&&p,e,"internal-error");const g=nn.fromJSON(this.name,p);kt("string"===typeof u,e,"internal-error"),rn(n,e.name),rn(r,e.name),kt("boolean"===typeof d,e,"internal-error"),kt("boolean"===typeof h,e,"internal-error"),rn(s,e.name),rn(i,e.name),rn(a,e.name),rn(o,e.name),rn(l,e.name),rn(c,e.name);const m=new sn({uid:u,auth:e,email:r,emailVerified:d,displayName:n,isAnonymous:h,photoURL:i,phoneNumber:s,tenantId:a,stsTokenManager:g,createdAt:l,lastLoginAt:c});return f&&Array.isArray(f)&&(m.providerData=f.map(e=>({...e}))),o&&(m._redirectEventId=o),m}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new nn;r.updateFromServerResponse(t);const s=new sn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await en(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];kt(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?tn(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!s?.length,a=new nn;a.updateFromIdToken(n);const o=new sn({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Zt(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(o,l),o}}const an=new Map;function on(e){Nt(e instanceof Function,"Expected a class definition");let t=an.get(e);return t?(Nt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,an.set(e,t),t)}class ln{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ln.type="NONE";const cn=ln;function un(e,t,n){return`firebase:${e}:${t}:${n}`}class dn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=un(this.userKey,r.apiKey,s),this.fullPersistenceKey=un("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Wt(this.auth,{idToken:e}).catch(()=>{});return t?sn._fromGetAccountInfoResponse(this.auth,t,e):null}return sn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new dn(on(cn),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let s=r[0]||on(cn);const i=un(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const t=await l._get(i);if(t){let n;if("string"===typeof t){const r=await Wt(e,{idToken:t}).catch(()=>{});if(!r)break;n=await sn._fromGetAccountInfoResponse(e,r,t)}else n=sn._fromJSON(e,t);l!==s&&(a=n),s=l;break}}catch{}const o=r.filter(e=>e._shouldAllowMigration);return s._shouldAllowMigration&&o.length?(s=o[0],a&&await s._set(i,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==s)try{await e._remove(i)}catch{}})),new dn(s,e,n)):new dn(s,e,n)}}function hn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(mn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(vn(t))return"Blackberry";if(bn(t))return"Webos";if(pn(t))return"Safari";if((t.includes("chrome/")||gn(t))&&!t.includes("edge/"))return"Chrome";if(yn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function fn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return/firefox\//i.test(e)}function pn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:_()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return/crios\//i.test(e)}function mn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return/iemobile/i.test(e)}function yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return/android/i.test(e)}function vn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return/blackberry/i.test(e)}function bn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return/webos/i.test(e)}function xn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function wn(){return function(){const e=_();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function kn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_();return xn(e)||yn(e)||bn(e)||vn(e)||/windows phone/i.test(e)||mn(e)}function _n(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=hn(_());break;case"Worker":t=`${hn(_())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xe}/${r}`}class Nn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(s){r(s)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}class En{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class Sn{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cn(this),this.idTokenSubscription=new Cn(this),this.beforeStateQueue=new Nn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=on(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await dn.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(n){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Wt(this,{idToken:e}),n=await sn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Qe(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,s=n?._redirectEventId,i=await this.tryRedirectSignIn(e);t&&t!==s||!i?.user||(n=i.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(s){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return kt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await en(e)}catch(t){if("auth/network-request-failed"!==t?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qe(this.app))return Promise.reject(xt(this));const t=e?M(e):null;return t&&kt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&kt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qe(this.app)?Promise.reject(xt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qe(this.app)?Promise.reject(xt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(on(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Ot(e,"GET","/v2/passwordPolicy",Lt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new En(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new C("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Ot(e,"POST","/v2/accounts:revokeToken",Lt(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&on(e)||this._popupRedirectResolver;kt(t,this,"argument-error"),this.redirectPersistenceManager=await dn.create(this,[on(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"===typeof t?t:t.next.bind(t);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(kt(a,this,"internal-error"),a.then(()=>{i||s(this.currentUser)}),"function"===typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return kt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_n(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Qe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e){if(gt.logLevel<=$.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gt.warn(`Auth (${Xe}): ${e}`,...n)}}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Tn(e){return M(e)}class Cn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new L(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return kt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let In={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jn(e){return In.loadJS(e)}function An(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Rn{constructor(){this.enterprise=new Dn}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Dn{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Pn="NO_RECAPTCHA";class Ln{constructor(e){this.type="recaptcha-enterprise",this.auth=Tn(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const s=window.grecaptcha;$t(s)?s.enterprise.ready(()=>{s.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Pn)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Rn).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Ht(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new qt(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(s=>{if(!t&&$t(window.grecaptcha))n(s,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=In.recaptchaEnterpriseScript;0!==t.length&&(t+=s),jn(t).then(()=>{n(s,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function On(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Ln(e);let a;if(s)a=Pn;else try{a=await i.verify(n)}catch(l){a=await i.verify(n,!0)}const o={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Mn(e,t,n,r,s){if("EMAIL_PASSWORD_PROVIDER"===s){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await On(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch(async s=>{if("auth/missing-recaptcha-token"===s.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await On(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)})}if("PHONE_PROVIDER"===s){if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const s=await On(e,t,n);return r(e,s).catch(async s=>{if("AUDIT"===e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")&&("auth/missing-recaptcha-token"===s.code||"auth/invalid-app-credential"===s.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const s=await On(e,t,n,!1,!0);return r(e,s)}return Promise.reject(s)})}{const s=await On(e,t,n,!1,!0);return r(e,s)}}return Promise.reject(s+" provider is not supported.")}async function Fn(e){const t=Tn(e),n=await Ht(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new qt(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Ln(t).verify()}}function Un(e,t,n){const r=Tn(e);kt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!n?.disableWarnings,i=Vn(t),{host:a,port:o}=function(e){const t=Vn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:zn(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:zn(t)}}}(t),l=null===o?"":`:${o}`,c={url:`${i}//${a}${l}/`},u=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator)return kt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void kt(j(c,r.config.emulator)&&j(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,y(a)?(v(`${i}//${a}${l}`),k("Auth",!0)):s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Vn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function zn(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Bn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _t("not implemented")}_getIdTokenResponse(e){return _t("not implemented")}_linkToIdToken(e,t){return _t("not implemented")}_getReauthenticationResolver(e){return _t("not implemented")}}async function $n(e,t){return Ot(e,"POST","/v1/accounts:signUp",t)}async function qn(e,t){return Ft(e,"POST","/v1/accounts:signInWithPassword",Lt(e,t))}async function Hn(e,t){return Ot(e,"POST","/v1/accounts:sendOobCode",Lt(e,t))}async function Wn(e,t){return Hn(e,t)}class Gn extends Bn{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Gn(e,t,"password")}static _fromEmailAndCode(e,t){return new Gn(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Mn(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",qn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithEmailLink",Lt(e,t))}(e,{email:this._email,oobCode:this._password});default:yt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Mn(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$n,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithEmailLink",Lt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:yt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Kn(e,t){return Ft(e,"POST","/v1/accounts:signInWithIdp",Lt(e,t))}class Qn extends Bn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...s}=t;if(!n||!r)return null;const i=new Qn(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return Kn(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Kn(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Kn(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=R(t)}return e}}async function Yn(e,t){return Ot(e,"POST","/v1/accounts:sendVerificationCode",Lt(e,t))}const Jn={USER_NOT_FOUND:"user-not-found"};class Xn extends Bn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Xn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Xn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithPhoneNumber",Lt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Ft(e,"POST","/v1/accounts:signInWithPhoneNumber",Lt(e,t));if(n.temporaryProof)throw Bt(e,"account-exists-with-different-credential",n);return n}(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return async function(e,t){return Ft(e,"POST","/v1/accounts:signInWithPhoneNumber",Lt(e,{...t,operation:"REAUTH"}),Jn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}=e;return n||t||r||s?new Xn({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}):null}}class Zn{constructor(e){const t=D(P(e)),n=t.apiKey??null,r=t.oobCode??null,s=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);kt(n&&r&&s,"argument-error"),this.apiKey=n,this.operation=s,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=D(P(e)).link,n=t?D(P(t)).deep_link_id:null,r=D(P(e)).deep_link_id;return(r?D(P(r)).link:null)||r||n||t||e}(e);try{return new Zn(t)}catch{return null}}}class er{constructor(){this.providerId=er.PROVIDER_ID}static credential(e,t){return Gn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Zn.parseLink(t);return kt(n,"argument-error"),Gn._fromEmailAndCode(e,n.code,n.tenantId)}}er.PROVIDER_ID="password",er.EMAIL_PASSWORD_SIGN_IN_METHOD="password",er.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class tr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class nr extends tr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class rr extends nr{constructor(){super("facebook.com")}static credential(e){return Qn._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return rr.credential(t.oauthAccessToken)}catch{return null}}}rr.FACEBOOK_SIGN_IN_METHOD="facebook.com",rr.PROVIDER_ID="facebook.com";class sr extends nr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qn._fromParams({providerId:sr.PROVIDER_ID,signInMethod:sr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return sr.credentialFromTaggedObject(e)}static credentialFromError(e){return sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return sr.credential(n,r)}catch{return null}}}sr.GOOGLE_SIGN_IN_METHOD="google.com",sr.PROVIDER_ID="google.com";class ir extends nr{constructor(){super("github.com")}static credential(e){return Qn._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ir.credential(t.oauthAccessToken)}catch{return null}}}ir.GITHUB_SIGN_IN_METHOD="github.com",ir.PROVIDER_ID="github.com";class ar extends nr{constructor(){super("twitter.com")}static credential(e,t){return Qn._fromParams({providerId:ar.PROVIDER_ID,signInMethod:ar.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ar.credentialFromTaggedObject(e)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return ar.credential(n,r)}catch{return null}}}ar.TWITTER_SIGN_IN_METHOD="twitter.com",ar.PROVIDER_ID="twitter.com";class or{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=await sn._fromIdTokenResponse(e,n,r),i=lr(n);return new or({user:s,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=lr(n);return new or({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function lr(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class cr extends T{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,cr.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new cr(e,t,n,r)}}function ur(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw cr._fromErrorAndOperation(e,n,t,r);throw n})}async function dr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Jt(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return or._forOperation(e,"link",r)}async function hr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Qe(r.app))return Promise.reject(xt(r));const s="reauthenticate";try{const i=await Jt(e,ur(r,s,t,e),n);kt(i.idToken,r,"internal-error");const a=Qt(i.idToken);kt(a,r,"internal-error");const{sub:o}=a;return kt(e.uid===o,r,"user-mismatch"),or._forOperation(e,s,i)}catch(i){throw"auth/user-not-found"===i?.code&&yt(r,"user-mismatch"),i}}async function fr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Qe(e.app))return Promise.reject(xt(e));const r="signIn",s=await ur(e,r,t),i=await or._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(i.user),i}async function pr(e,t){return fr(Tn(e),t)}function gr(e,t,n){kt(n.url?.length>0,e,"invalid-continue-uri"),kt("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),kt("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(kt(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(kt(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function mr(e){const t=Tn(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function yr(e,t){return Ot(e,"POST","/v2/accounts/mfaEnrollment:start",Lt(e,t))}new WeakMap;const vr="__sak";class br{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vr,"1"),this.storage.removeItem(vr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class xr extends br{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);wn()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xr.type="LOCAL";const wr=xr;function kr(e){const t=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${t}=([^;]+)`);return document.cookie.match(n)?.[1]??null}function _r(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class Nr{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(navigator.cookieEnabled??!0))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=_r(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return e?.value}return kr(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=_r(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=_r(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=kr(n);const s=setInterval(()=>{const e=kr(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(s))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Nr.type="COOKIE";class Er extends br{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Er.type="SESSION";const Sr=Er;class Tr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Tr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!i?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(i).map(async e=>e(t.origin,s)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Cr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Tr.receivers=[];class Ir{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise((a,o)=>{const l=Cr("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(t.data.response);break;default:clearTimeout(c),clearTimeout(s),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function jr(){return window}function Ar(){return"undefined"!==typeof jr().WorkerGlobalScope&&"function"===typeof jr().importScripts}const Rr="firebaseLocalStorageDb",Dr="firebaseLocalStorage",Pr="fbase_key";class Lr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Or(e,t){return e.transaction([Dr],t?"readwrite":"readonly").objectStore(Dr)}function Mr(){const e=indexedDB.open(Rr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Dr,{keyPath:Pr})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Dr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Rr);return new Lr(e).toPromise()}(),t(await Mr()))})})}async function Fr(e,t,n){const r=Or(e,!0).put({[Pr]:t,value:n});return new Lr(r).toPromise()}function Ur(e,t){const n=Or(e,!0).delete(t);return new Lr(n).toPromise()}class Vr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Mr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ar()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tr._getInstance(Ar()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new Ir(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mr();return await Fr(e,vr,"1"),await Ur(e,vr),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Fr(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Or(e,!1).get(t),r=await new Lr(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ur(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Or(e,!1).getAll();return new Lr(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Vr.type="LOCAL";const zr=Vr;function Br(e,t){return Ot(e,"POST","/v2/accounts/mfaSignIn:start",Lt(e,t))}An("rcb"),new It(3e4,6e4);const $r="recaptcha";async function qr(e,t,n){if(!e._getRecaptchaConfig())try{await Fn(e)}catch(r){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(r="string"===typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){kt("enroll"===t.type,e,"internal-error");const s={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=Mn(e,s,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Pn){kt(n?.type===$r,e,"argument-error");return yr(e,await Hr(e,t,n))}return yr(e,t)},"PHONE_PROVIDER");return(await i.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{kt("signin"===t.type,e,"internal-error");const s=r.multiFactorHint?.uid||r.multiFactorUid;kt(s,e,"missing-multi-factor-info");const i={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=Mn(e,i,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Pn){kt(n?.type===$r,e,"argument-error");return Br(e,await Hr(e,t,n))}return Br(e,t)},"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"},s=Mn(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Pn){kt(n?.type===$r,e,"argument-error");return Yn(e,await Hr(e,t,n))}return Yn(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).sessionInfo}}finally{n?._reset()}}async function Hr(e,t,n){kt(n.type===$r,e,"argument-error");const r=await n.verify();kt("string"===typeof r,e,"argument-error");const s={...t};if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.captchaResponse,n=s.phoneEnrollmentInfo.clientType,i=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:i}}),s}if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.captchaResponse,t=s.phoneSignInInfo.clientType,n=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),s}return Object.assign(s,{recaptchaToken:r}),s}class Wr{constructor(e){this.providerId=Wr.PROVIDER_ID,this.auth=Tn(e)}verifyPhoneNumber(e,t){return qr(this.auth,e,M(t))}static credential(e,t){return Xn._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Wr.credentialFromTaggedObject(t)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Xn._fromTokenResponse(n,r):null}}function Gr(e,t){return t?on(t):(kt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Wr.PROVIDER_ID="phone",Wr.PHONE_SIGN_IN_METHOD="phone";class Kr extends Bn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Kn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Kn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Kn(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Qr(e){return fr(e.auth,new Kr(e),e.bypassAuthState)}function Yr(e){const{auth:t,user:n}=e;return kt(n,t,"internal-error"),hr(n,new Kr(e),e.bypassAuthState)}async function Jr(e){const{auth:t,user:n}=e;return kt(n,t,"internal-error"),dr(n,new Kr(e),e.bypassAuthState)}class Xr{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:i,type:a}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qr;case"linkViaPopup":case"linkViaRedirect":return Jr;case"reauthViaPopup":case"reauthViaRedirect":return Yr;default:yt(this.auth,"internal-error")}}resolve(e){Nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zr=new It(2e3,1e4);class es extends Xr{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,es.currentPopupAction&&es.currentPopupAction.cancel(),es.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return kt(e,this.auth,"internal-error"),e}async onExecution(){Nt(1===this.filter.length,"Popup operations only handle one event");const e=Cr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(vt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(vt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,es.currentPopupAction=null}pollUserCancellation(){const e=()=>{this.authWindow?.window?.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vt(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Zr.get())};e()}}es.currentPopupAction=null;const ts=new Map;class ns extends Xr{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ts.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=is(t),r=ss(e);if(!await r._isAvailable())return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ts.set(this.auth._key(),e)}return this.bypassAuthState||ts.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function rs(e,t){ts.set(e._key(),t)}function ss(e){return on(e._redirectPersistence)}function is(e){return un("pendingRedirect",e.config.apiKey,e.name)}async function as(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Qe(e.app))return Promise.reject(xt(e));const r=Tn(e),s=Gr(r,t),i=new ns(r,s,n),a=await i.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}class os{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cs(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!cs(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(vt(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ls(e))}saveEventToCache(e){this.cachedEventUids.add(ls(e)),this.lastProcessedEventTime=Date.now()}}function ls(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function cs(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===n?.code}const us=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ds=/^https?/;async function hs(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Ot(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const n of t)try{if(fs(n))return}catch{}yt(e,"unauthorized-domain")}function fs(e){const t=Et(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!ds.test(n))return!1;if(us.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const ps=new It(3e4,6e4);function gs(){const e=jr().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function ms(e){return new Promise((t,n)=>{function r(){gs(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{gs(),n(vt(e,"network-request-failed"))},timeout:ps.get()})}if(jr().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else{if(!jr().gapi?.load){const t=An("iframefcb");return jr()[t]=()=>{gapi.load?r():n(vt(e,"network-request-failed"))},jn(`${In.gapiScript}?onload=${t}`).catch(e=>n(e))}r()}}).catch(e=>{throw ys=null,e})}let ys=null;const vs=new It(5e3,15e3),bs={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xs=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ws(e){const t=e.config;kt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?jt(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Xe},s=xs.get(e.config.apiHost);s&&(r.eid=s);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${R(r).slice(1)}`}async function ks(e){const t=await function(e){return ys=ys||ms(e),ys}(e),n=jr().gapi;return kt(n,e,"internal-error"),t.open({where:document.body,url:ws(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bs,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=vt(e,"network-request-failed"),i=jr().setTimeout(()=>{r(s)},vs.get());function a(){jr().clearTimeout(i),n(t)}t.ping(a).then(a,()=>{r(s)})}))}const _s={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ns{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Es(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l={..._s,width:r.toString(),height:s.toString(),top:i,left:a},c=_().toLowerCase();n&&(o=gn(c)?"_blank":n),fn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){return xn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:_())&&!!window.navigator?.standalone}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Ns(null);const d=window.open(t||"",o,u);kt(d,e,"popup-blocked");try{d.focus()}catch(h){}return new Ns(d)}const Ss="__/auth/handler",Ts="emulator/auth/handler",Cs=encodeURIComponent("fac");async function Is(e,t,n,r,s,i){kt(e.config.authDomain,e,"auth-domain-config-required"),kt(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Xe,eventId:s};if(t instanceof tr){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))a[e]=t}if(t instanceof nr){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${Cs}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Ss}`;return jt(t,Ts)}(e)}?${R(o).slice(1)}${c}`}const js="webStorageSupport";const As=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Sr,this._completeRedirectFn=as,this._overrideRedirectResult=rs}async _openPopup(e,t,n,r){Nt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");return Es(e,await Is(e,t,n,Et(),r),Cr())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){jr().location.href=e}(await Is(e,t,n,Et(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Nt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await ks(e),n=new os(e);return t.register("authEvent",t=>{kt(t?.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(js,{type:js},n=>{const r=n?.[0]?.[js];void 0!==r&&t(!!r),yt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=hs(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kn()||pn()||xn()}};var Rs="@firebase/auth",Ds="1.11.0";class Ps{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){kt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ls=g("authIdTokenMaxAge")||300;let Os=null;var Ms;In={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=vt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ms="Browser",Ge(new F("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;kt(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:Ms,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_n(Ms)},c=new Sn(r,s,i,l);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(on);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Ge(new F("auth-internal",e=>(e=>new Ps(e))(Tn(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),tt(Rs,Ds,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ms)),tt(Rs,Ds,"esm2020");var Fs,Us,Vs="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},zs={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],a=t+(i^n&(s^i))+r[0]+3614090360&4294967295;a=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=n+(a<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^i&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^s^i)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(s^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((i=(t=n+((a=t+(s^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((s=i+((a=s+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=0|e[s];r&&i==t||(n[s]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,s=this.B,i=this.h,a=0;a<t;){if(0==i)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(s[i++]=e.charCodeAt(a++),i==this.blockSize){n(this,s),i=0;break}}else for(;a<t;)if(s[i++]=e[a++],i==this.blockSize){n(this,s),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var s={};function i(e){return-128<=e&&128>e?function(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return h(a(-e));for(var t=[],n=1,s=0;e>=n;s++)t[s]=e/n|0,n*=4294967296;return new r(t,0)}var o=i(0),l=i(1),c=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],s=0;s<t;s++)n[s]=~e.g[s];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function m(e,t){if(u(t))throw Error("division by zero");if(u(e))return new g(o,o);if(d(e))return t=m(h(e),t),new g(h(t.g),h(t.h));if(d(t))return t=m(e,h(t)),new g(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=y(n),r=y(r);var s=v(n,1),i=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=i.add(r);0>=c.l(e)&&(s=s.add(n),i=c),r=v(r,1),n=v(n,1)}return t=f(e,s.j(t)),new g(s,t)}for(s=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(i=a(n)).j(t);d(c)||0<c.l(e);)c=(i=a(n-=r)).j(t);u(i)&&(i=l),s=s.add(i),e=f(e,c)}return new g(s,e)}function y(e){for(var t=e.g.length+1,n=[],s=0;s<t;s++)n[s]=e.i(s)<<1|e.i(s-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var s=e.g.length-n,i=[],a=0;a<s;a++)i[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new r(i,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=a(Math.pow(e,6)),n=this,r="";;){var s=m(n,t).g,i=((0<(n=f(n,s.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=s))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0,i=0;i<=t;i++){var a=s+(65535&this.i(i))+(65535&e.i(i)),o=(a>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);s=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],s=0;s<2*t;s++)n[s]=0;for(s=0;s<this.g.length;s++)for(var i=0;i<e.g.length;i++){var l=this.i(s)>>>16,f=65535&this.i(s),g=e.i(i)>>>16,m=65535&e.i(i);n[2*s+2*i]+=f*m,p(n,2*s+2*i),n[2*s+2*i+1]+=l*m,p(n,2*s+2*i+1),n[2*s+2*i+1]+=f*g,p(n,2*s+2*i+1),n[2*s+2*i+2]+=l*g,p(n,2*s+2*i+2)}for(s=0;s<t;s++)n[s]=n[2*s+1]<<16|n[2*s];for(s=t;s<2*t;s++)n[s]=0;return new r(n,0)},e.A=function(e){return m(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)&e.i(s);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)|e.i(s);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)^e.i(s);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Us=zs.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=a(Math.pow(n,8)),s=o,i=0;i<t.length;i+=8){var l=Math.min(8,t.length-i),c=parseInt(t.substring(i,i+l),n);8>l?(l=a(Math.pow(n,l)),s=s.j(l).add(a(c))):s=(s=s.j(r)).add(a(c))}return s},Fs=zs.Integer=r}).apply("undefined"!==typeof Vs?Vs:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Bs,$s,qs,Hs,Ws,Gs,Ks,Qs,Ys="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Js={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ys&&Ys];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var s=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var a=e[i];if(!(a in s))break e;s=s[a]}(r=r(i=s[e=e[e.length-1]]))!=i&&null!=r&&t(s,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,s={next:function(){if(!r&&n<e.length){var s=n++;return{value:t(s,e[s]),done:!1}}return r=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,function(e,t){return t})}});var r=r||{},s=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let s=0;s<r;s++)e[n+s]=t[s]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function g(){var e=s.navigator;return e&&(e=e.userAgent)?e:""}function m(e){return m[" "](e),e}m[" "]=function(){};var y=-1!=g().indexOf("Gecko")&&!(-1!=g().toLowerCase().indexOf("webkit")&&-1==g().indexOf("Edge"))&&!(-1!=g().indexOf("Trident")||-1!=g().indexOf("MSIE"))&&-1==g().indexOf("Edge");function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(e,t){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)e[n]=r[n];for(let t=0;t<x.length;t++)n=x[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function k(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function _(e){s.setTimeout(()=>{throw e},0)}function N(){var e=I;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var E=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new S,e=>e.reset());class S{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let T,C=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){const n=E.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},j=()=>{const e=s.Promise.resolve(void 0);T=()=>{e.then(A)}};var A=()=>{for(var e;e=N();){try{e.h.call(e.g)}catch(n){_(n)}var t=E;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}C=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{m(t.nodeName);var s=!0;break e}catch(i){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:O[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}d(L,D);var O={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=s,this.key=++F,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,s=e.g[n],i=Array.prototype.indexOf.call(s,t,void 0);(r=0<=i)&&Array.prototype.splice.call(s,i,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function $(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return s}return-1}z.prototype.add=function(e,t,n,r,s){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var a=$(e,t,r,s);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new U(t,this.src,i,!!r,s)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),H={};function W(e,t,n,r,s){if(r&&r.once)return K(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)W(e,t[i],n,r,s);return null}return n=te(n),e&&e[M]?e.K(t,n,a(r)?!!r.capture:!!r,s):G(e,t,n,!1,r,s)}function G(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,l=Z(e);if(l||(e[q]=l=new z(e)),(n=l.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(J(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function K(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)K(e,t[i],n,r,s);return null}return n=te(n),e&&e[M]?e.L(t,n,a(r)?!!r.capture:!!r,s):G(e,t,n,!0,r,s)}function Q(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)Q(e,t[i],n,r,s);else r=a(r)?!!r.capture:!!r,n=te(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=$(i=e.g[t],n,r,s))&&(V(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,n,r,s)),(n=-1<e?t[e]:null)&&Y(n))}function Y(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(J(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(B(n,e),0==n.h&&(n.src=null,t[q]=null)):V(e)}}}function J(e){return e in H?H[e]:H[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Y(e),e=n.call(r,t)}return e}function Z(e){return(e=e[q])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new z(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var s=t;w(t=new D(r,e),s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var a=t.g=n[i];s=se(a,r,!0,t)&&s}if(s=se(a=t.g=e,r,!0,t)&&s,s=se(a,r,!1,t)&&s,n)for(i=0;i<n.length;i++)s=se(a=t.g=n[i],r,!1,t)&&s}function se(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var a=t[i];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&B(e.i,a),s=!1!==o.call(l,r)&&s}}return s&&!r.defaultPrevented}function ie(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:s.setTimeout(e,t||0)}function ae(e){e.g=ie(()=>{e.g=null,e.i&&(e.i=!1,ae(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,R),ne.prototype[M]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ae(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}d(le,R);var ce=[];function ue(e){v(e.g,function(e,t){this.g.hasOwnProperty(t)&&Y(e)},e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=s.JSON.stringify,he=s.JSON.parse,fe=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function pe(){}function ge(e){return e.h||(e.h=e.i())}function me(){}pe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){D.call(this,"d")}function be(){D.call(this,"c")}d(ve,D),d(be,D);var xe={},we=null;function ke(){return we=we||new ne}function _e(e){D.call(this,xe.La,e)}function Ne(e){const t=ke();re(t,new _e(t))}function Ee(e,t){D.call(this,xe.STAT_EVENT,e),this.stat=t}function Se(e){const t=ke();re(t,new Ee(t,e))}function Te(e,t){D.call(this,xe.Ma,e),this.size=t}function Ce(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function Ie(){this.g=!0}function je(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var a=1;a<s.length;a++)s[a]=""}}}return de(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}xe.La="serverreachability",d(_e,D),xe.STAT_EVENT="statevent",d(Ee,D),xe.Ma="timingevent",d(Te,D),Ie.prototype.xa=function(){this.g=!1},Ie.prototype.info=function(){};var Ae,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Pe(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Oe}function Oe(){this.i=null,this.g="",this.h=!1}d(Pe,pe),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},Ae=new Pe;var Me={},Fe={};function Ue(e,t,n){e.L=1,e.v=dt(at(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),$e(e),e.A=at(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Et(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Oe,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var s="readystatechange";Array.isArray(s)||(s&&(ce[0]=s.toString()),s=ce);for(var i=0;i<s.length;i++){var a=W(n,s[i],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ne(),function(e,t,n,r,s,i){e.info(function(){if(e.g)if(i)for(var a="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function $e(e){e.S=Date.now()+e.I,qe(e,e.I)}function qe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ce(c(e.ba,e),t)}function He(e){e.B&&(s.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||ln(e.j,e)}function Ge(e){He(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ke(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Yt(n)}rn(n),Se(18)}}else n.za=s[1],0<n.za-n.T&&37500>s[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ce(c(n.Za,n),6e3));if(1>=Xe(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&on(n),!p(t))for(s=n.Da.g.parse(t),t=0;t<s.length;t++){let c=s[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const s=c[4];null!=s&&(n.Aa=s,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(et(i,i.h),i.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=hn(r,r.J?r.ia:null,r.W),a.K){tt(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(He(o),$e(o)),r.g=a}else nn(r);0<n.i.length&&Xt(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Ne()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Ht(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const h=Ht(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Wt(this.g)))){this.J||4!=h||7==t||Ne(),He(this);var n=this.g.Z();this.X=n;t:if(ze(this)){var r=Wt(this.g);e="";var i=r.length,a=4==Ht(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ge(this),We(this);var o="";break t}this.h.i=new s.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,s,i,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+i+" "+a})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Se(12),Ge(this),We(this);break e}je(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ke(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Be(this,o),e==Fe){4==h&&(this.s=4,Se(14),n=!1),je(this.i,this.l,null,"[Incomplete Response]");break}if(e==Me){this.s=4,Se(15),je(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}je(this.i,this.l,e,null),Ke(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Se(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),sn(d),d.M=!0,Se(11))}}else je(this.i,this.l,o,"[Invalid Chunked Response]"),Ge(this),We(this)}else je(this.i,this.l,o,null),Ke(this,o);4==h&&Ge(this),this.o&&!this.J&&(4==h?ln(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=Ht(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=k(e[r]);const s=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Se(12)):(this.s=0,Se(13)),Ge(this),We(this)}}}catch(h){}},Le.prototype.cancel=function(){this.J=!0,Ge(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Ne(),Se(17)),Ge(this),this.s=2,We(this)):qe(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ye(e){this.l=e||10,s.PerformanceNavigationTiming?e=0<(e=s.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),s=r.length,a=0;a<s;a++)t.call(void 0,r[a],n&&n[a],e)}Ye.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var st=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new wt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(st))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),lt(this,t[4]),this.l=ht(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new wt(null,this.h))}function at(e){return new it(e)}function ot(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof wt?(e.i=t,function(e,t){t&&!e.j&&(kt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(_t(this,t),Et(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,bt)),e.i=new wt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function dt(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,mt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,mt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,xt)),e.join("")};var gt,mt=/[#\/\?@]/g,yt=/[#\?:]/g,vt=/[#\?]/g,bt=/[#\?@]/g,xt=/#/g;function wt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function kt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function _t(e,t){kt(e),t=St(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nt(e,t){return kt(e),t=St(e,t),e.g.has(t)}function Et(e,t,n){_t(e,t),0<n.length&&(e.i=null,e.g.set(St(e,t),h(n)),e.h+=n.length)}function St(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Tt(e,t,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(i){}}function Ct(){this.g=new fe}function It(e,t,n){const r=n||"";try{rt(e,function(e,n){let s=e;a(e)&&(s=de(e)),t.push(r+n+"="+encodeURIComponent(s))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function jt(e){this.l=e.Ub||null,this.j=e.eb||!1}function At(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Dt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Pt(e)}function Pt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Lt(e){let t="";return v(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Ot(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Lt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Mt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=wt.prototype).add=function(e,t){kt(this),this.i=null,e=St(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){kt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){kt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let e=0;e<s.length;e++)n.push(t[r])}return n},e.V=function(e){kt(this);let t=[];if("string"===typeof e)Nt(this,e)&&(t=t.concat(this.g.get(St(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return kt(this),this.i=null,Nt(this,e=St(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var s=i;""!==a[r]&&(s+="="+encodeURIComponent(String(a[r]))),e.push(s)}}return this.i=e.join("&")},d(jt,pe),jt.prototype.g=function(){return new At(this.l,this.j)},jt.prototype.i=(gt={},function(){return gt}),d(At,ne),(e=At.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Pt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||s).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Dt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Pt(this)),this.g&&(this.readyState=3,Pt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Dt(this):Pt(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Dt(this))},e.Qa=function(e){this.g&&(this.response=e,Dt(this))},e.ga=function(){this.g&&Dt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(At.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Mt,ne);var Ft=/^https?$/i,Ut=["POST","PUT"];function Vt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,zt(e),$t(e)}function zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Bt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Ht(e)||2!=e.Z()))if(e.u&&4==Ht(e))ie(e.Ea,0,e);else if(re(e,"readystatechange"),4==Ht(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var a=String(e.D).match(st)[1]||null;!a&&s.self&&s.self.location&&(a=s.self.location.protocol.slice(0,-1)),i=!Ft.test(a?a.toLowerCase():"")}n=i}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<Ht(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",zt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){qt(e);const r=e.g,s=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=s}catch(n){}}}function qt(e){e.I&&(s.clearTimeout(e.I),e.I=null)}function Ht(e){return e.g?e.g.readyState:0}function Wt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Gt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Kt(e){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gt("baseRetryDelayMs",5e3,e),this.cb=Gt("retryDelaySeedMs",1e4,e),this.Wa=Gt("forwardChannelMaxRetries",2,e),this.wa=Gt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ye(e&&e.concurrentRequestLimit),this.Da=new Ct,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Jt(e),3==e.G){var t=e.U++,n=at(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Le(e,e.j,t)).L=2,t.v=dt(at(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}dn(e)}function Yt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Jt(e){Yt(e),e.u&&(s.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&s.clearTimeout(e.s),e.s=null)}function Xt(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;T||j(),C||(T(),C=!0),I.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=at(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&Ot(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function en(e,t){e.H&&v(e.H,function(e,n){ut(t,n,e)}),e.l&&rt({},function(e,n){ut(t,n,e)})}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var s=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let o=0;o<n;o++){let n=s[o].g;const l=s[o].map;if(n-=t,0>n)t=Math.max(0,s[o].g-100),a=!1;else try{It(l,e,"req"+n+"_")}catch(i){r&&r(l)}}if(a){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;T||j(),C||(T(),C=!0),I.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ce(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(s.clearTimeout(e.A),e.A=null)}function an(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=at(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Ot(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(at(t)),n.m=null,n.P=!0,Ve(n,e)}function on(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),sn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var s=e.B;re(r=ke(),new Te(r,n)),Xt(e)}else nn(e);else if(3==(s=t.s)||0==s&&0<t.X||!(1==r&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ce(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),s){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new it(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||ot(r,"https"),dt(r),t?function(e,t){const n=new Ie;if(s.Image){const r=new Image;r.onload=u(Tt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Tt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Tt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Tt,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ie;const n=new AbortController,r=setTimeout(()=>{n.abort(),Tt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Tt(0,0,!0,t):Tt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Tt(0,0,!1,t)})}(r.toString(),n)}else Se(2);e.G=0,e.l&&e.l.sa(t),dn(e),Jt(e)}function dn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var r=n instanceof it?at(n):new it(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new it(null);r&&ot(a,r),t&&(a.g=t),i&&lt(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Mt(new jt({eb:n})):new Mt(e.pa)).Ha(e.J),t}function pn(){}function gn(){}function mn(e,t){ne.call(this),this.g=new Kt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function yn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=Mt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ae.g(),this.v=this.o?ge(this.o):ge(Ae),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Vt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=s.FormData&&e instanceof s.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qt(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Vt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Mt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Bt(this):this.bb())},e.bb=function(){Bt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Ht(this)?this.g.status:-1}catch(gt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(gt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Kt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Se(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=hn(this,null,this.W),Xt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const s=new Le(this,this.j,e);let i=this.o;if(this.S&&(i?(i=b(i),w(i,this.S)):i=this.S),null!==this.m||this.O||(s.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,s,t),ut(n=at(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Lt(i)))+"&"+t:this.m&&Ot(n,this.m,i)),et(this.h,s),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),s.T=!0,Ue(s,n,null)):Ue(s,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Je(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,an(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ce(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Se(10),Yt(this),an(this))},e.Za=function(){null!=this.C&&(this.C=null,Yt(this),rn(this),Se(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Se(2)):(this.j.info("Failed to ping google.com"),Se(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},gn.prototype.g=function(e,t){return new mn(e,t)},d(mn,ne),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){Qt(this.g)},mn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Xt(t)},mn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,mn.aa.N.call(this)},d(yn,ve),d(vn,be),d(bn,pn),bn.prototype.ua=function(){re(this.g,"a")},bn.prototype.ta=function(e){re(this.g,new yn(e))},bn.prototype.sa=function(e){re(this.g,new vn)},bn.prototype.ra=function(){re(this.g,"b")},gn.prototype.createWebChannel=gn.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,Qs=Js.createWebChannelTransport=function(){return new gn},Ks=Js.getStatEventTarget=function(){return ke()},Gs=Js.Event=xe,Ws=Js.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Hs=Js.ErrorCode=Re,De.COMPLETE="complete",qs=Js.EventType=De,me.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,$s=Js.WebChannel=me,Js.FetchXmlHttpFactory=jt,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,Bs=Js.XhrIo=Mt}).apply("undefined"!==typeof Ys?Ys:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Xs="@firebase/firestore",Zs="4.9.0";class ei{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ei.UNAUTHENTICATED=new ei(null),ei.GOOGLE_CREDENTIALS=new ei("google-credentials-uid"),ei.FIRST_PARTY=new ei("first-party-uid"),ei.MOCK_USER=new ei("mock-user");let ti="12.0.0";const ni=new K("@firebase/firestore");function ri(){return ni.logLevel}function si(e){if(ni.logLevel<=$.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(oi);ni.debug(`Firestore (${ti}): ${e}`,...s)}}function ii(e){if(ni.logLevel<=$.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(oi);ni.error(`Firestore (${ti}): ${e}`,...s)}}function ai(e){if(ni.logLevel<=$.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(oi);ni.warn(`Firestore (${ti}): ${e}`,...s)}}function oi(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function li(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ci(e,r,n)}function ci(e,t,n){let r=`FIRESTORE (${ti}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw ii(r),new Error(r)}function ui(e,t,n,r){let s="Unexpected state";"string"==typeof n?s=n:r=n,e||ci(t,s,r)}function di(e,t){return e}const hi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fi extends T{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class gi{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ei.UNAUTHENTICATED))}shutdown(){}}class yi{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class vi{constructor(e){this.t=e,this.currentUser=ei.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ui(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new pi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pi,e.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const t=s;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{si("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(si("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pi)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(si("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ui("string"==typeof t.accessToken,31837,{l:t}),new gi(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ui(null===e||"string"==typeof e,2055,{h:e}),new ei(e)}}class bi{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=ei.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class xi{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new bi(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ei.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wi{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ki{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qe(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ui(void 0===this.o,3512);const n=e=>{null!=e.error&&si("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,si("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{si("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):si("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new wi(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(ui("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new wi(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function _i(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Ni{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=_i(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Ei(e,t){return e<t?-1:e>t?1:0}function Si(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),s=t.charAt(r);if(n!==s)return Ii(n)===Ii(s)?Ei(n,s):Ii(n)?1:-1}return Ei(e.length,t.length)}const Ti=55296,Ci=57343;function Ii(e){const t=e.charCodeAt(0);return t>=Ti&&t<=Ci}function ji(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Ai="__name__";class Ri{constructor(e,t,n){void 0===t?t=0:t>e.length&&li(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&li(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Ri.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ri?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Ri.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Ei(e.length,t.length)}static compareSegments(e,t){const n=Ri.isNumericId(e),r=Ri.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Ri.extractNumericId(e).compare(Ri.extractNumericId(t)):Si(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fs.fromString(e.substring(4,e.length-2))}}class Di extends Ri{construct(e,t,n){return new Di(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n){if(s.indexOf("//")>=0)throw new fi(hi.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);e.push(...s.split("/").filter(e=>e.length>0))}return new Di(e)}static emptyPath(){return new Di([])}}const Pi=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Li extends Ri{construct(e,t,n){return new Li(e,t,n)}static isValidIdentifier(e){return Pi.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Li.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ai}static keyField(){return new Li([Ai])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new fi(hi.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new fi(hi.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new fi(hi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new fi(hi.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Li(t)}static emptyPath(){return new Li([])}}class Oi{constructor(e){this.path=e}static fromPath(e){return new Oi(Di.fromString(e))}static fromName(e){return new Oi(Di.fromString(e).popFirst(5))}static empty(){return new Oi(Di.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Di.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Di.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oi(new Di(e.slice()))}}function Mi(e,t,n){if(!n)throw new fi(hi.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Fi(e){if(!Oi.isDocumentKey(e))throw new fi(hi.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ui(e){if(Oi.isDocumentKey(e))throw new fi(hi.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Vi(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function zi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":li(12329,{type:typeof e})}function Bi(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new fi(hi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zi(e);throw new fi(hi.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function $i(e,t){const n={typeString:e};return t&&(n.value=t),n}function qi(e,t){if(!Vi(e))throw new fi(hi.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const s=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const a=e[r];if(s&&typeof a!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(void 0!==i&&a!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new fi(hi.INVALID_ARGUMENT,n);return!0}const Hi=-62135596800,Wi=1e6;class Gi{static now(){return Gi.fromMillis(Date.now())}static fromDate(e){return Gi.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Wi);return new Gi(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new fi(hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new fi(hi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Hi)throw new fi(hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new fi(hi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Wi}_compareTo(e){return this.seconds===e.seconds?Ei(this.nanoseconds,e.nanoseconds):Ei(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Gi._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qi(e,Gi._jsonSchema))return new Gi(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Hi;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Gi._jsonSchemaVersion="firestore/timestamp/1.0",Gi._jsonSchema={type:$i("string",Gi._jsonSchemaVersion),seconds:$i("number"),nanoseconds:$i("number")};class Ki{static fromTimestamp(e){return new Ki(e)}static min(){return new Ki(new Gi(0,0))}static max(){return new Ki(new Gi(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Qi=-1;class Yi{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Yi.UNKNOWN_ID=-1;function Ji(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=Ki.fromTimestamp(1e9===r?new Gi(n+1,0):new Gi(n,r));return new Zi(s,Oi.empty(),t)}function Xi(e){return new Zi(e.readTime,e.key,Qi)}class Zi{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Zi(Ki.min(),Oi.empty(),Qi)}static max(){return new Zi(Ki.max(),Oi.empty(),Qi)}}function ea(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Oi.comparator(e.documentKey,t.documentKey),0!==n?n:Ei(e.largestBatchId,t.largestBatchId))}const ta="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class na{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ra(e){if(e.code!==hi.FAILED_PRECONDITION||e.message!==ta)throw e;si("LocalStore","Unexpectedly lost primary lease")}class sa{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&li(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new sa((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof sa?t:sa.resolve(t)}catch(e){return sa.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):sa.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):sa.reject(t)}static resolve(e){return new sa((t,n)=>{t(e)})}static reject(e){return new sa((t,n)=>{n(e)})}static waitFor(e){return new sa((t,n)=>{let r=0,s=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++s,i&&s===r&&t()},e=>n(e))}),i=!0,s===r&&t()})}static or(e){let t=sa.resolve(!1);for(const n of e)t=t.next(e=>e?sa.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new sa((n,r)=>{const s=e.length,i=new Array(s);let a=0;for(let o=0;o<s;o++){const l=o;t(e[l]).next(e=>{i[l]=e,++a,a===s&&n(i)},e=>r(e))}})}static doWhile(e,t){return new sa((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}function ia(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function aa(e){return"IndexedDbTransactionError"===e.name}class oa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}oa.ce=-1;const la=-1;function ca(e){return null==e}function ua(e){return 0===e&&1/e==-1/0}function da(e){return"number"==typeof e&&Number.isInteger(e)&&!ua(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const ha="\x01";function fa(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ga(t)),t=pa(e.get(n),t);return ga(t)}function pa(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="\x01\x10";break;case ha:n+="\x01\x11";break;default:n+=t}}return n}function ga(e){return e+ha+"\x01"}const ma="remoteDocuments",ya="owner",va="mutationQueues",ba="mutations";const xa="documentMutations",wa="remoteDocumentsV14",ka="remoteDocumentGlobal",_a="targets",Na="targetDocuments",Ea="targetGlobal",Sa="collectionParents",Ta="clientMetadata",Ca="bundles",Ia="namedQueries",ja="indexConfiguration",Aa="indexState",Ra="indexEntries",Da="documentOverlays",Pa="globals",La=[va,ba,xa,ma,_a,ya,Ea,Na,Ta,ka,Sa,Ca,Ia],Oa=[va,ba,xa,wa,_a,ya,Ea,Na,Ta,ka,Sa,Ca,Ia,Da],Ma=Oa,Fa=[...Ma,ja,Aa,Ra];function Ua(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Va(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function za(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ba{constructor(e,t){this.comparator=e,this.root=t||qa.EMPTY}insert(e,t){return new Ba(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qa.BLACK,null,null))}remove(e){return new Ba(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $a(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $a(this.root,e,this.comparator,!1)}getReverseIterator(){return new $a(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $a(this.root,e,this.comparator,!0)}}class $a{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qa{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:qa.RED,this.left=null!=r?r:qa.EMPTY,this.right=null!=s?s:qa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new qa(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return qa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return qa.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw li(43730,{key:this.key,value:this.value});if(this.right.isRed())throw li(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw li(27949);return e+(this.isRed()?0:1)}}qa.EMPTY=null,qa.RED=!0,qa.BLACK=!1,qa.EMPTY=new class{constructor(){this.size=0}get key(){throw li(57766)}get value(){throw li(16141)}get color(){throw li(16727)}get left(){throw li(29726)}get right(){throw li(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new qa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ha{constructor(e){this.comparator=e,this.data=new Ba(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wa(this.data.getIterator())}getIteratorFrom(e){return new Wa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Ha))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ha(this.comparator);return t.data=e,t}}class Wa{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ga{constructor(e){this.fields=e,e.sort(Li.comparator)}static empty(){return new Ga([])}unionWith(e){let t=new Ha(Li.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ga(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ji(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Ka extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Qa{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ka("Invalid base64 string: "+e):e}}(e);return new Qa(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Qa(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ei(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qa.EMPTY_BYTE_STRING=new Qa("");const Ya=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ja(e){if(ui(!!e,39018),"string"==typeof e){let t=0;const n=Ya.exec(e);if(ui(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Xa(e.seconds),nanos:Xa(e.nanos)}}function Xa(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Za(e){return"string"==typeof e?Qa.fromBase64String(e):Qa.fromUint8Array(e)}const eo="server_timestamp",to="__type__",no="__previous_value__",ro="__local_write_time__";function so(e){const t=(e?.mapValue?.fields||{})[to]?.stringValue;return t===eo}function io(e){const t=e.mapValue.fields[no];return so(t)?io(t):t}function ao(e){const t=Ja(e.mapValue.fields[ro].timestampValue);return new Gi(t.seconds,t.nanos)}class oo{constructor(e,t,n,r,s,i,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const lo="(default)";class co{constructor(e,t){this.projectId=e,this.database=t||lo}static empty(){return new co("","")}get isDefaultDatabase(){return this.database===lo}isEqual(e){return e instanceof co&&e.projectId===this.projectId&&e.database===this.database}}const uo="__type__",ho="__max__",fo={mapValue:{fields:{__type__:{stringValue:ho}}}},po="__vector__",go="value";function mo(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?so(e)?4:Do(e)?9007199254740991:Ao(e)?10:11:li(28295,{value:e})}function yo(e,t){if(e===t)return!0;const n=mo(e);if(n!==mo(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ao(e).isEqual(ao(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Ja(e.timestampValue),r=Ja(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Za(e.bytesValue).isEqual(Za(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Xa(e.geoPointValue.latitude)===Xa(t.geoPointValue.latitude)&&Xa(e.geoPointValue.longitude)===Xa(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Xa(e.integerValue)===Xa(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Xa(e.doubleValue),r=Xa(t.doubleValue);return n===r?ua(n)===ua(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ji(e.arrayValue.values||[],t.arrayValue.values||[],yo);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Ua(n)!==Ua(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!yo(n[s],r[s])))return!1;return!0}(e,t);default:return li(52216,{left:e})}}function vo(e,t){return void 0!==(e.values||[]).find(e=>yo(e,t))}function bo(e,t){if(e===t)return 0;const n=mo(e),r=mo(t);if(n!==r)return Ei(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ei(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Xa(e.integerValue||e.doubleValue),r=Xa(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return xo(e.timestampValue,t.timestampValue);case 4:return xo(ao(e),ao(t));case 5:return Si(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Za(e),r=Za(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=Ei(n[s],r[s]);if(0!==e)return e}return Ei(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Ei(Xa(e.latitude),Xa(t.latitude));return 0!==n?n:Ei(Xa(e.longitude),Xa(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return wo(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=t.fields||{},s=n[go]?.arrayValue,i=r[go]?.arrayValue,a=Ei(s?.values?.length||0,i?.values?.length||0);return 0!==a?a:wo(s,i)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===fo.mapValue&&t===fo.mapValue)return 0;if(e===fo.mapValue)return 1;if(t===fo.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let a=0;a<r.length&&a<i.length;++a){const e=Si(r[a],i[a]);if(0!==e)return e;const t=bo(n[r[a]],s[i[a]]);if(0!==t)return t}return Ei(r.length,i.length)}(e.mapValue,t.mapValue);default:throw li(23264,{he:n})}}function xo(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Ei(e,t);const n=Ja(e),r=Ja(t),s=Ei(n.seconds,r.seconds);return 0!==s?s:Ei(n.nanos,r.nanos)}function wo(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=bo(n[s],r[s]);if(e)return e}return Ei(n.length,r.length)}function ko(e){return _o(e)}function _o(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Ja(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Za(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Oi.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=_o(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${_o(e.fields[s])}`;return n+"}"}(e.mapValue):li(61005,{value:e})}function No(e){switch(mo(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=io(e);return t?16+No(t):16;case 5:return 2*e.stringValue.length;case 6:return Za(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+No(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Va(e.fields,(e,n)=>{t+=e.length+No(n)}),t}(e.mapValue);default:throw li(13486,{value:e})}}function Eo(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function So(e){return!!e&&"integerValue"in e}function To(e){return!!e&&"arrayValue"in e}function Co(e){return!!e&&"nullValue"in e}function Io(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function jo(e){return!!e&&"mapValue"in e}function Ao(e){const t=(e?.mapValue?.fields||{})[uo]?.stringValue;return t===po}function Ro(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Va(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Ro(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ro(e.arrayValue.values[n]);return t}return{...e}}function Do(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ho}class Po{constructor(e){this.value=e}static empty(){return new Po({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!jo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ro(t)}setAll(e){let t=Li.emptyPath(),n={},r=[];e.forEach((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=Ro(e):r.push(s.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());jo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return yo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];jo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Va(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Po(Ro(this.value))}}function Lo(e){const t=[];return Va(e.fields,(e,n)=>{const r=new Li([e]);if(jo(n)){const e=Lo(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Ga(t)}class Oo{constructor(e,t,n,r,s,i,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=a}static newInvalidDocument(e){return new Oo(e,0,Ki.min(),Ki.min(),Ki.min(),Po.empty(),0)}static newFoundDocument(e,t,n,r){return new Oo(e,1,t,Ki.min(),n,r,0)}static newNoDocument(e,t){return new Oo(e,2,t,Ki.min(),Ki.min(),Po.empty(),0)}static newUnknownDocument(e,t){return new Oo(e,3,t,Ki.min(),Ki.min(),Po.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ki.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Po.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Po.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ki.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Oo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Oo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Mo{constructor(e,t){this.position=e,this.inclusive=t}}function Fo(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],a=e.position[s];if(r=i.field.isKeyField()?Oi.comparator(Oi.fromName(a.referenceValue),n.key):bo(a,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Uo(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!yo(e.position[n],t.position[n]))return!1;return!0}class Vo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function zo(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Bo{}class $o extends Bo{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Jo(e,t,n):"array-contains"===t?new tl(e,n):"in"===t?new nl(e,n):"not-in"===t?new rl(e,n):"array-contains-any"===t?new sl(e,n):new $o(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Xo(e,n):new Zo(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(bo(t,this.value)):null!==t&&mo(this.value)===mo(t)&&this.matchesComparison(bo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return li(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qo extends Bo{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new qo(e,t)}matches(e){return Ho(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ho(e){return"and"===e.op}function Wo(e){return Go(e)&&Ho(e)}function Go(e){for(const t of e.filters)if(t instanceof qo)return!1;return!0}function Ko(e){if(e instanceof $o)return e.field.canonicalString()+e.op.toString()+ko(e.value);if(Wo(e))return e.filters.map(e=>Ko(e)).join(",");{const t=e.filters.map(e=>Ko(e)).join(",");return`${e.op}(${t})`}}function Qo(e,t){return e instanceof $o?function(e,t){return t instanceof $o&&e.op===t.op&&e.field.isEqual(t.field)&&yo(e.value,t.value)}(e,t):e instanceof qo?function(e,t){return t instanceof qo&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Qo(n,t.filters[r]),!0)}(e,t):void li(19439)}function Yo(e){return e instanceof $o?function(e){return`${e.field.canonicalString()} ${e.op} ${ko(e.value)}`}(e):e instanceof qo?function(e){return e.op.toString()+" {"+e.getFilters().map(Yo).join(" ,")+"}"}(e):"Filter"}class Jo extends $o{constructor(e,t,n){super(e,t,n),this.key=Oi.fromName(n.referenceValue)}matches(e){const t=Oi.comparator(e.key,this.key);return this.matchesComparison(t)}}class Xo extends $o{constructor(e,t){super(e,"in",t),this.keys=el("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Zo extends $o{constructor(e,t){super(e,"not-in",t),this.keys=el("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function el(e,t){return(t.arrayValue?.values||[]).map(e=>Oi.fromName(e.referenceValue))}class tl extends $o{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return To(t)&&vo(t.arrayValue,this.value)}}class nl extends $o{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&vo(this.value.arrayValue,t)}}class rl extends $o{constructor(e,t){super(e,"not-in",t)}matches(e){if(vo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!vo(this.value.arrayValue,t)}}class sl extends $o{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!To(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>vo(this.value.arrayValue,e))}}class il{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=a,this.Te=null}}function al(e){return new il(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function ol(e){const t=di(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Ko(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),ca(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>ko(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>ko(e)).join(",")),t.Te=e}return t.Te}function ll(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!zo(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Qo(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Uo(e.startAt,t.startAt)&&Uo(e.endAt,t.endAt)}function cl(e){return Oi.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class ul{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function dl(e,t,n,r,s,i,a,o){return new ul(e,t,n,r,s,i,a,o)}function hl(e){return new ul(e)}function fl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function pl(e){return null!==e.collectionGroup}function gl(e){const t=di(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),e.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Ha(Li.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Vo(r,n))}),e.has(Li.keyField().canonicalString())||t.Ie.push(new Vo(Li.keyField(),n))}return t.Ie}function ml(e){const t=di(e);return t.Ee||(t.Ee=yl(t,gl(e))),t.Ee}function yl(e,t){if("F"===e.limitType)return al(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Vo(e.field,t)});const n=e.endAt?new Mo(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Mo(e.startAt.position,e.startAt.inclusive):null;return al(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function vl(e,t){const n=e.filters.concat([t]);return new ul(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function bl(e,t,n){return new ul(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function xl(e,t){return ll(ml(e),ml(t))&&e.limitType===t.limitType}function wl(e){return`${ol(ml(e))}|lt:${e.limitType}`}function kl(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Yo(e)).join(", ")}]`),ca(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>ko(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>ko(e)).join(",")),`Target(${t})`}(ml(e))}; limitType=${e.limitType})`}function _l(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Oi.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of gl(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Fo(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,gl(e),t))&&!(e.endAt&&!function(e,t,n){const r=Fo(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,gl(e),t))}(e,t)}function Nl(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function El(e){return(t,n)=>{let r=!1;for(const s of gl(e)){const e=Sl(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function Sl(e,t,n){const r=e.field.isKeyField()?Oi.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?bo(r,s):li(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return li(19790,{direction:e.dir})}}class Tl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Va(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return za(this.inner)}size(){return this.innerSize}}const Cl=new Ba(Oi.comparator);function Il(){return Cl}const jl=new Ba(Oi.comparator);function Al(){let e=jl;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.insert(s.key,s);return e}function Rl(e){let t=jl;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Dl(){return Ll()}function Pl(){return Ll()}function Ll(){return new Tl(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ol=new Ba(Oi.comparator),Ml=new Ha(Oi.comparator);function Fl(){let e=Ml;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.add(s);return e}const Ul=new Ha(Ei);function Vl(){return Ul}function zl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ua(t)?"-0":t}}function Bl(e){return{integerValue:""+e}}function $l(e,t){return da(t)?Bl(t):zl(e,t)}class ql{constructor(){this._=void 0}}function Hl(e,t,n){return e instanceof Kl?function(e,t){const n={fields:{[to]:{stringValue:eo},[ro]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&so(t)&&(t=io(t)),t&&(n.fields[no]=t),{mapValue:n}}(n,t):e instanceof Ql?Yl(e,t):e instanceof Jl?Xl(e,t):function(e,t){const n=Gl(e,t),r=ec(n)+ec(e.Ae);return So(n)&&So(e.Ae)?Bl(r):zl(e.serializer,r)}(e,t)}function Wl(e,t,n){return e instanceof Ql?Yl(e,t):e instanceof Jl?Xl(e,t):n}function Gl(e,t){return e instanceof Zl?function(e){return So(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Kl extends ql{}class Ql extends ql{constructor(e){super(),this.elements=e}}function Yl(e,t){const n=tc(t);for(const r of e.elements)n.some(e=>yo(e,r))||n.push(r);return{arrayValue:{values:n}}}class Jl extends ql{constructor(e){super(),this.elements=e}}function Xl(e,t){let n=tc(t);for(const r of e.elements)n=n.filter(e=>!yo(e,r));return{arrayValue:{values:n}}}class Zl extends ql{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ec(e){return Xa(e.integerValue||e.doubleValue)}function tc(e){return To(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class nc{constructor(e,t){this.field=e,this.transform=t}}class rc{constructor(e,t){this.version=e,this.transformResults=t}}class sc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sc}static exists(e){return new sc(void 0,e)}static updateTime(e){return new sc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ic(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class ac{}function oc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new yc(e.key,sc.none()):new hc(e.key,e.data,sc.none());{const n=e.data,r=Po.empty();let s=new Ha(Li.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new fc(e.key,r,new Ga(s.toArray()),sc.none())}}function lc(e,t,n){e instanceof hc?function(e,t,n){const r=e.value.clone(),s=gc(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof fc?function(e,t,n){if(!ic(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=gc(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(pc(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function cc(e,t,n,r){return e instanceof hc?function(e,t,n,r){if(!ic(e.precondition,t))return n;const s=e.value.clone(),i=mc(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof fc?function(e,t,n,r){if(!ic(e.precondition,t))return n;const s=mc(e.fieldTransforms,r,t),i=t.data;return i.setAll(pc(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return ic(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function uc(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=Gl(r.transform,e||null);null!=s&&(null===n&&(n=Po.empty()),n.set(r.field,s))}return n||null}function dc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ji(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ql&&t instanceof Ql||e instanceof Jl&&t instanceof Jl?ji(e.elements,t.elements,yo):e instanceof Zl&&t instanceof Zl?yo(e.Ae,t.Ae):e instanceof Kl&&t instanceof Kl}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class hc extends ac{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class fc extends ac{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function pc(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function gc(e,t,n){const r=new Map;ui(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let s=0;s<n.length;s++){const i=e[s],a=i.transform,o=t.data.field(i.field);r.set(i.field,Wl(a,o,n[s]))}return r}function mc(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,Hl(e,i,t))}return r}class yc extends ac{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vc extends ac{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class bc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&lc(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=cc(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=cc(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Pl();return this.mutations.forEach(r=>{const s=e.get(r.key),i=s.overlayedDocument;let a=this.applyToLocalView(i,s.mutatedFields);a=t.has(r.key)?null:a;const o=oc(i,a);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(Ki.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Fl())}isEqual(e){return this.batchId===e.batchId&&ji(this.mutations,e.mutations,(e,t)=>dc(e,t))&&ji(this.baseMutations,e.baseMutations,(e,t)=>dc(e,t))}}class xc{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){ui(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=Ol;const s=e.mutations;for(let i=0;i<s.length;i++)r=r.insert(s[i].key,n[i].version);return new xc(e,t,n,r)}}class wc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class kc{constructor(e,t){this.count=e,this.unchangedNames=t}}var _c,Nc;function Ec(e){switch(e){case hi.OK:return li(64938);case hi.CANCELLED:case hi.UNKNOWN:case hi.DEADLINE_EXCEEDED:case hi.RESOURCE_EXHAUSTED:case hi.INTERNAL:case hi.UNAVAILABLE:case hi.UNAUTHENTICATED:return!1;case hi.INVALID_ARGUMENT:case hi.NOT_FOUND:case hi.ALREADY_EXISTS:case hi.PERMISSION_DENIED:case hi.FAILED_PRECONDITION:case hi.ABORTED:case hi.OUT_OF_RANGE:case hi.UNIMPLEMENTED:case hi.DATA_LOSS:return!0;default:return li(15467,{code:e})}}function Sc(e){if(void 0===e)return ii("GRPC error has no .code"),hi.UNKNOWN;switch(e){case _c.OK:return hi.OK;case _c.CANCELLED:return hi.CANCELLED;case _c.UNKNOWN:return hi.UNKNOWN;case _c.DEADLINE_EXCEEDED:return hi.DEADLINE_EXCEEDED;case _c.RESOURCE_EXHAUSTED:return hi.RESOURCE_EXHAUSTED;case _c.INTERNAL:return hi.INTERNAL;case _c.UNAVAILABLE:return hi.UNAVAILABLE;case _c.UNAUTHENTICATED:return hi.UNAUTHENTICATED;case _c.INVALID_ARGUMENT:return hi.INVALID_ARGUMENT;case _c.NOT_FOUND:return hi.NOT_FOUND;case _c.ALREADY_EXISTS:return hi.ALREADY_EXISTS;case _c.PERMISSION_DENIED:return hi.PERMISSION_DENIED;case _c.FAILED_PRECONDITION:return hi.FAILED_PRECONDITION;case _c.ABORTED:return hi.ABORTED;case _c.OUT_OF_RANGE:return hi.OUT_OF_RANGE;case _c.UNIMPLEMENTED:return hi.UNIMPLEMENTED;case _c.DATA_LOSS:return hi.DATA_LOSS;default:return li(39323,{code:e})}}(Nc=_c||(_c={}))[Nc.OK=0]="OK",Nc[Nc.CANCELLED=1]="CANCELLED",Nc[Nc.UNKNOWN=2]="UNKNOWN",Nc[Nc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nc[Nc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nc[Nc.NOT_FOUND=5]="NOT_FOUND",Nc[Nc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nc[Nc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nc[Nc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nc[Nc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nc[Nc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nc[Nc.ABORTED=10]="ABORTED",Nc[Nc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nc[Nc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nc[Nc.INTERNAL=13]="INTERNAL",Nc[Nc.UNAVAILABLE=14]="UNAVAILABLE",Nc[Nc.DATA_LOSS=15]="DATA_LOSS";let Tc=null;function Cc(){return new TextEncoder}const Ic=new Fs([4294967295,4294967295],0);function jc(e){const t=Cc().encode(e),n=new Us;return n.update(t),new Uint8Array(n.digest())}function Ac(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Fs([n,r],0),new Fs([s,i],0)]}class Rc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Dc(`Invalid padding: ${t}`);if(n<0)throw new Dc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Dc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Dc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Fs.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Fs.fromNumber(n)));return 1===r.compare(Ic)&&(r=new Fs([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=jc(e),[n,r]=Ac(t);for(let s=0;s<this.hashCount;s++){const e=this.ye(n,r,s);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new Rc(s,r,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.ge)return;const t=jc(e),[n,r]=Ac(t);for(let s=0;s<this.hashCount;s++){const e=this.ye(n,r,s);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Dc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Pc{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Lc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Pc(Ki.min(),r,new Ba(Ei),Il(),Fl())}}class Lc{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Lc(n,t,Fl(),Fl(),Fl())}}class Oc{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Mc{constructor(e,t){this.targetId=e,this.Ce=t}}class Fc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qa.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Uc{constructor(){this.ve=0,this.Fe=Bc(),this.Me=Qa.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Fl(),t=Fl(),n=Fl();return this.Fe.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:li(38017,{changeType:s})}}),new Lc(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Bc()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ui(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Vc{constructor(e){this.Ge=e,this.ze=new Map,this.je=Il(),this.Je=zc(),this.He=zc(),this.Ye=new Ba(Ei)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:li(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(cl(s))if(0===n){const e=new Oi(s.path);this.et(t,e,Oo.newNoDocument(e,Ki.min()))}else ui(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){const n=this.ut(e),s=n?this.ct(n,e,r):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}Tc?.lt(function(e,t,n,r,s){const i={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},a=t.unchangedNames;return a&&(i.bloomFilter={applied:0===s,hashCount:a?.hashCount??0,bitmapLength:a?.bits?.bitmap?.length??0,padding:a?.bits?.padding??0,mightContain:e=>r?.mightContain(e)??!1}),i}(r,e.Ce,this.Ge.ht(),n,s))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let i,a;try{i=Za(n).toUint8Array()}catch(e){if(e instanceof Ka)return ai("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new Rc(i,r,s)}catch(e){return ai(e instanceof Dc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.ge?null:a}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const s=this.Ge.ht(),i=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const s=this.ot(r);if(s){if(n.current&&cl(s.target)){const t=new Oi(s.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Oo.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Fl();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Pc(e,t,this.Ye,this.je,n);return this.je=Il(),this.Je=zc(),this.He=zc(),this.Ye=new Ba(Ei),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Uc,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ha(Ei),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ha(Ei),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||si("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Uc),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zc(){return new Ba(Oi.comparator)}function Bc(){return new Ba(Oi.comparator)}const $c={asc:"ASCENDING",desc:"DESCENDING"},qc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Hc={and:"AND",or:"OR"};class Wc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gc(e,t){return e.useProto3Json||ca(t)?t:{value:t}}function Kc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Qc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Yc(e,t){return Kc(e,t.toTimestamp())}function Jc(e){return ui(!!e,49232),Ki.fromTimestamp(function(e){const t=Ja(e);return new Gi(t.seconds,t.nanos)}(e))}function Xc(e,t){return Zc(e,t).canonicalString()}function Zc(e,t){const n=function(e){return new Di(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function eu(e){const t=Di.fromString(e);return ui(xu(t),10190,{key:t.toString()}),t}function tu(e,t){return Xc(e.databaseId,t.path)}function nu(e,t){const n=eu(t);if(n.get(1)!==e.databaseId.projectId)throw new fi(hi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new fi(hi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Oi(au(n))}function ru(e,t){return Xc(e.databaseId,t)}function su(e){const t=eu(e);return 4===t.length?Di.emptyPath():au(t)}function iu(e){return new Di(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function au(e){return ui(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function ou(e,t,n){return{name:tu(e,t),fields:n.value.mapValue.fields}}function lu(e,t){let n;if(t instanceof hc)n={update:ou(e,t.key,t.value)};else if(t instanceof yc)n={delete:tu(e,t.key)};else if(t instanceof fc)n={update:ou(e,t.key,t.data),updateMask:bu(t.fieldMask)};else{if(!(t instanceof vc))return li(16599,{Vt:t.type});n={verify:tu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Kl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ql)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Jl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Zl)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw li(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Yc(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:li(27497)}(e,t.precondition)),n}function cu(e,t){return{documents:[ru(e,t.path)]}}function uu(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ru(e,s);const i=function(e){if(0!==e.length)return vu(qo.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:mu(e.field),direction:fu(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=Gc(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:s}}function du(e){let t=su(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ui(1===r,65062);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=hu(e);return t instanceof qo&&Wo(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new Vo(yu(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,ca(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Mo(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Mo(n,t)}(n.endAt)),dl(t,s,a,i,o,"F",l,c)}function hu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=yu(e.unaryFilter.field);return $o.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=yu(e.unaryFilter.field);return $o.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=yu(e.unaryFilter.field);return $o.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=yu(e.unaryFilter.field);return $o.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return li(61313);default:return li(60726)}}(e):void 0!==e.fieldFilter?function(e){return $o.create(yu(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return li(58110);default:return li(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return qo.create(e.compositeFilter.filters.map(e=>hu(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return li(1026)}}(e.compositeFilter.op))}(e):li(30097,{filter:e})}function fu(e){return $c[e]}function pu(e){return qc[e]}function gu(e){return Hc[e]}function mu(e){return{fieldPath:e.canonicalString()}}function yu(e){return Li.fromServerFormat(e.fieldPath)}function vu(e){return e instanceof $o?function(e){if("=="===e.op){if(Io(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NAN"}};if(Co(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Io(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NOT_NAN"}};if(Co(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mu(e.field),op:pu(e.op),value:e.value}}}(e):e instanceof qo?function(e){const t=e.getFilters().map(e=>vu(e));return 1===t.length?t[0]:{compositeFilter:{op:gu(e.op),filters:t}}}(e):li(54877,{filter:e})}function bu(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function xu(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class wu{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ki.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ki.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Qa.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new wu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ku{constructor(e){this.yt=e}}function _u(e){const t=du({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?bl(t,t.limit,"L"):t}class Nu{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Xa(e.integerValue));else if("doubleValue"in e){const n=Xa(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),ua(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Ja(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Za(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Do(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ao(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):li(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const r=go,s=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Xa(s)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Oi.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Nu.Kt=new Nu;class Eu{constructor(){this.Cn=new Su}addToCollectionParentIndex(e,t){return this.Cn.add(t),sa.resolve()}getCollectionParents(e,t){return sa.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return sa.resolve()}deleteFieldIndex(e,t){return sa.resolve()}deleteAllFieldIndexes(e){return sa.resolve()}createTargetIndexes(e,t){return sa.resolve()}getDocumentsMatchingTarget(e,t){return sa.resolve(null)}getIndexType(e,t){return sa.resolve(0)}getFieldIndexes(e,t){return sa.resolve([])}getNextCollectionGroupToUpdate(e){return sa.resolve(null)}getMinOffset(e,t){return sa.resolve(Zi.min())}getMinOffsetFromCollectionGroup(e,t){return sa.resolve(Zi.min())}updateCollectionGroup(e,t,n){return sa.resolve()}updateIndexEntries(e,t){return sa.resolve()}}class Su{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ha(Di.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ha(Di.comparator)).toArray()}}new Uint8Array(0);const Tu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Cu=41943040;class Iu{static withCacheSize(e){return new Iu(e,Iu.DEFAULT_COLLECTION_PERCENTILE,Iu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Iu.DEFAULT_COLLECTION_PERCENTILE=10,Iu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Iu.DEFAULT=new Iu(Cu,Iu.DEFAULT_COLLECTION_PERCENTILE,Iu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Iu.DISABLED=new Iu(-1,0,0);class ju{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ju(0)}static cr(){return new ju(-1)}}const Au="LruGarbageCollector",Ru=1048576;function Du(e,t){let[n,r]=e,[s,i]=t;const a=Ei(n,s);return 0===a?Ei(r,i):a}class Pu{constructor(e){this.Ir=e,this.buffer=new Ha(Du),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Du(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Lu{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){si(Au,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){aa(e)?si(Au,"Ignoring IndexedDB error during garbage collection: ",e):await ra(e)}await this.Vr(3e5)})}}class Ou{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return sa.resolve(oa.ce);const n=new Pu(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(si("LruGarbageCollector","Garbage collection skipped; disabled"),sa.resolve(Tu)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(si("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tu):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,s,i,a,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(si("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(s=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),ri()<=$.DEBUG&&si("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-c}ms\n\tDetermined least recently used ${r} in `+(a-i)+"ms\n"+`\tRemoved ${s} targets in `+(o-a)+"ms\n"+`\tRemoved ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-c}ms`),sa.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:e})))}}function Mu(e,t){return new Ou(e,t)}class Fu{constructor(){this.changes=new Tl(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Oo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?sa.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Uu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Vu{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&cc(n.mutation,e,Ga.empty(),Gi.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Fl()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fl();const r=Dl();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Al();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Dl();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Fl()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let s=Il();const i=Ll(),a=Ll();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof fc)?s=s.insert(t.key,t):void 0!==a?(i.set(t.key,a.mutation.getFieldMask()),cc(a.mutation,t,a.mutation.getFieldMask(),Gi.now())):i.set(t.key,Ga.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>a.set(e,new Uu(t,i.get(e)??null))),a))}recalculateAndSaveOverlays(e,t){const n=Ll();let r=new Ba((e,t)=>e-t),s=Fl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const s of e)s.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let a=n.get(e)||Ga.empty();a=s.applyToLocalView(i,a),n.set(e,a);const o=(r.get(s.batchId)||Fl()).add(e);r=r.insert(s.batchId,o)})}).next(()=>{const i=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=Pl();l.forEach(e=>{if(!s.has(e)){const r=oc(t.get(e),n.get(e));null!==r&&c.set(e,r),s=s.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return sa.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Oi.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):pl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):sa.resolve(Dl());let a=Qi,o=s;return i.next(t=>sa.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),s.get(t)?sa.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,s)).next(()=>this.computeViews(e,o,t,Fl())).next(e=>({batchId:a,changes:Rl(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Oi(t)).next(e=>{let t=Al();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=Al();return this.indexManager.getCollectionParents(e,s).next(a=>sa.forEach(a,a=>{const o=function(e,t){return new ul(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(e=>{s.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Oo.newInvalidDocument(r)))});let n=Al();return e.forEach((e,r)=>{const i=s.get(e);void 0!==i&&cc(i.mutation,r,Ga.empty(),Gi.now()),_l(t,r)&&(n=n.insert(e,r))}),n})}}class zu{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return sa.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Jc(e.createTime)}}(t)),sa.resolve()}getNamedQuery(e,t){return sa.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:_u(e.bundledQuery),readTime:Jc(e.readTime)}}(t)),sa.resolve()}}class Bu{constructor(){this.overlays=new Ba(Oi.comparator),this.qr=new Map}getOverlay(e,t){return sa.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Dl();return sa.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),sa.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),sa.resolve()}getOverlaysForCollection(e,t,n){const r=Dl(),s=t.length+1,i=new Oi(t.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const e=a.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return sa.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Ba((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=Dl(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=Dl(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return sa.resolve(a)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new wc(t,n));let s=this.qr.get(t);void 0===s&&(s=Fl(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class $u{constructor(){this.sessionToken=Qa.EMPTY_BYTE_STRING}getSessionToken(e){return sa.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,sa.resolve()}}class qu{constructor(){this.Qr=new Ha(Hu.$r),this.Ur=new Ha(Hu.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Hu(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Hu(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Oi(new Di([])),n=new Hu(t,e),r=new Hu(t,e+1),s=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),s.push(e.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Oi(new Di([])),n=new Hu(t,e),r=new Hu(t,e+1);let s=Fl();return this.Ur.forEachInRange([n,r],e=>{s=s.add(e.key)}),s}containsKey(e){const t=new Hu(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Hu{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Oi.comparator(e.key,t.key)||Ei(e.Yr,t.Yr)}static Kr(e,t){return Ei(e.Yr,t.Yr)||Oi.comparator(e.key,t.key)}}class Wu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ha(Hu.$r)}checkEmpty(e){return sa.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new bc(s,t,n,r);this.mutationQueue.push(i);for(const a of r)this.Zr=this.Zr.add(new Hu(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return sa.resolve(i)}lookupMutationBatch(e,t){return sa.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),s=r<0?0:r;return sa.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return sa.resolve(0===this.mutationQueue.length?la:this.tr-1)}getAllMutationBatches(e){return sa.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Hu(t,0),r=new Hu(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);s.push(t)}),sa.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ha(Ei);return t.forEach(e=>{const t=new Hu(e,0),r=new Hu(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),sa.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;Oi.isDocumentKey(s)||(s=s.child(""));const i=new Hu(new Oi(s),0);let a=new Ha(Ei);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.Yr)),!0)},i),sa.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){ui(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return sa.forEach(t.mutations,r=>{const s=new Hu(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Hu(t,0),r=this.Zr.firstAfterOrEqual(n);return sa.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,sa.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Gu{constructor(e){this.ri=e,this.docs=new Ba(Oi.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return sa.resolve(n?n.document.mutableCopy():Oo.newInvalidDocument(t))}getEntries(e,t){let n=Il();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Oo.newInvalidDocument(e))}),sa.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Il();const i=t.path,a=new Oi(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||ea(Xi(a),n)<=0||(r.has(a.key)||_l(t,a))&&(s=s.insert(a.key,a.mutableCopy()))}return sa.resolve(s)}getAllFromCollectionGroup(e,t,n,r){li(9500)}ii(e,t){return sa.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Ku(this)}getSize(e){return sa.resolve(this.size)}}class Ku extends Fu{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),sa.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Qu{constructor(e){this.persistence=e,this.si=new Tl(e=>ol(e),ll),this.lastRemoteSnapshotVersion=Ki.min(),this.highestTargetId=0,this.oi=0,this._i=new qu,this.targetCount=0,this.ai=ju.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),sa.resolve()}getLastRemoteSnapshotVersion(e){return sa.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return sa.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),sa.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),sa.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ju(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,sa.resolve()}updateTargetData(e,t){return this.Pr(t),sa.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,sa.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.si.forEach((i,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.si.delete(i),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),sa.waitFor(s).next(()=>r)}getTargetCount(e){return sa.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return sa.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),sa.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(t=>{s.push(r.markPotentiallyOrphaned(e,t))}),sa.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),sa.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return sa.resolve(n)}containsKey(e,t){return sa.resolve(this._i.containsKey(t))}}class Yu{constructor(e,t){this.ui={},this.overlays={},this.ci=new oa(0),this.li=!1,this.li=!0,this.hi=new $u,this.referenceDelegate=e(this),this.Pi=new Qu(this),this.indexManager=new Eu,this.remoteDocumentCache=function(e){return new Gu(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new ku(t),this.Ii=new zu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Bu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Wu(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){si("MemoryPersistence","Starting transaction:",e);const r=new Ju(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return sa.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Ju extends na{constructor(e){super(),this.currentSequenceNumber=e}}class Xu{constructor(e){this.persistence=e,this.Ri=new qu,this.Vi=null}static mi(e){return new Xu(e)}get fi(){if(this.Vi)return this.Vi;throw li(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),sa.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),sa.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),sa.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return sa.forEach(this.fi,n=>{const r=Oi.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Ki.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return sa.or([()=>sa.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Zu{constructor(e,t){this.persistence=e,this.pi=new Tl(e=>fa(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Mu(this,t)}static mi(e,t){return new Zu(e,t)}Ei(){}di(e){return sa.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return sa.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?sa.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,s.removeEntry(r,Ki.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),sa.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),sa.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),sa.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),sa.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=No(e.data.value)),t}br(e,t,n){return sa.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return sa.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ed{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Fl(),r=Fl();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new ed(e,t.fromCache,n,r)}}class td{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class nd{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=E()?8:ia(_())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ys(e,t).next(e=>{s.result=e}).next(()=>{if(!s.result)return this.ws(e,t,r,n).next(e=>{s.result=e})}).next(()=>{if(s.result)return;const n=new td;return this.Ss(e,t,n).next(r=>{if(s.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>s.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(ri()<=$.DEBUG&&si("QueryEngine","SDK will not create cache indexes for query:",kl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),sa.resolve()):(ri()<=$.DEBUG&&si("QueryEngine","Query:",kl(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(ri()<=$.DEBUG&&si("QueryEngine","The SDK decides to create cache indexes for query:",kl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ml(t))):sa.resolve())}ys(e,t){if(fl(t))return sa.resolve(null);let n=ml(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=bl(t,null,"F"),n=ml(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const s=Fl(...r);return this.ps.getDocuments(e,s).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.Ds(t,r);return this.Cs(t,i,s,n.readTime)?this.ys(e,bl(t,null,"F")):this.vs(e,i,t,n)}))})))}ws(e,t,n,r){return fl(t)||r.isEqual(Ki.min())?sa.resolve(null):this.ps.getDocuments(e,n).next(s=>{const i=this.Ds(t,s);return this.Cs(t,i,n,r)?sa.resolve(null):(ri()<=$.DEBUG&&si("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),kl(t)),this.vs(e,i,t,Ji(r,Qi)).next(e=>e))})}Ds(e,t){let n=new Ha(El(e));return t.forEach((t,r)=>{_l(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,n){return ri()<=$.DEBUG&&si("QueryEngine","Using full collection scan to execute query:",kl(t)),this.ps.getDocumentsMatchingQuery(e,t,Zi.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const rd="LocalStore";class sd{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Ba(Ei),this.xs=new Tl(e=>ol(e),ll),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vu(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function id(e,t,n,r){return new sd(e,t,n,r)}async function ad(e,t){const n=di(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(s=>(r=s,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const s=[],i=[];let a=Fl();for(const e of r){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({Ls:e,removedBatchIds:s,addedBatchIds:i}))})})}function od(e){const t=di(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function ld(e,t,n){let r=Fl(),s=Fl();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Il();return n.forEach((n,i)=>{const a=e.get(n);i.isFoundDocument()!==a.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(Ki.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):si(rd,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",i.version)}),{ks:r,qs:s}})}function cd(e,t){const n=di(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=la),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function ud(e,t){const n=di(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(s=>s?(r=s,sa.resolve(r)):n.Pi.allocateTargetId(e).next(s=>(r=new wu(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function dd(e,t,n){const r=di(e),s=r.Ms.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,s))}catch(e){if(!aa(e))throw e;si(rd,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(s.target)}function hd(e,t,n){const r=di(e);let s=Ki.min(),i=Fl();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=di(e),s=r.xs.get(n);return void 0!==s?sa.resolve(r.Ms.get(s)):r.Pi.getTargetData(t,n)}(r,e,ml(t)).next(t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?s:Ki.min(),n?i:Fl())).next(e=>(fd(r,Nl(t),e),{documents:e,Qs:i})))}function fd(e,t,n){let r=e.Os.get(t)||Ki.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class pd{constructor(){this.activeTargetIds=Vl()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gd{constructor(){this.Mo=new pd,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new pd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class md{Oo(e){}shutdown(){}}const yd="ConnectivityMonitor";class vd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){si(yd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){si(yd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let bd=null;function xd(){return null===bd?bd=268435456+Math.round(2147483648*Math.random()):bd++,"0x"+bd.toString(16)}const wd="RestConnection",kd={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class _d{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===lo?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,s){const i=xd(),a=this.zo(e,t.toUriEncodedString());si(wd,`Sending RPC '${e}' ${i}:`,a,n);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,r,s);const{host:l}=new URL(a),c=y(l);return this.Jo(e,a,o,n,c).then(t=>(si(wd,`Received RPC '${e}' ${i}: `,t),t),t=>{throw ai(wd,`RPC '${e}' ${i} failed with error: `,t,"url: ",a,"request:",n),t})}Ho(e,t,n,r,s,i){return this.Go(e,t,n,r,s)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ti,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=kd[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class Nd{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ed="WebChannelConnection";class Sd extends _d{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,s){const i=xd();return new Promise((s,a)=>{const o=new Bs;o.setWithCredentials(!0),o.listenOnce(qs.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case Hs.NO_ERROR:const t=o.getResponseJson();si(Ed,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Hs.TIMEOUT:si(Ed,`RPC '${e}' ${i} timed out`),a(new fi(hi.DEADLINE_EXCEEDED,"Request time out"));break;case Hs.HTTP_ERROR:const n=o.getStatus();if(si(Ed,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=e?.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(hi).indexOf(t)>=0?t:hi.UNKNOWN}(t.status);a(new fi(e,t.message))}else a(new fi(hi.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new fi(hi.UNAVAILABLE,"Connection failed."));break;default:li(9055,{l_:e,streamId:i,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{si(Ed,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(r);si(Ed,`RPC '${e}' ${i} sending request:`,r),o.send(t,"POST",l,n,15)})}T_(e,t,n){const r=xd(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Qs(),a=Ks(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=s.join("");si(Ed,`Creating RPC '${e}' stream ${r}: ${c}`,o);const u=i.createWebChannel(c,o);this.I_(u);let d=!1,h=!1;const f=new Nd({Yo:t=>{h?si(Ed,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(si(Ed,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),si(Ed,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,$s.EventType.OPEN,()=>{h||(si(Ed,`RPC '${e}' stream ${r} transport opened.`),f.o_())}),p(u,$s.EventType.CLOSE,()=>{h||(h=!0,si(Ed,`RPC '${e}' stream ${r} transport closed`),f.a_(),this.E_(u))}),p(u,$s.EventType.ERROR,t=>{h||(h=!0,ai(Ed,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),f.a_(new fi(hi.UNAVAILABLE,"The operation could not be completed")))}),p(u,$s.EventType.MESSAGE,t=>{if(!h){const n=t.data[0];ui(!!n,16349);const s=n,i=s?.error||s[0]?.error;if(i){si(Ed,`RPC '${e}' stream ${r} received error:`,i);const t=i.status;let n=function(e){const t=_c[e];if(void 0!==t)return Sc(t)}(t),s=i.message;void 0===n&&(n=hi.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),h=!0,f.a_(new fi(n,s)),u.close()}else si(Ed,`RPC '${e}' stream ${r} received:`,n),f.u_(n)}}),p(a,Gs.STAT_EVENT,t=>{t.stat===Ws.PROXY?si(Ed,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Ws.NOPROXY&&si(Ed,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Td(){return"undefined"!=typeof document?document:null}function Cd(e){return new Wc(e,!0)}class Id{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&si("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const jd="PersistentStream";class Ad{constructor(e,t,n,r,s,i,a,o){this.Mi=e,this.S_=n,this.b_=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Id(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===hi.RESOURCE_EXHAUSTED?(ii(t.toString()),ii("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===hi.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new fi(hi.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return si(jd,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(si(jd,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Rd extends Ad{constructor(e,t,n,r,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:li(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(ui(void 0===t||"string"==typeof t,58123),Qa.fromBase64String(t||"")):(ui(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Qa.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?hi.UNKNOWN:Sc(e.code);return new fi(t,e.message||"")}(a);n=new Fc(r,s,i,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=nu(e,r.document.name),i=Jc(r.document.updateTime),a=r.document.createTime?Jc(r.document.createTime):Ki.min(),o=new Po({mapValue:{fields:r.document.fields}}),l=Oo.newFoundDocument(s,i,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Oc(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=nu(e,r.document),i=r.readTime?Jc(r.readTime):Ki.min(),a=Oo.newNoDocument(s,i),o=r.removedTargetIds||[];n=new Oc([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=nu(e,r.document),i=r.removedTargetIds||[];n=new Oc([],i,s,null)}else{if(!("filter"in t))return li(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,i=new kc(r,s),a=e.targetId;n=new Mc(a,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ki.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ki.min():t.readTime?Jc(t.readTime):Ki.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=iu(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=cl(r)?{documents:cu(e,r)}:{query:uu(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Qc(e,t.resumeToken);const r=Gc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ki.min())>0){n.readTime=Kc(e,t.snapshotVersion.toTimestamp());const r=Gc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return li(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=iu(this.serializer),t.removeTarget=e,this.q_(t)}}class Dd extends Ad{constructor(e,t,n,r,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ui(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ui(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){ui(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(ui(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Jc(e.updateTime):Jc(t);return n.isEqual(Ki.min())&&(n=Jc(t)),new rc(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Jc(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=iu(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>lu(this.serializer,e))};this.q_(t)}}class Pd{}class Ld extends Pd{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new fi(hi.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[i,a]=s;return this.connection.Go(e,Zc(t,n),r,i,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===hi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new fi(hi.UNKNOWN,e.toString())})}Ho(e,t,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[a,o]=i;return this.connection.Ho(e,Zc(t,n),r,a,o,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===hi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new fi(hi.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Od{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ii(t),this.aa=!1):si("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Md="RemoteStore";class Fd{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Gd(this)&&(si(Md,"Restarting streams for network reachability change."),await async function(e){const t=di(e);t.Ea.add(4),await Vd(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Ud(t)}(this))})}),this.Ra=new Od(n,r)}}async function Ud(e){if(Gd(e))for(const t of e.da)await t(!0)}async function Vd(e){for(const t of e.da)await t(!1)}function zd(e,t){const n=di(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Wd(n)?Hd(n):hh(n).O_()&&$d(n,t))}function Bd(e,t){const n=di(e),r=hh(n);n.Ia.delete(t),r.O_()&&qd(n,t),0===n.Ia.size&&(r.O_()?r.L_():Gd(n)&&n.Ra.set("Unknown"))}function $d(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ki.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}hh(e).Y_(t)}function qd(e,t){e.Va.Ue(t),hh(e).Z_(t)}function Hd(e){e.Va=new Vc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),hh(e).start(),e.Ra.ua()}function Wd(e){return Gd(e)&&!hh(e).x_()&&e.Ia.size>0}function Gd(e){return 0===di(e).Ea.size}function Kd(e){e.Va=void 0}async function Qd(e){e.Ra.set("Online")}async function Yd(e){e.Ia.forEach((t,n)=>{$d(e,t)})}async function Jd(e,t){Kd(e),Wd(e)?(e.Ra.ha(t),Hd(e)):e.Ra.set("Unknown")}async function Xd(e,t,n){if(e.Ra.set("Online"),t instanceof Fc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){si(Md,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Zd(e,n)}else if(t instanceof Oc?e.Va.Ze(t):t instanceof Mc?e.Va.st(t):e.Va.tt(t),!n.isEqual(Ki.min()))try{const t=await od(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.Ia.get(r);s&&e.Ia.set(r,s.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Qa.EMPTY_BYTE_STRING,r.snapshotVersion)),qd(e,t);const s=new wu(r.target,t,n,r.sequenceNumber);$d(e,s)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){si(Md,"Failed to raise snapshot:",t),await Zd(e,t)}}async function Zd(e,t,n){if(!aa(t))throw t;e.Ea.add(1),await Vd(e),e.Ra.set("Offline"),n||(n=()=>od(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{si(Md,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Ud(e)})}function eh(e,t){return t().catch(n=>Zd(e,n,t))}async function th(e){const t=di(e),n=fh(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:la;for(;nh(t);)try{const e=await cd(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,rh(t,e)}catch(e){await Zd(t,e)}sh(t)&&ih(t)}function nh(e){return Gd(e)&&e.Ta.length<10}function rh(e,t){e.Ta.push(t);const n=fh(e);n.O_()&&n.X_&&n.ea(t.mutations)}function sh(e){return Gd(e)&&!fh(e).x_()&&e.Ta.length>0}function ih(e){fh(e).start()}async function ah(e){fh(e).ra()}async function oh(e){const t=fh(e);for(const n of e.Ta)t.ea(n.mutations)}async function lh(e,t,n){const r=e.Ta.shift(),s=xc.from(r,t,n);await eh(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await th(e)}async function ch(e,t){t&&fh(e).X_&&await async function(e,t){if(function(e){return Ec(e)&&e!==hi.ABORTED}(t.code)){const n=e.Ta.shift();fh(e).B_(),await eh(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await th(e)}}(e,t),sh(e)&&ih(e)}async function uh(e,t){const n=di(e);n.asyncQueue.verifyOperationInProgress(),si(Md,"RemoteStore received new credentials");const r=Gd(n);n.Ea.add(3),await Vd(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Ud(n)}async function dh(e,t){const n=di(e);t?(n.Ea.delete(2),await Ud(n)):t||(n.Ea.add(2),await Vd(n),n.Ra.set("Unknown"))}function hh(e){return e.ma||(e.ma=function(e,t,n){const r=di(e);return r.sa(),new Rd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Qd.bind(null,e),t_:Yd.bind(null,e),r_:Jd.bind(null,e),H_:Xd.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Wd(e)?Hd(e):e.Ra.set("Unknown")):(await e.ma.stop(),Kd(e))})),e.ma}function fh(e){return e.fa||(e.fa=function(e,t,n){const r=di(e);return r.sa(),new Dd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:ah.bind(null,e),r_:ch.bind(null,e),ta:oh.bind(null,e),na:lh.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await th(e)):(await e.fa.stop(),e.Ta.length>0&&(si(Md,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class ph{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,a=new ph(e,t,i,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new fi(hi.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gh(e,t){if(ii("AsyncQueue",`${t}: ${e}`),aa(e))return new fi(hi.UNAVAILABLE,`${t}: ${e}`);throw e}class mh{static emptySet(e){return new mh(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Oi.comparator(t.key,n.key):(e,t)=>Oi.comparator(e.key,t.key),this.keyedMap=Al(),this.sortedSet=new Ba(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof mh))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new mh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class yh{constructor(){this.ga=new Ba(Oi.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):li(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class vh{constructor(e,t,n,r,s,i,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,s){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new vh(e,t,mh.emptySet(t),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class bh{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class xh{constructor(){this.queries=wh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=di(e),r=n.queries;n.queries=wh(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new fi(hi.ABORTED,"Firestore shutting down"))}}function wh(){return new Tl(e=>wl(e),xl)}async function kh(e,t){const n=di(e);let r=3;const s=t.query;let i=n.queries.get(s);i?!i.ba()&&t.Da()&&(r=2):(i=new bh,r=t.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(e){const n=gh(e,`Initialization of query '${kl(t.query)}' failed`);return void t.onError(n)}n.queries.set(s,i),i.Sa.push(t),t.va(n.onlineState),i.wa&&t.Fa(i.wa)&&Sh(n)}async function _h(e,t){const n=di(e),r=t.query;let s=3;const i=n.queries.get(r);if(i){const e=i.Sa.indexOf(t);e>=0&&(i.Sa.splice(e,1),0===i.Sa.length?s=t.Da()?0:1:!i.ba()&&t.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Nh(e,t){const n=di(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(s)&&(r=!0);t.wa=s}}r&&Sh(n)}function Eh(e,t,n){const r=di(e),s=r.queries.get(t);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(t)}function Sh(e){e.Ca.forEach(e=>{e.next()})}var Th,Ch;(Ch=Th||(Th={})).Ma="default",Ch.Cache="cache";class Ih{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new vh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=vh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Th.Cache}}class jh{constructor(e){this.key=e}}class Ah{constructor(e){this.key=e}}class Rh{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Fl(),this.mutatedKeys=Fl(),this.eu=El(e),this.tu=new mh(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new yh,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=_l(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.su(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.eu(u,o)>0||l&&this.eu(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(i=i.add(u),s=h?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{tu:i,iu:n,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return li(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=r??!1;const a=t&&!r?this._u():[],o=0===this.Xa.size&&this.current&&!r?1:0,l=o!==this.Za;return this.Za=o,0!==i.length||l?{snapshot:new vh(this.query,e.tu,s,i,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new yh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Fl(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Ah(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new jh(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Fl();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return vh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Dh="SyncEngine";class Ph{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Lh{constructor(e){this.key=e,this.hu=!1}}class Oh{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new Tl(e=>wl(e),xl),this.Iu=new Map,this.Eu=new Set,this.du=new Ba(Oi.comparator),this.Au=new Map,this.Ru=new qu,this.Vu={},this.mu=new Map,this.fu=ju.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Mh(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=sf(e);let s;const i=r.Tu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Uh(r,t,n,!0),s}async function Fh(e,t){const n=sf(e);await Uh(n,t,!0,!1)}async function Uh(e,t,n,r){const s=await ud(e.localStore,ml(t)),i=s.targetId,a=e.sharedClientState.addLocalQueryTarget(i,n);let o;return r&&(o=await Vh(e,t,i,"current"===a,s.resumeToken)),e.isPrimaryClient&&n&&zd(e.remoteStore,s),o}async function Vh(e,t,n,r,s){e.pu=(t,n,r)=>async function(e,t,n,r){let s=t.view.ru(n);s.Cs&&(s=await hd(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,s)}));const i=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(s,e.isPrimaryClient,i,a);return Xh(e,t.targetId,o.au),o.snapshot}(e,t,n,r);const i=await hd(e.localStore,t,!0),a=new Rh(t,i.Qs),o=a.ru(i.documents),l=Lc.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),c=a.applyChanges(o,e.isPrimaryClient,l);Xh(e,n,c.au);const u=new Ph(t,n,a);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function zh(e,t,n){const r=di(e),s=r.Tu.get(t),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(e=>!xl(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await dd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Bd(r.remoteStore,s.targetId),Yh(r,s.targetId)}).catch(ra)):(Yh(r,s.targetId),await dd(r.localStore,s.targetId,!0))}async function Bh(e,t){const n=di(e),r=n.Tu.get(t),s=n.Iu.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Bd(n.remoteStore,r.targetId))}async function $h(e,t){const n=di(e);try{const e=await function(e,t){const n=di(e),r=t.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];t.targetChanges.forEach((i,o)=>{const l=s.get(o);if(!l)return;a.push(n.Pi.removeMatchingKeys(e,i.removedDocuments,o).next(()=>n.Pi.addMatchingKeys(e,i.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Qa.EMPTY_BYTE_STRING,Ki.min()).withLastLimboFreeSnapshotVersion(Ki.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),s=s.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,i)&&a.push(n.Pi.updateTargetData(e,c))});let o=Il(),l=Fl();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(ld(e,i,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!r.isEqual(Ki.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return sa.waitFor(a).next(()=>i.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ms=s,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(ui(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?ui(r.hu,14607):e.removedDocuments.size>0&&(ui(r.hu,42227),r.hu=!1))}),await tf(n,e,t)}catch(e){await ra(e)}}function qh(e,t,n){const r=di(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const s=r.view.va(t);s.snapshot&&e.push(s.snapshot)}),function(e,t){const n=di(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const s of n.Sa)s.va(t)&&(r=!0)}),r&&Sh(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Hh(e,t,n){const r=di(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Au.get(t),i=s&&s.key;if(i){let e=new Ba(Oi.comparator);e=e.insert(i,Oo.newNoDocument(i,Ki.min()));const n=Fl().add(i),s=new Pc(Ki.min(),new Map,new Ba(Ei),e,n);await $h(r,s),r.du=r.du.remove(i),r.Au.delete(t),ef(r)}else await dd(r.localStore,t,!1).then(()=>Yh(r,t,n)).catch(ra)}async function Wh(e,t){const n=di(e),r=t.batch.batchId;try{const e=await function(e,t){const n=di(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let a=sa.resolve();return i.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);ui(null!==i,48541),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,s))}(n,e,t,s).next(()=>s.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Fl();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Qh(n,r,null),Kh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await tf(n,e)}catch(e){await ra(e)}}async function Gh(e,t,n){const r=di(e);try{const e=await function(e,t){const n=di(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(ui(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Qh(r,t,n),Kh(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await tf(r,e)}catch(n){await ra(n)}}function Kh(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Qh(e,t,n){const r=di(e);let s=r.Vu[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Vu[r.currentUser.toKey()]=s}}function Yh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Jh(e,t)})}function Jh(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Bd(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),ef(e))}function Xh(e,t,n){for(const r of n)r instanceof jh?(e.Ru.addReference(r.key,t),Zh(e,r)):r instanceof Ah?(si(Dh,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Jh(e,r.key)):li(19791,{wu:r})}function Zh(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(si(Dh,"New document in limbo: "+n),e.Eu.add(r),ef(e))}function ef(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Oi(Di.fromString(t)),r=e.fu.next();e.Au.set(r,new Lh(n)),e.du=e.du.insert(n,r),zd(e.remoteStore,new wu(ml(hl(n.path)),r,"TargetPurposeLimboResolution",oa.ce))}}async function tf(e,t,n){const r=di(e),s=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((e,o)=>{a.push(r.pu(o,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){const t=e?!e.fromCache:n?.targetChanges.get(o.targetId)?.current;r.sharedClientState.updateQueryState(o.targetId,t?"current":"not-current")}if(e){s.push(e);const t=ed.As(o.targetId,e);i.push(t)}}))}),await Promise.all(a),r.Pu.H_(s),await async function(e,t){const n=di(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>sa.forEach(t,t=>sa.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>sa.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!aa(e))throw e;si(rd,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,s)}}}(r.localStore,i))}async function nf(e,t){const n=di(e);if(!n.currentUser.isEqual(t)){si(Dh,"User change. New user:",t.toKey());const e=await ad(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new fi(hi.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await tf(n,e.Ls)}}function rf(e,t){const n=di(e),r=n.Au.get(t);if(r&&r.hu)return Fl().add(r.key);{let e=Fl();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function sf(e){const t=di(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=$h.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=rf.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Hh.bind(null,t),t.Pu.H_=Nh.bind(null,t.eventManager),t.Pu.yu=Eh.bind(null,t.eventManager),t}function af(e){const t=di(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Wh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Gh.bind(null,t),t}class of{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return id(this.persistence,new nd,e.initialUser,this.serializer)}Cu(e){return new Yu(Xu.mi,this.serializer)}Du(e){return new gd}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}of.provider={build:()=>new of};class lf extends of{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ui(this.persistence.referenceDelegate instanceof Zu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Lu(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Iu.withCacheSize(this.cacheSizeBytes):Iu.DEFAULT;return new Yu(e=>Zu.mi(e,t),this.serializer)}}class cf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>qh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=nf.bind(null,this.syncEngine),await dh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new xh}createDatastore(e){const t=Cd(e.databaseInfo.databaseId),n=function(e){return new Sd(e)}(e.databaseInfo);return function(e,t,n,r){return new Ld(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new Fd(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,e=>qh(this.syncEngine,e,0),vd.v()?new vd:new md)}createSyncEngine(e,t){return function(e,t,n,r,s,i,a){const o=new Oh(e,t,n,r,s,i);return a&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){const t=di(e);si(Md,"RemoteStore shutting down."),t.Ea.add(5),await Vd(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}cf.provider={build:()=>new cf};class uf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ii("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class df{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new fi(hi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=di(e),r={documents:t.map(e=>tu(n.serializer,e))},s=await n.Ho("BatchGetDocuments",n.serializer.databaseId,Di.emptyPath(),r,t.length),i=new Map;s.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){ui(!!t.found,43571),t.found.name,t.found.updateTime;const n=nu(e,t.found.name),r=Jc(t.found.updateTime),s=t.found.createTime?Jc(t.found.createTime):Ki.min(),i=new Po({mapValue:{fields:t.found.fields}});return Oo.newFoundDocument(n,r,s,i)}(e,t):"missing"in t?function(e,t){ui(!!t.missing,3894),ui(!!t.readTime,22933);const n=nu(e,t.missing),r=Jc(t.readTime);return Oo.newNoDocument(n,r)}(e,t):li(7234,{result:t})}(n.serializer,e);i.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{const t=i.get(e.toString());ui(!!t,55234,{key:e}),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new yc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=Oi.fromPath(t);this.mutations.push(new vc(n,this.precondition(n)))}),await async function(e,t){const n=di(e),r={writes:t.map(e=>lu(n.serializer,e))};await n.Go("Commit",n.serializer.databaseId,Di.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw li(50498,{Gu:e.constructor.name});t=Ki.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new fi(hi.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ki.min())?sc.exists(!1):sc.updateTime(t):sc.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ki.min()))throw new fi(hi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return sc.updateTime(t)}return sc.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class hf{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.zu=n.maxAttempts,this.M_=new Id(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new df(this.datastore),t=this.Hu(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Yu(e)}))}).catch(e=>{this.Yu(e)})})}Hu(e){try{const t=this.updateFunction(e);return!ca(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Ec(t)}return!1}}const ff="FirestoreClient";class pf{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ei.UNAUTHENTICATED,this.clientId=Ni.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async e=>{si(ff,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(si(ff,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=gh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function gf(e,t){e.asyncQueue.verifyOperationInProgress(),si(ff,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await ad(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function mf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await yf(e);si(ff,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>uh(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>uh(t.remoteStore,n)),e._onlineComponents=t}async function yf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){si(ff,"Using user provided OfflineComponentProvider");try{await gf(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===hi.FAILED_PRECONDITION||e.code===hi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;ai("Error using user provided cache. Falling back to memory cache: "+n),await gf(e,new of)}}else si(ff,"Using default OfflineComponentProvider"),await gf(e,new lf(void 0));return e._offlineComponents}async function vf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(si(ff,"Using user provided OnlineComponentProvider"),await mf(e,e._uninitializedComponentsProvider._online)):(si(ff,"Using default OnlineComponentProvider"),await mf(e,new cf))),e._onlineComponents}function bf(e){return vf(e).then(e=>e.syncEngine)}function xf(e){return vf(e).then(e=>e.datastore)}async function wf(e){const t=await vf(e),n=t.eventManager;return n.onListen=Mh.bind(null,t.syncEngine),n.onUnlisten=zh.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Fh.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Bh.bind(null,t.syncEngine),n}function kf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const _f=new Map,Nf="firestore.googleapis.com",Ef=!0;class Sf{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new fi(hi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Nf,this.ssl=Ef}else this.host=e.host,this.ssl=e.ssl??Ef;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Cu;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Ru)throw new fi(hi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new fi(hi.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kf(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new fi(hi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new fi(hi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new fi(hi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Tf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new fi(hi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new fi(hi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sf(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new mi;switch(e.type){case"firstParty":return new xi(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new fi(hi.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=_f.get(e);t&&(si("ComponentProvider","Removing Datastore"),_f.delete(e),t.terminate())}(this),Promise.resolve()}}class Cf{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cf(this.firestore,e,this._query)}}class If{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new If(this.firestore,e,this._key)}toJSON(){return{type:If._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(qi(t,If._jsonSchema))return new If(e,n||null,new Oi(Di.fromString(t.referencePath)))}}If._jsonSchemaVersion="firestore/documentReference/1.0",If._jsonSchema={type:$i("string",If._jsonSchemaVersion),referencePath:$i("string")};class jf extends Cf{constructor(e,t,n){super(e,t,hl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new If(this.firestore,null,new Oi(e))}withConverter(e){return new jf(this.firestore,e,this._path)}}function Af(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=M(e),Mi("collection","path",t),e instanceof Tf){const n=Di.fromString(t,...r);return Ui(n),new jf(e,null,n)}{if(!(e instanceof If||e instanceof jf))throw new fi(hi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Di.fromString(t,...r));return Ui(n),new jf(e.firestore,null,n)}}function Rf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=M(e),1===arguments.length&&(t=Ni.newId()),Mi("doc","path",t),e instanceof Tf){const n=Di.fromString(t,...r);return Fi(n),new If(e,null,new Oi(n))}{if(!(e instanceof If||e instanceof jf))throw new fi(hi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Di.fromString(t,...r));return Fi(n),new If(e.firestore,e instanceof jf?e.converter:null,new Oi(n))}}const Df="AsyncQueue";class Pf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Id(this,"async_queue_retry"),this._c=()=>{const e=Td();e&&si(Df,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Td();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Td();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new pi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!aa(e))throw e;si(Df,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,ii("INTERNAL UNHANDLED ERROR: ",Lf(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=ph.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&li(47125,{Pc:Lf(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Lf(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Of(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Mf extends Tf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Pf,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Pf(e),this._firestoreClient=void 0,await e}}}function Ff(e){if(e._terminated)throw new fi(hi.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Uf(e),e._firestoreClient}function Uf(e){const t=e._freezeSettings(),n=function(e,t,n,r){return new oo(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,kf(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||"",e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new pf(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){const t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}class Vf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vf(Qa.fromBase64String(e))}catch(e){throw new fi(hi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Vf(Qa.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vf._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qi(e,Vf._jsonSchema))return Vf.fromBase64String(e.bytes)}}Vf._jsonSchemaVersion="firestore/bytes/1.0",Vf._jsonSchema={type:$i("string",Vf._jsonSchemaVersion),bytes:$i("string")};class zf{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new fi(hi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Li(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Bf{constructor(e){this._methodName=e}}class $f{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new fi(hi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new fi(hi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ei(this._lat,e._lat)||Ei(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$f._jsonSchemaVersion}}static fromJSON(e){if(qi(e,$f._jsonSchema))return new $f(e.latitude,e.longitude)}}$f._jsonSchemaVersion="firestore/geoPoint/1.0",$f._jsonSchema={type:$i("string",$f._jsonSchemaVersion),latitude:$i("number"),longitude:$i("number")};class qf{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qf._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qi(e,qf._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new qf(e.vectorValues);throw new fi(hi.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qf._jsonSchemaVersion="firestore/vectorValue/1.0",qf._jsonSchema={type:$i("string",qf._jsonSchemaVersion),vectorValues:$i("object")};const Hf=/^__.*__$/;class Wf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new fc(e,this.data,this.fieldMask,t,this.fieldTransforms):new hc(e,this.data,t,this.fieldTransforms)}}class Gf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new fc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Kf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw li(40011,{Ac:e})}}class Qf{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return dp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Kf(this.Ac)&&Hf.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Yf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Cd(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Qf({Ac:e,methodName:t,Dc:n,path:Li.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jf(e){const t=e._freezeSettings(),n=Cd(e._databaseId);return new Yf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Xf(e,t,n,r,s){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Cc(i.merge||i.mergeFields?2:0,t,n,s);op("Data must be an object, but it was:",a,r);const o=ip(r,a);let l,c;if(i.merge)l=new Ga(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=lp(t,r,n);if(!a.contains(s))throw new fi(hi.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);hp(e,s)||e.push(s)}l=new Ga(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new Wf(new Po(o),l,c)}class Zf extends Bf{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Zf}}class ep extends Bf{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Zl(e.serializer,$l(e.serializer,this.Fc));return new nc(e.path,t)}isEqual(e){return e instanceof ep&&this.Fc===e.Fc}}function tp(e,t,n,r){const s=e.Cc(1,t,n);op("Data must be an object, but it was:",s,r);const i=[],a=Po.empty();Va(r,(e,r)=>{const o=up(t,e,n);r=M(r);const l=s.yc(o);if(r instanceof Zf)i.push(o);else{const e=sp(r,l);null!=e&&(i.push(o),a.set(o,e))}});const o=new Ga(i);return new Gf(a,o,s.fieldTransforms)}function np(e,t,n,r,s,i){const a=e.Cc(1,t,n),o=[lp(t,r,n)],l=[s];if(i.length%2!=0)throw new fi(hi.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(lp(t,i[h])),l.push(i[h+1]);const c=[],u=Po.empty();for(let h=o.length-1;h>=0;--h)if(!hp(c,o[h])){const e=o[h];let t=l[h];t=M(t);const n=a.yc(e);if(t instanceof Zf)c.push(e);else{const r=sp(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new Ga(c);return new Gf(u,d,a.fieldTransforms)}function rp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return sp(n,e.Cc(r?4:3,t))}function sp(e,t){if(ap(e=M(e)))return op("Unsupported field value:",t,e),ip(e,t);if(e instanceof Bf)return function(e,t){if(!Kf(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=sp(s,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=M(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return $l(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Gi.fromDate(e);return{timestampValue:Kc(t.serializer,n)}}if(e instanceof Gi){const n=new Gi(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Kc(t.serializer,n)}}if(e instanceof $f)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Vf)return{bytesValue:Qc(t.serializer,e._byteString)};if(e instanceof If){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Xc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof qf)return function(e,t){return{mapValue:{fields:{[uo]:{stringValue:po},[go]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return zl(t.serializer,e)})}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${zi(e)}`)}(e,t)}function ip(e,t){const n={};return za(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Va(e,(e,r)=>{const s=sp(r,t.mc(e));null!=s&&(n[e]=s)}),{mapValue:{fields:n}}}function ap(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Gi||e instanceof $f||e instanceof Vf||e instanceof If||e instanceof Bf||e instanceof qf)}function op(e,t,n){if(!ap(n)||!Vi(n)){const r=zi(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function lp(e,t,n){if((t=M(t))instanceof zf)return t._internalPath;if("string"==typeof t)return up(e,t);throw dp("Field path arguments must be of type string or ",e,!1,void 0,n)}const cp=new RegExp("[~\\*/\\[\\]]");function up(e,t,n){if(t.search(cp)>=0)throw dp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new zf(...t.split("."))._internalPath}catch(r){throw dp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function dp(e,t,n,r,s){const i=r&&!r.isEmpty(),a=void 0!==s;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new fi(hi.INVALID_ARGUMENT,o+e+l)}function hp(e,t){return e.some(e=>e.isEqual(t))}class fp{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new If(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new pp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(gp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class pp extends fp{data(){return super.data()}}function gp(e,t){return"string"==typeof t?up(e,t):t instanceof zf?t._internalPath:t._delegate._internalPath}function mp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new fi(hi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yp{}class vp extends yp{}function bp(e,t){let n=[];for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];t instanceof yp&&n.push(t),n=n.concat(s),function(e){const t=e.filter(e=>e instanceof wp).length,n=e.filter(e=>e instanceof xp).length;if(t>1||t>0&&n>0)throw new fi(hi.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class xp extends vp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new xp(e,t,n)}_apply(e){const t=this._parse(e);return Sp(e._query,t),new Cf(e.firestore,e.converter,vl(e._query,t))}_parse(e){const t=Jf(e.firestore),n=function(e,t,n,r,s,i,a){let o;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new fi(hi.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){Ep(a,i);const t=[];for(const n of a)t.push(Np(r,e,n));o={arrayValue:{values:t}}}else o=Np(r,e,a)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Ep(a,i),o=rp(n,t,a,"in"===i||"not-in"===i);return $o.create(s,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class wp extends yp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new wp(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:qo.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)Sp(n,s),n=vl(n,s)}(e._query,t),new Cf(e.firestore,e.converter,vl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class kp extends vp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new kp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new fi(hi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new fi(hi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vo(t,n)}(e._query,this._field,this._direction);return new Cf(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new ul(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function _p(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=gp("orderBy",e);return kp._create(n,t)}function Np(e,t,n){if("string"==typeof(n=M(n))){if(""===n)throw new fi(hi.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pl(t)&&-1!==n.indexOf("/"))throw new fi(hi.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Di.fromString(n));if(!Oi.isDocumentKey(r))throw new fi(hi.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Eo(e,new Oi(r))}if(n instanceof If)return Eo(e,n._key);throw new fi(hi.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zi(n)}.`)}function Ep(e,t){if(!Array.isArray(e)||0===e.length)throw new fi(hi.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Sp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new fi(hi.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new fi(hi.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Tp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xa(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Za(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw li(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Va(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){const t=e.fields?.[go].arrayValue?.values?.map(e=>Xa(e.doubleValue));return new qf(t)}convertGeoPoint(e){return new $f(Xa(e.latitude),Xa(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=io(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ao(e));default:return null}}convertTimestamp(e){const t=Ja(e);return new Gi(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Di.fromString(e);ui(xu(n),9688,{name:e});const r=new co(n.get(1),n.get(3)),s=new Oi(n.popFirst(5));return r.isEqual(t)||ii(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Cp(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Ip extends Tp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new If(this.firestore,null,t)}}class jp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ap extends fp{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Rp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(gp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new fi(hi.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ap._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Ap._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ap._jsonSchema={type:$i("string",Ap._jsonSchemaVersion),bundleSource:$i("string","DocumentSnapshot"),bundleName:$i("string"),bundle:$i("string")};class Rp extends Ap{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Dp{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new jp(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Rp(this._firestore,this._userDataWriter,n.key,n,new jp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new fi(hi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Rp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new jp(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Rp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new jp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:Pp(t.type),doc:r,oldIndex:s,newIndex:i}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new fi(hi.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Dp._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ni.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Pp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return li(61501,{type:e})}}Dp._jsonSchemaVersion="firestore/querySnapshot/1.0",Dp._jsonSchema={type:$i("string",Dp._jsonSchemaVersion),bundleSource:$i("string","QuerySnapshot"),bundleName:$i("string"),bundle:$i("string")};class Lp extends Tp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new If(this.firestore,null,t)}}function Op(e,t,n){e=Bi(e,If);const r=Bi(e.firestore,Mf),s=Cp(e.converter,t,n);return zp(r,[Xf(Jf(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,sc.none())])}function Mp(e,t,n){e=Bi(e,If);const r=Bi(e.firestore,Mf),s=Jf(r);let i;for(var a=arguments.length,o=new Array(a>3?a-3:0),l=3;l<a;l++)o[l-3]=arguments[l];return i="string"==typeof(t=M(t))||t instanceof zf?np(s,"updateDoc",e._key,t,n,o):tp(s,"updateDoc",e._key,t),zp(r,[i.toMutation(e._key,sc.exists(!0))])}function Fp(e){return zp(Bi(e.firestore,Mf),[new yc(e._key,sc.none())])}function Up(e,t){const n=Bi(e.firestore,Mf),r=Rf(e),s=Cp(e.converter,t);return zp(n,[Xf(Jf(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,sc.exists(!1))]).then(()=>r)}function Vp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=M(e);let s={includeMetadataChanges:!1,source:"default"},i=0;"object"!=typeof n[i]||Of(n[i])||(s=n[i++]);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Of(n[i])){const e=n[i];n[i]=e.next?.bind(e),n[i+1]=e.error?.bind(e),n[i+2]=e.complete?.bind(e)}let o,l,c;if(e instanceof If)l=Bi(e.firestore,Mf),c=hl(e._key.path),o={next:t=>{n[i]&&n[i](Bp(l,e,t))},error:n[i+1],complete:n[i+2]};else{const t=Bi(e,Cf);l=Bi(t.firestore,Mf),c=t._query;const r=new Lp(l);o={next:e=>{n[i]&&n[i](new Dp(l,r,t,e))},error:n[i+1],complete:n[i+2]},mp(e._query)}return function(e,t,n,r){const s=new uf(r),i=new Ih(t,s,n);return e.asyncQueue.enqueueAndForget(async()=>kh(await wf(e),i)),()=>{s.Nu(),e.asyncQueue.enqueueAndForget(async()=>_h(await wf(e),i))}}(Ff(l),c,a,o)}function zp(e,t){return function(e,t){const n=new pi;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=af(e);try{const e=await function(e,t){const n=di(e),r=Gi.now(),s=t.reduce((e,t)=>e.add(t.key),Fl());let i,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Il(),l=Fl();return n.Ns.getEntries(e,s).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(s=>{i=s;const a=[];for(const e of t){const t=uc(e,i.get(e.key).overlayedDocument);null!=t&&a.push(new fc(e.key,t,Lo(t.value.mapValue),sc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:Rl(i)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Ba(Ei)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await tf(r,e.changes),await th(r.remoteStore)}catch(e){const t=gh(e,"Failed to persist write");n.reject(t)}}(await bf(e),t,n)),n.promise}(Ff(e),t)}function Bp(e,t,n){const r=n.docs.get(t._key),s=new Lp(e);return new Ap(e,s,t._key,r,new jp(n.hasPendingWrites,n.fromCache),t.converter)}const $p={maxAttempts:5};function qp(e,t){if((e=M(e)).firestore!==t)throw new fi(hi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Hp{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Jf(e)}get(e){const t=qp(e,this._firestore),n=new Ip(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return li(24041);const r=e[0];if(r.isFoundDocument())return new fp(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new fp(this._firestore,n,t._key,null,t.converter);throw li(18433,{doc:r})})}set(e,t,n){const r=qp(e,this._firestore),s=Cp(r.converter,t,n),i=Xf(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,n);return this._transaction.set(r._key,i),this}update(e,t,n){const r=qp(e,this._firestore);let s;for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];return s="string"==typeof(t=M(t))||t instanceof zf?np(this._dataReader,"Transaction.update",r._key,t,n,a):tp(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,s),this}delete(e){const t=qp(e,this._firestore);return this._transaction.delete(t._key),this}}class Wp extends Hp{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=qp(e,this._firestore),n=new Lp(this._firestore);return super.get(e).then(e=>new Ap(this._firestore,n,t._key,e._document,new jp(!1,!1),t.converter))}}function Gp(e,t,n){e=Bi(e,Mf);const r={...$p,...n};return function(e){if(e.maxAttempts<1)throw new fi(hi.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new pi;return e.asyncQueue.enqueueAndForget(async()=>{const s=await xf(e);new hf(e.asyncQueue,s,n,t,r).ju()}),r.promise}(Ff(e),n=>t(new Wp(e,n)),r)}function Kp(e){return new ep("increment",e)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ti=e}(Xe),Ge(new F("firestore",(e,n)=>{let{instanceIdentifier:r,options:s}=n;const i=e.getProvider("app").getImmediate(),a=new Mf(new vi(e.getProvider("auth-internal")),new ki(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new fi(hi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new co(e.options.projectId,t)}(i,r),i);return s={useFetchStreams:t,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),tt(Xs,Zs,e),tt(Xs,Zs,"esm2020")}();const Qp="firebasestorage.googleapis.com",Yp="storageBucket";class Jp extends T{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(eg(e),`Firebase Storage: ${t} (${eg(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Jp.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return eg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var Xp,Zp;function eg(e){return"storage/"+e}function tg(){return new Jp(Xp.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function ng(){return new Jp(Xp.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rg(){return new Jp(Xp.CANCELED,"User canceled the upload/download.")}function sg(){return new Jp(Xp.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ig(e){return new Jp(Xp.INVALID_ARGUMENT,e)}function ag(){return new Jp(Xp.APP_DELETED,"The Firebase app was deleted.")}function og(e,t){return new Jp(Xp.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function lg(e){throw new Jp(Xp.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Xp||(Xp={}));class cg{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=cg.makeFromUrl(e,t)}catch(s){return new cg(e,"")}if(""===n.path)return n;throw r=e,new Jp(Xp.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const s=new RegExp("^gs://"+r+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),o=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp(`^https?://${t===Qp?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:i}];for(let l=0;l<o.length;l++){const t=o[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let s=r[t.indices.path];s||(s=""),n=new cg(e,s),t.postModify(n);break}}if(null==n)throw function(e){return new Jp(Xp.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class ug{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function dg(e){return"string"===typeof e||e instanceof String}function hg(e){return fg()&&e instanceof Blob}function fg(){return"undefined"!==typeof Blob}function pg(e,t,n,r){if(r<t)throw ig(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw ig(`Invalid value for '${e}'. Expected ${n} or less.`)}function gg(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function mg(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function yg(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),s=-1!==t.indexOf(e);return n||r||s}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Zp||(Zp={}));class vg{constructor(e,t,n,r,s,i,a,o,l,c,u){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],h=arguments.length>12&&void 0!==arguments[12]&&arguments[12];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=i,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=d,this.isUsingEmulator=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new bg(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Zp.NO_ERROR,s=n.getStatus();if(!t||yg(s,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Zp.ABORT;return void e(!1,new bg(!1,null,t))}const i=-1!==this.successCodes_.indexOf(s);e(!0,new bg(i,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(i){r(i)}else if(null!==s){const e=tg();e.serverResponse=s.getErrorText(),this.errorCallback_?r(this.errorCallback_(s,e)):r(e)}else if(t.canceled){r(this.appDelete_?ag():rg())}else{r(ng())}};this.canceled_?t(0,new bg(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,s=null,i=null,a=!1,o=0;function l(){return 2===o}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function d(t){s=setTimeout(()=>{s=null,e(f,l())},t)}function h(){i&&clearTimeout(i)}function f(e){if(c)return void h();for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(e)return h(),void u.call(null,e,...n);if(l()||a)return h(),void u.call(null,e,...n);let i;r<64&&(r*=2),1===o?(o=2,i=0):i=1e3*(r+Math.random()),d(i)}let p=!1;function g(e){p||(p=!0,h(),c||(null!==s?(e||(o=2),clearTimeout(s),d(0)):e||(o=1)))}return d(0),i=setTimeout(()=>{a=!0,g(!0)},n),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class bg{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function xg(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function wg(){const e=xg();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(fg())return new Blob(n);throw new Jp(Xp.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function kg(e){if("undefined"===typeof atob)throw t="base-64",new Jp(Xp.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}const _g="raw",Ng="base64",Eg="base64url",Sg="data_url";class Tg{constructor(e,t){this.data=e,this.contentType=t||null}}function Cg(e,t){switch(e){case _g:return new Tg(Ig(t));case Ng:case Eg:return new Tg(jg(e,t));case Sg:return new Tg(function(e){const t=new Ag(e);return t.base64?jg(Ng,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw og(Sg,"Malformed data URL.")}return Ig(t)}(t.rest)}(t),new Ag(t).contentType)}throw tg()}function Ig(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function jg(e,t){switch(e){case Ng:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw og(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case Eg:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw og(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=kg(t)}catch(s){if(s.message.includes("polyfill"))throw s;throw og(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class Ag{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw og(Sg,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class Rg{constructor(e,t){let n=0,r="";hg(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(hg(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new Rg(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Rg(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(fg()){const e=t.map(e=>e instanceof Rg?e.data_:e);return new Rg(wg.apply(null,e))}{const e=t.map(e=>dg(e)?Cg(_g,e).data:e.data_);let n=0;e.forEach(e=>{n+=e.byteLength});const r=new Uint8Array(n);let s=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)r[s++]=e[t]}),new Rg(r,!0)}}uploadData(){return this.data_}}function Dg(e){let t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function Pg(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Lg(e,t){return t}class Og{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||Lg}}let Mg=null;function Fg(){if(Mg)return Mg;const e=[];e.push(new Og("bucket")),e.push(new Og("generation")),e.push(new Og("metageneration")),e.push(new Og("name","fullPath",!0));const t=new Og("name");t.xform=function(e,t){return function(e){return!dg(e)||e.length<2?e:Pg(e)}(t)},e.push(t);const n=new Og("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Og("timeCreated")),e.push(new Og("updated")),e.push(new Og("md5Hash",null,!0)),e.push(new Og("cacheControl",null,!0)),e.push(new Og("contentDisposition",null,!0)),e.push(new Og("contentEncoding",null,!0)),e.push(new Og("contentLanguage",null,!0)),e.push(new Og("contentType",null,!0)),e.push(new Og("metadata","customMetadata",!0)),Mg=e,Mg}function Ug(e,t,n){const r={type:"file"},s=n.length;for(let i=0;i<s;i++){const e=n[i];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,s=new cg(n,r);return t._makeStorageReference(s)}})}(r,e),r}function Vg(e,t,n){const r=Dg(t);if(null===r)return null;return Ug(e,r,n)}function zg(e,t){const n={},r=t.length;for(let s=0;s<r;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Bg{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function $g(e){if(!e)throw tg()}function qg(e,t){return function(n,r){const s=Vg(e,r,t);return $g(null!==s),s}}function Hg(e,t){return function(n,r){const s=Vg(e,r,t);return $g(null!==s),function(e,t,n,r){const s=Dg(t);if(null===s)return null;if(!dg(s.downloadTokens))return null;const i=s.downloadTokens;if(0===i.length)return null;const a=encodeURIComponent;return i.split(",").map(t=>{const s=e.bucket,i=e.fullPath;return gg("/b/"+a(s)+"/o/"+a(i),n,r)+mg({alt:"media",token:t})})[0]}(s,r,e.host,e._protocol)}}function Wg(e){return function(t,n){let r;var s,i;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new Jp(Xp.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Jp(Xp.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new Jp(Xp.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(s=e.path,r=new Jp(Xp.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function Gg(e){const t=Wg(e);return function(n,r){let s=t(n,r);var i;return 404===n.getStatus()&&(i=e.path,s=new Jp(Xp.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),s.serverResponse=r.serverResponse,s}}function Kg(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function Qg(e,t,n,r,s){const i=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};const o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+o;const l=Kg(t,r,s),c="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+zg(l,n)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+o+"--",d=Rg.getBlob(c,r,u);if(null===d)throw sg();const h={name:l.fullPath},f=gg(i,e.host,e._protocol),p=e.maxUploadRetryTime,g=new Bg(f,"POST",qg(e,n),p);return g.urlParams=h,g.headers=a,g.body=d.uploadData(),g.errorHandler=Wg(t),g}class Yg{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Zp.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Zp.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Zp.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r,s){if(this.sent_)throw lg("cannot .send() more than once");if(y(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==s)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw lg("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw lg("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw lg("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw lg("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Jg extends Yg{initXhr(){this.xhr_.responseType="text"}}function Xg(){return new Jg}class Zg{constructor(e,t){this._service=e,this._location=t instanceof cg?t:cg.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Zg(e,t)}get root(){const e=new cg(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Pg(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new cg(this._location.bucket,e);return new Zg(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Jp(Xp.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function em(e,t,n){e._throwIfRoot("uploadBytes");const r=Qg(e.storage,e._location,Fg(),new Rg(t,!0),n);return e.storage.makeRequestWithTokens(r,Xg).then(t=>({metadata:t,ref:e}))}function tm(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=gg(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,i=new Bg(r,"GET",Hg(e,n),s);return i.errorHandler=Gg(t),i}(e.storage,e._location,Fg());return e.storage.makeRequestWithTokens(t,Xg).then(e=>{if(null===e)throw new Jp(Xp.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function nm(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=gg(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,s=new Bg(n,"DELETE",function(e,t){},r);return s.successCodes=[200,204],s.errorHandler=Gg(t),s}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,Xg)}function rm(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new cg(e._location.bucket,n);return new Zg(e.storage,r)}function sm(e,t){if(e instanceof om){const n=e;if(null==n._bucket)throw new Jp(Xp.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Yp+"' property when initializing the app?");const r=new Zg(n,n._bucket);return null!=t?sm(r,t):r}return void 0!==t?rm(e,t):e}function im(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof om)return new Zg(e,t);throw ig("To use ref(service, url), the first argument must be a Storage instance.")}return sm(e,t)}function am(e,t){const n=t?.[Yp];return null==n?null:cg.makeFromBucketSpec(n,e)}class om{constructor(e,t,n,r,s){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=i,this._bucket=null,this._host=Qp,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?cg.makeFromBucketSpec(r,this._host):am(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=cg.makeFromBucketSpec(this._url,e):this._bucket=am(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){pg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){pg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(Qe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Zg(this,e)}_makeRequest(e,t,n,r){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new ug(ag());{const i=function(e,t,n,r,s,i){let a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=mg(e.urlParams),c=e.url+l,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(u,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new vg(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,a,o)}(e,this._appId,n,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const lm="@firebase/storage",cm="0.14.0",um="storage";function dm(e,t,n){return em(e=M(e),t,n)}function hm(e){return tm(e=M(e))}function fm(e){return nm(e=M(e))}function pm(e,t){return im(e=M(e),t)}function gm(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new om(r,s,i,n,Xe)}Ge(new F(um,gm,"PUBLIC").setMultipleInstances(!0)),tt(lm,cm,""),tt(lm,cm,"esm2020");var mm=n(579);const ym=Ze({apiKey:"AIzaSyDJTS2-XcoJCIR3OYDTE2-oqsUjorA4P-M",authDomain:"jurnal-trading-saya.firebaseapp.com",projectId:"jurnal-trading-saya",storageBucket:"jurnal-trading-saya.firebasestorage.app",messagingSenderId:"55282716936",appId:"1:55282716936:web:0d631d8ada6f89c7411cbd",measurementId:"G-BZ0D0MZXJV"}),vm=function(e,t){const n="object"==typeof e?e:et(),r="string"==typeof e?e:t||lo,s=Ke(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const e=f("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=Bi(e,Tf);const s=y(t),i=e._getSettings(),a={...i,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${n}`;s&&(v(`https://${o}`),k("Firestore",!0)),i.host!==Nf&&i.host!==o&&ai("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:o,ssl:s,emulatorOptions:r};if(!j(l,a)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ei.MOCK_USER;else{t=b(r.mockUserToken,e._app?.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new fi(hi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ei(s)}e._authCredentials=new yi(new gi(t,n))}}(s,...e)}return s}(ym),bm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et(),t=arguments.length>1?arguments[1]:void 0;e=M(e);const n=Ke(e,um).getImmediate({identifier:t}),r=f("storage");return r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host=`${t}:${n}`;const s=y(t);s&&(v(`https://${e.host}/b`),k("Storage",!0)),e._isUsingEmulator=!0,e._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"===typeof i?i:b(i,e.app.options.projectId))}(e,t,n,r)}(n,...r),n}(ym),xm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et();const t=Ke(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Ke(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(j(n.getOptions(),t??{}))return e;yt(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:As,persistence:[zr,wr,Sr]}),r=g("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(s=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ls)return;const r=t?.token;Os!==r&&(Os=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){M(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){M(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var s;const i=h("auth");return i&&Un(n,`http://${i}`),n}(ym),wm=async function(e,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r={contents:[{parts:[{text:e}]}],systemInstruction:{parts:[{text:t}]}};arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(r.tools=[{google_search:{}}]),n&&(r.generationConfig={responseMimeType:"application/json",responseSchema:n});let s=0;for(;s<5;)try{var i,a,o,l;const e=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=AIzaSyCwiCfrPq6J0deEbYewPDw5bJMgdpJxTag",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const t=await e.json();throw console.error("Gemini API Error:",t),new Error(`API request failed with status ${e.status}`)}const t=await e.json(),n=null===(i=t.candidates)||void 0===i?void 0:i[0];if(n&&null!==(a=n.content)&&void 0!==a&&null!==(o=a.parts)&&void 0!==o&&null!==(l=o[0])&&void 0!==l&&l.text)return n.content.parts[0].text;throw console.error("Unexpected API response structure:",t),new Error("Invalid response structure from API.")}catch(c){if(s++,s>=5)throw console.error("Max retry attempts reached for Gemini API call."),c;const e=100*Math.pow(2,s);await new Promise(t=>setTimeout(t,e))}},km=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e),_m=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,mm.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,mm.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,mm.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})},Nm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,mm.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})},Em=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("polyline",{points:"3 6 5 6 21 6"}),(0,mm.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})},Sm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"5"}),(0,mm.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),(0,mm.jsx)("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),(0,mm.jsx)("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),(0,mm.jsx)("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),(0,mm.jsx)("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),(0,mm.jsx)("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),(0,mm.jsx)("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),(0,mm.jsx)("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]})},Tm=e=>{let{className:t}=e;return(0,mm.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:(0,mm.jsx)("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})},Cm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"6"}),(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"2"})]})},Im=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M8 2v4"}),(0,mm.jsx)("path",{d:"M16 2v4"}),(0,mm.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"}),(0,mm.jsx)("path",{d:"M8 10h.01"}),(0,mm.jsx)("path",{d:"M12 10h.01"}),(0,mm.jsx)("path",{d:"M16 10h.01"}),(0,mm.jsx)("path",{d:"M8 14h.01"}),(0,mm.jsx)("path",{d:"M12 14h.01"}),(0,mm.jsx)("path",{d:"M16 14h.01"})]})},jm=e=>{let{className:t,filled:n}=e;return(0,mm.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:n?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:(0,mm.jsx)("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})},Am=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,mm.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})},Rm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,mm.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),(0,mm.jsx)("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]})},Dm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,mm.jsx)("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]})},Pm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,mm.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,mm.jsx)("polyline",{points:"21 15 16 10 5 21"})]})},Lm=e=>{let{className:t}=e;return(0,mm.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:(0,mm.jsx)("polyline",{points:"15 18 9 12 15 6"})})},Om=e=>{let{className:t}=e;return(0,mm.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:(0,mm.jsx)("polyline",{points:"9 18 15 12 9 6"})})},Mm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,mm.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})},Fm=e=>{let{className:t,style:n}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,style:n,children:[(0,mm.jsx)("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),(0,mm.jsx)("polyline",{points:"22 4 12 14.01 9 11.01"})]})},Um=e=>{let{className:t,style:n}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,style:n,children:[(0,mm.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),(0,mm.jsx)("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),(0,mm.jsx)("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})},Vm=e=>{let{className:t,style:n}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,style:n,children:[(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,mm.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,mm.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})},zm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),(0,mm.jsx)("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),(0,mm.jsx)("path",{d:"m9 14 2 2 4-4"})]})},Bm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("line",{x1:"19",y1:"5",x2:"5",y2:"19"}),(0,mm.jsx)("circle",{cx:"6.5",cy:"6.5",r:"2.5"}),(0,mm.jsx)("circle",{cx:"17.5",cy:"17.5",r:"2.5"})]})},$m=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M16 8h2a2 2 0 0 1 2 2v2M8 8H6a2 2 0 0 0-2 2v2"}),(0,mm.jsx)("path",{d:"M12 2v4"}),(0,mm.jsx)("path",{d:"M12 18v4"}),(0,mm.jsx)("path",{d:"M12 12c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"}),(0,mm.jsx)("path",{d:"M12 12c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5z"})]})},qm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M16 16h2a2 2 0 0 0 2-2v-2M8 16H6a2 2 0 0 1-2-2v-2"}),(0,mm.jsx)("path",{d:"M12 2v4"}),(0,mm.jsx)("path",{d:"M12 18v4"}),(0,mm.jsx)("path",{d:"M12 12c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"}),(0,mm.jsx)("path",{d:"M12 12c2.76 0 5 2.24 5 5s-2.24 5-5 5-5-2.24-5-5 2.24-5 5-5z"})]})},Hm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),(0,mm.jsx)("polyline",{points:"16 17 21 12 16 7"}),(0,mm.jsx)("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})},Wm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,mm.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,mm.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})},Gm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,mm.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})},Km=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M15 4V2"}),(0,mm.jsx)("path",{d:"M15 10V8"}),(0,mm.jsx)("path",{d:"M12.5 6.5L14 5"}),(0,mm.jsx)("path",{d:"M12.5 11.5L14 13"}),(0,mm.jsx)("path",{d:"M5 4V2"}),(0,mm.jsx)("path",{d:"M5 10V8"}),(0,mm.jsx)("path",{d:"M7.5 6.5L6 5"}),(0,mm.jsx)("path",{d:"M7.5 11.5L6 13"}),(0,mm.jsx)("path",{d:"M10 22v-8"}),(0,mm.jsx)("path",{d:"m15 22-3-3-3 3"}),(0,mm.jsx)("path",{d:"M20 15h-2"}),(0,mm.jsx)("path",{d:"M4 15H2"}),(0,mm.jsx)("path",{d:"m17.5 12.5-1.5 1.5"}),(0,mm.jsx)("path",{d:"m6.5 12.5-1.5 1.5"})]})},Qm=e=>{let{className:t}=e;return(0,mm.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:(0,mm.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})},Ym=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,mm.jsx)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})},Jm=e=>{let{className:t,filled:n}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:n?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M7 10v12"}),(0,mm.jsx)("path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"})]})},Xm=e=>{let{className:t,filled:n}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:n?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M17 14V2"}),(0,mm.jsx)("path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z"})]})},Zm=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("circle",{cx:"12",cy:"12",r:"1"}),(0,mm.jsx)("circle",{cx:"12",cy:"5",r:"1"}),(0,mm.jsx)("circle",{cx:"12",cy:"19",r:"1"})]})},ey=e=>{let{className:t}=e;return(0,mm.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,mm.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,mm.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})},ty=e=>{let{isOpen:t,title:n,message:r,onConfirm:s,onCancel:i,confirmText:a="Delete"}=e;return t?(0,mm.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[100] p-4",children:(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-sm",children:[(0,mm.jsx)("h3",{className:"text-lg font-bold",children:n}),(0,mm.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:r}),(0,mm.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,mm.jsx)("button",{onClick:i,className:"px-4 py-2 rounded-md bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-sm font-semibold",children:"Cancel"}),(0,mm.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-md bg-red-600 hover:bg-red-700 text-white text-sm font-semibold",children:a})]})]})}):null},ny=e=>{var t,n,s,i;let{post:a,user:o,profileData:l}=e;const[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)([]),[f,p]=(0,r.useState)(""),[g,m]=(0,r.useState)(!1),[y,v]=(0,r.useState)(!1),[b,x]=(0,r.useState)(a.title),[w,k]=(0,r.useState)(a.content),[_,N]=(0,r.useState)(!1),E=(0,r.useRef)(null),[S,T]=(0,r.useState)(null),[C,I]=(0,r.useState)(null),[j,A]=(0,r.useState)(null),[R,D]=(0,r.useState)(a.imageUrl||""),P=(0,r.useRef)(null),L=Rf(vm,"community_feed",a.id),O=null===(t=a.likes)||void 0===t?void 0:t.includes(o.uid),M=null===(n=a.dislikes)||void 0===n?void 0:n.includes(o.uid);(0,r.useEffect)(()=>{if(!c)return;const e=Vp(bp(Af(L,"comments"),_p("createdAt","desc")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));h(t)});return()=>e()},[c,a.id]),(0,r.useEffect)(()=>{function e(e){E.current&&!E.current.contains(e.target)&&N(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[E]),(0,r.useEffect)(()=>{y&&(x(a.title),k(a.content),D(a.imageUrl||""),A(null))},[y,a]);const F=async e=>{try{await Gp(vm,async t=>{const n=await t.get(L);if(!n.exists())throw"Document does not exist!";let r=n.data().likes||[],s=n.data().dislikes||[];const i=r.includes(o.uid),a=s.includes(o.uid);"like"===e?i?r=r.filter(e=>e!==o.uid):(r.push(o.uid),a&&(s=s.filter(e=>e!==o.uid))):"dislike"===e&&(a?s=s.filter(e=>e!==o.uid):(s.push(o.uid),i&&(r=r.filter(e=>e!==o.uid)))),t.update(L,{likes:r,dislikes:s})})}catch(t){console.error("Vote transaction failed: ",t)}},U=async e=>{if(e.preventDefault(),b.trim()&&w.trim())try{let t=a.imageUrl;if(j){if(a.imageUrl)try{await fm(pm(bm,a.imageUrl))}catch(e){console.warn("Old image not found, continuing update")}const n=pm(bm,`community_feed/${a.id}/${Date.now()}_${j.name}`);await dm(n,j),t=await hm(n)}else if(!R&&a.imageUrl){try{await fm(pm(bm,a.imageUrl))}catch(e){console.warn("Image to remove not found")}t=""}await Mp(L,{title:b,content:w,imageUrl:t}),v(!1),N(!1)}catch(t){console.error("Error updating post:",t)}},V=async e=>{if(e.preventDefault(),!C||!C.text.trim())return;const t=Rf(vm,"community_feed",a.id,"comments",C.id);try{await Mp(t,{text:C.text}),I(null)}catch(n){console.error("Error updating comment:",n)}};return(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md relative",children:[(0,mm.jsx)(ty,{isOpen:!!S,title:"post"===(null===S||void 0===S?void 0:S.type)?"Delete Post":"Delete Comment",message:`Are you sure you want to permanently delete this ${null===S||void 0===S?void 0:S.type}? This action cannot be undone.`,onConfirm:()=>"post"===S.type?(async()=>{try{if(a.imageUrl){const e=pm(bm,a.imageUrl);await fm(e)}await Fp(Rf(vm,"community_feed",a.id))}catch(e){"storage/object-not-found"!==e.code&&console.error("Error deleting post and/or image:",e)}T(null)})():(async e=>{try{await Fp(Rf(vm,"community_feed",a.id,"comments",e)),await Gp(vm,async e=>{const t=await e.get(L);if(!t.exists())throw"Document does not exist!";const n=(t.data().commentCount||0)-1;e.update(L,{commentCount:n<0?0:n})})}catch(t){console.error("Error deleting comment:",t)}T(null)})(S.id),onCancel:()=>T(null)}),(0,mm.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,mm.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex-shrink-0 flex items-center justify-center font-bold text-lg text-gray-500 dark:text-gray-300",children:a.authorDisplayName?a.authorDisplayName.charAt(0).toUpperCase():"?"}),(0,mm.jsxs)("div",{className:"flex-1",children:[y?(0,mm.jsx)("form",{onSubmit:U,children:(0,mm.jsx)("input",{type:"text",value:b,onChange:e=>x(e.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-1 px-2 text-xl font-bold focus:outline-none focus:ring-2 focus:ring-blue-500"})}):(0,mm.jsx)("h3",{className:"text-xl font-bold",children:a.title}),(0,mm.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(0,mm.jsxs)("span",{children:["Posted by ",a.authorDisplayName||"Anonymous"]}),(0,mm.jsx)("span",{children:"\u2022"}),(0,mm.jsx)("span",{children:new Date(a.createdAt.toDate()).toLocaleString()})]})]}),o.uid===a.authorId&&!y&&(0,mm.jsxs)("div",{className:"relative",ref:E,children:[(0,mm.jsx)("button",{onClick:()=>N(!_),className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:(0,mm.jsx)(Zm,{className:"w-5 h-5"})}),_&&(0,mm.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg z-10",children:[(0,mm.jsxs)("button",{onClick:()=>{v(!0),N(!1)},className:"w-full text-left flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,mm.jsx)(ey,{className:"w-4 h-4 mr-2"})," Edit Post"]}),(0,mm.jsxs)("button",{onClick:()=>T({type:"post"}),className:"w-full text-left flex items-center px-4 py-2 text-sm text-red-500 hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,mm.jsx)(Em,{className:"w-4 h-4 mr-2"})," Delete Post"]})]})]})]}),y?(0,mm.jsxs)("form",{onSubmit:U,className:"mt-4 space-y-4",children:[(0,mm.jsx)("textarea",{value:w,onChange:e=>k(e.target.value),rows:"5",className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Post Image"}),R&&(0,mm.jsxs)("div",{className:"mt-2 relative",children:[(0,mm.jsx)("img",{src:R,alt:"Post image",className:"max-h-48 rounded-md w-auto"}),(0,mm.jsx)("button",{type:"button",onClick:()=>{A(null),D(""),P.current&&(P.current.value="")},className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white rounded-full p-1 hover:bg-opacity-75",children:(0,mm.jsx)(Am,{className:"w-4 h-4"})})]}),(0,mm.jsxs)("div",{className:"mt-2",children:[(0,mm.jsxs)("button",{type:"button",onClick:()=>P.current.click(),className:"flex items-center space-x-2 text-sm font-semibold text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300",children:[(0,mm.jsx)(Pm,{className:"w-5 h-5"}),(0,mm.jsx)("span",{children:R?"Change Image":"Add Image"})]}),(0,mm.jsx)("input",{type:"file",ref:P,onChange:e=>{const t=e.target.files[0];t&&(A(t),D(URL.createObjectURL(t)))},className:"hidden",accept:"image/*"})]})]}),(0,mm.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,mm.jsx)("button",{onClick:()=>v(!1),type:"button",className:"bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-sm font-semibold py-1 px-3 rounded-md",children:"Cancel"}),(0,mm.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold py-1 px-3 rounded-md",children:"Save Changes"})]})]}):(0,mm.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-300 whitespace-pre-wrap",children:a.content}),a.imageUrl&&!y&&(0,mm.jsx)("div",{className:"mt-4 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:(0,mm.jsx)("img",{src:a.imageUrl,alt:"User upload",className:"w-full h-auto max-h-[60vh] object-contain bg-gray-100 dark:bg-gray-900"})}),(0,mm.jsxs)("div",{className:"mt-4 flex items-center space-x-6 text-gray-500 dark:text-gray-400",children:[(0,mm.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,mm.jsx)("button",{onClick:()=>F("like"),className:"p-1 rounded-full transition "+(O?"text-blue-500":"hover:bg-gray-200 dark:hover:bg-gray-700"),children:(0,mm.jsx)(Jm,{className:"w-5 h-5",filled:O})}),(0,mm.jsx)("span",{className:"text-sm font-semibold",children:(null===(s=a.likes)||void 0===s?void 0:s.length)||0})]}),(0,mm.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,mm.jsx)("button",{onClick:()=>F("dislike"),className:"p-1 rounded-full transition "+(M?"text-red-500":"hover:bg-gray-200 dark:hover:bg-gray-700"),children:(0,mm.jsx)(Xm,{className:"w-5 h-5",filled:M})}),(0,mm.jsx)("span",{className:"text-sm font-semibold",children:(null===(i=a.dislikes)||void 0===i?void 0:i.length)||0})]}),(0,mm.jsxs)("button",{onClick:()=>u(!c),className:"flex items-center space-x-2 hover:text-blue-500 dark:hover:text-blue-400 transition",children:[(0,mm.jsx)(Qm,{className:"w-5 h-5"}),(0,mm.jsxs)("span",{className:"text-sm font-semibold",children:[a.commentCount||0," Comments"]})]})]}),c&&(0,mm.jsxs)("div",{className:"mt-4",children:[(0,mm.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!f.trim()||g)return;m(!0);const t=Af(L,"comments");try{await Up(t,{text:f,authorId:o.uid,authorDisplayName:l.displayName||o.email,createdAt:Gi.now()}),await Mp(L,{commentCount:Kp(1)}),p("")}catch(n){console.error("Error adding comment: ",n)}finally{m(!1)}},className:"flex items-center space-x-2",children:[(0,mm.jsx)("input",{type:"text",value:f,onChange:e=>p(e.target.value),placeholder:"Add a comment...",className:"w-full bg-gray-100 dark:bg-gray-700 border-transparent rounded-full py-2 px-4 focus:ring-2 focus:ring-blue-500 focus:outline-none",disabled:g}),(0,mm.jsx)("button",{type:"submit",className:"text-blue-600 hover:text-blue-500 disabled:opacity-50",disabled:g||!f,children:(0,mm.jsx)(Ym,{className:"w-6 h-6"})})]}),(0,mm.jsx)("div",{className:"mt-4",children:d.length>0?d.map(e=>(0,mm.jsxs)("div",{className:"flex items-start space-x-3 py-3 border-t border-gray-200 dark:border-gray-700",children:[(0,mm.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-600 flex-shrink-0 items-center justify-center font-bold text-sm text-gray-500 dark:text-gray-300",children:e.authorDisplayName?e.authorDisplayName.charAt(0).toUpperCase():"?"}),(0,mm.jsxs)("div",{className:"flex-1",children:[(0,mm.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,mm.jsx)("p",{className:"font-semibold text-sm",children:e.authorDisplayName||"Anonymous"}),(0,mm.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.createdAt?new Date(e.createdAt.toDate()).toLocaleString():"Just now"})]}),(null===C||void 0===C?void 0:C.id)===e.id?(0,mm.jsxs)("form",{onSubmit:V,className:"mt-2 flex items-center space-x-2",children:[(0,mm.jsx)("input",{type:"text",value:C.text,onChange:e=>I({...C,text:e.target.value}),className:"w-full text-sm bg-gray-100 dark:bg-gray-700 border-transparent rounded-md py-1 px-2 focus:ring-1 focus:ring-blue-500 focus:outline-none",autoFocus:!0}),(0,mm.jsxs)("div",{className:"flex space-x-1",children:[(0,mm.jsx)("button",{type:"submit",className:"text-green-500 hover:text-green-400 text-xs font-semibold",children:"Save"}),(0,mm.jsx)("button",{type:"button",onClick:()=>I(null),className:"text-gray-500 hover:text-gray-400 text-xs font-semibold",children:"Cancel"})]})]}):(0,mm.jsx)("p",{className:"text-sm mt-1",children:e.text})]}),o.uid===e.authorId&&!C&&(0,mm.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,mm.jsx)("button",{onClick:()=>I({id:e.id,text:e.text}),className:"p-1 rounded-full text-gray-400 hover:text-blue-500",children:(0,mm.jsx)(ey,{className:"w-4 h-4"})}),(0,mm.jsx)("button",{onClick:()=>T({type:"comment",id:e.id}),className:"p-1 rounded-full text-gray-400 hover:text-red-500",children:(0,mm.jsx)(Em,{className:"w-4 h-4"})})]})]},e.id)):(0,mm.jsx)("p",{className:"text-sm text-center text-gray-500 dark:text-gray-400 py-4",children:"No comments yet. Be the first!"})})]})]})},ry=e=>{let{item:t,onClose:n,onUpdateOutcome:r}=e;if(!t)return null;const s=e=>{let{title:t,value:n,icon:r,colorClass:s}=e;return(0,mm.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700/50 p-4 rounded-lg",children:[(0,mm.jsxs)("div",{className:`flex items-center text-sm font-bold ${s}`,children:[r,(0,mm.jsx)("h4",{className:"ml-2 uppercase tracking-wider",children:t})]}),(0,mm.jsx)("p",{className:"mt-2 text-xl font-mono",children:n})]})};return(0,mm.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto relative",children:[(0,mm.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 dark:hover:text-white z-10",children:(0,mm.jsx)(Am,{className:"w-6 h-6"})}),(0,mm.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Analysis Details"}),(0,mm.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:t.timestamp.toDate().toLocaleString()}),(0,mm.jsx)("div",{className:"rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:(0,mm.jsx)("img",{src:t.imageUrl,alt:"Analyzed chart",className:"w-full h-auto object-contain bg-gray-100 dark:bg-gray-900"})})]}),(0,mm.jsxs)("div",{className:"space-y-4",children:[(0,mm.jsx)(s,{title:"Sentiment",value:t.analysis.sentiment,icon:"Bullish"===t.analysis.sentiment?(0,mm.jsx)($m,{className:"w-6 h-6"}):(0,mm.jsx)(qm,{className:"w-6 h-6"}),colorClass:"Bullish"===t.analysis.sentiment?"text-green-500":"text-red-500"}),(0,mm.jsxs)("div",{className:"p-4 rounded-lg bg-gray-100 dark:bg-gray-700/50",children:[(0,mm.jsx)("p",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Rationale"}),(0,mm.jsx)("p",{className:"mt-2 text-sm",children:t.analysis.rationale})]}),(0,mm.jsx)(s,{title:"Entry Position",value:t.analysis.entry,icon:(0,mm.jsx)(Fm,{className:"w-6 h-6"}),colorClass:"text-blue-500"}),(0,mm.jsx)(s,{title:"Stop Loss",value:t.analysis.stopLoss,icon:(0,mm.jsx)(Vm,{className:"w-6 h-6"}),colorClass:"text-orange-500"}),(0,mm.jsx)(s,{title:"Take Profit",value:t.analysis.takeProfit,icon:(0,mm.jsx)(Cm,{className:"w-6 h-6"}),colorClass:"text-purple-500"}),(0,mm.jsxs)("div",{className:"pt-4",children:[(0,mm.jsx)("h4",{className:"font-bold text-lg mb-2",children:"Outcome"}),(0,mm.jsx)("div",{className:"flex-shrink-0 flex gap-2 w-full",children:"pending"===t.outcome?(0,mm.jsxs)(mm.Fragment,{children:[(0,mm.jsx)("button",{onClick:()=>{r(t.id,"tp_hit"),n()},className:"w-full font-semibold py-2 px-3 rounded bg-green-200 text-green-800 hover:bg-green-300 dark:bg-green-900/50 dark:text-green-300 dark:hover:bg-green-900/80 transition",children:"Hit TP"}),(0,mm.jsx)("button",{onClick:()=>{r(t.id,"sl_hit"),n()},className:"w-full font-semibold py-2 px-3 rounded bg-red-200 text-red-800 hover:bg-red-300 dark:bg-red-900/50 dark:text-red-300 dark:hover:bg-red-900/80 transition",children:"Hit SL"}),(0,mm.jsx)("button",{onClick:()=>{r(t.id,"not_taken"),n()},className:"w-full font-semibold py-2 px-3 rounded bg-gray-200 text-gray-800 hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-300 dark:hover:bg-gray-500 transition",children:"Not Taken"})]}):(0,mm.jsx)("div",{className:"text-center w-full font-bold py-2 px-3 rounded "+("tp_hit"===t.outcome?"bg-green-500/20 text-green-500":"sl_hit"===t.outcome?"bg-red-500/20 text-red-500":"bg-gray-500/20 text-gray-500"),children:"tp_hit"===t.outcome?"TP Hit":"sl_hit"===t.outcome?"SL Hit":"Order Not Taken"})})]})]})]})]})})},sy=e=>{let{user:t}=e;const[n,s]=(0,r.useState)(null),[i,a]=(0,r.useState)(null),[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(""),f=(0,r.useRef)(null),[p,g]=(0,r.useState)([]),[m,y]=(0,r.useState)(!0),[v,b]=(0,r.useState)(null),[x,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!t)return;const e=`users/${t.uid}/chart_analyses`,n=Vp(bp(Af(vm,e),_p("timestamp","desc")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));g(t),y(!1)},e=>{console.error("Error fetching analysis history:",e),h("Could not load analysis history."),y(!1)});return()=>n()},[t]);const k=async(e,n)=>{if(!t)return;const r=Rf(vm,`users/${t.uid}/chart_analyses`,e);try{await Mp(r,{outcome:n})}catch(d){console.error("Error updating outcome: ",d)}},_=e=>{let{title:t,value:n,icon:r,colorClass:s}=e;return(0,mm.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg",children:[(0,mm.jsxs)("div",{className:`flex items-center text-sm font-bold ${s}`,children:[r,(0,mm.jsx)("h4",{className:"ml-2 uppercase tracking-wider",children:t})]}),(0,mm.jsx)("p",{className:"mt-2 text-xl font-mono",children:n})]})};return(0,mm.jsxs)("div",{className:"space-y-8 max-w-4xl mx-auto",children:[(0,mm.jsx)(ty,{isOpen:!!x,title:"Delete Analysis",message:"Are you sure you want to permanently delete this analysis and its chart image? This action cannot be undone.",onConfirm:()=>(async e=>{if(t&&e)try{if(e.imageUrl){const t=pm(bm,e.imageUrl);await fm(t)}const n=Rf(vm,`users/${t.uid}/chart_analyses`,e.id);await Fp(n)}catch(d){if("storage/object-not-found"!==d.code)console.error("Error deleting analysis:",d),h("Failed to delete the analysis. Please try again.");else try{const n=Rf(vm,`users/${t.uid}/chart_analyses`,e.id);await Fp(n)}catch(n){console.error("Error deleting firestore doc after storage error:",n)}}finally{w(null)}})(x),onCancel:()=>w(null)}),(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md text-center",children:[(0,mm.jsx)("h2",{className:"text-3xl font-bold mb-2",children:"AI Chart Analyzer"}),(0,mm.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Upload a chart image to get an AI-powered technical analysis."}),(0,mm.jsx)("div",{className:"mt-6 w-full h-80 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center cursor-pointer hover:border-blue-500 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition duration-300",onClick:()=>f.current.click(),children:i?(0,mm.jsx)("img",{src:i,alt:"Chart preview",className:"max-w-full max-h-full object-contain rounded-md"}):(0,mm.jsxs)("div",{className:"text-gray-400 dark:text-gray-500",children:[(0,mm.jsx)(Pm,{className:"w-16 h-16 mx-auto mb-2"}),(0,mm.jsx)("p",{className:"font-semibold",children:"Click to upload or drag & drop"}),(0,mm.jsx)("p",{className:"text-xs mt-1",children:"PNG, JPG, WEBP up to 4MB"})]})}),(0,mm.jsx)("input",{type:"file",ref:f,onChange:e=>{const t=e.target.files[0];if(t){if(t.size>4194304)return void h("Image size cannot exceed 4MB.");h(""),l(null),s(t),a(URL.createObjectURL(t))}},className:"hidden",accept:"image/png, image/jpeg, image/webp"}),i&&(0,mm.jsxs)("button",{onClick:async()=>{if(n&&t){u(!0),h(""),l(null);try{var e,r,s,i,a;const c=pm(bm,`chart_analyses/${t.uid}/${Date.now()}_${n.name}`);await dm(c,n);const u=await hm(c),d=await(o=n,new Promise((e,t)=>{const n=new FileReader;n.readAsDataURL(o),n.onload=()=>e(n.result.split(",")[1]),n.onerror=e=>t(e)})),h='You are an expert technical analyst for financial markets. Analyze the provided chart image and return a JSON object with your findings.\n- "sentiment" should be either "Bullish" or "Bearish".\n- "entry" should suggest a specific price or price range for a potential trade entry.\n- "stopLoss" should suggest a specific price for a stop loss order.\n- "takeProfit" should suggest a specific price for a take profit order.\nProvide a concise rationale for each point. This is for educational purposes ONLY and is NOT financial advice.',f={type:"OBJECT",properties:{sentiment:{type:"STRING",description:"Overall market sentiment (Bullish or Bearish)."},entry:{type:"STRING",description:"Suggested entry price or range."},stopLoss:{type:"STRING",description:"Suggested stop loss price."},takeProfit:{type:"STRING",description:"Suggested take profit price."},rationale:{type:"STRING",description:"Brief rationale for the analysis."}},required:["sentiment","entry","stopLoss","takeProfit","rationale"]},p={contents:[{parts:[{text:"Analyze this financial chart and provide potential trade parameters based on technical patterns."},{inlineData:{mimeType:n.type,data:d}}]}],systemInstruction:{parts:[{text:h}]},generationConfig:{responseMimeType:"application/json",responseSchema:f}},g=`https://generativelanguage.googleapis.com/v1beta/models/${"gemini-2.5-flash-preview-05-20"}:generateContent?key=${"AIzaSyCwiCfrPq6J0deEbYewPDw5bJMgdpJxTag"}`,m=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!m.ok){const e=await m.json();throw console.error("Gemini Vision API Error:",e),new Error(`API error: ${m.statusText}`)}const y=await m.json(),v=null===(e=y.candidates)||void 0===e||null===(r=e[0])||void 0===r||null===(s=r.content)||void 0===s||null===(i=s.parts)||void 0===i||null===(a=i[0])||void 0===a?void 0:a.text;if(!v)throw console.error("Unexpected Vision API response structure:",y),new Error("Invalid response from AI.");const b=JSON.parse(v);l(b);const x=`users/${t.uid}/chart_analyses`;await Up(Af(vm,x),{userId:t.uid,timestamp:Gi.now(),imageUrl:u,analysis:b,outcome:"pending"})}catch(c){console.error("Analysis failed:",c),h(`Analysis failed. ${c.message}. Please try a clearer chart image or try again later.`)}finally{u(!1)}var o}},disabled:c,className:"mt-6 w-full max-w-xs flex items-center justify-center space-x-2 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold py-3 px-4 rounded-md transition duration-300 disabled:opacity-60 disabled:cursor-not-allowed mx-auto transform hover:scale-105",children:[(0,mm.jsx)(Km,{className:"w-5 h-5"}),(0,mm.jsx)("span",{children:c?"Analyzing...":"Analyze Chart"})]})]}),d&&(0,mm.jsxs)("div",{className:"bg-red-100 dark:bg-red-900/50 border-l-4 border-red-500 text-red-700 dark:text-red-300 p-4 rounded-r-lg",role:"alert",children:[(0,mm.jsx)("p",{className:"font-bold",children:"Error"}),(0,mm.jsx)("p",{children:d})]}),c&&(0,mm.jsx)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md text-center",children:(0,mm.jsxs)("div",{className:"animate-pulse flex flex-col items-center space-y-4",children:[(0,mm.jsx)("div",{className:"w-16 h-16 bg-gray-200 dark:bg-gray-700 rounded-full"}),(0,mm.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mt-4"}),(0,mm.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),(0,mm.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full pt-4",children:[(0,mm.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"}),(0,mm.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"}),(0,mm.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"}),(0,mm.jsx)("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"})]})]})}),o&&!c&&(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h3",{className:"text-2xl font-bold mb-6 text-center",children:"Analysis Results"}),(0,mm.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,mm.jsx)(_,{title:"Sentiment",value:o.sentiment,icon:"Bullish"===o.sentiment?(0,mm.jsx)($m,{className:"w-6 h-6"}):(0,mm.jsx)(qm,{className:"w-6 h-6"}),colorClass:"Bullish"===o.sentiment?"text-green-500":"text-red-500"}),(0,mm.jsxs)("div",{className:"md:col-span-1 p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[(0,mm.jsx)("p",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Rationale"}),(0,mm.jsx)("p",{className:"mt-2 text-sm",children:o.rationale})]}),(0,mm.jsx)(_,{title:"Entry Position",value:o.entry,icon:(0,mm.jsx)(Fm,{className:"w-6 h-6"}),colorClass:"text-blue-500"}),(0,mm.jsx)(_,{title:"Stop Loss",value:o.stopLoss,icon:(0,mm.jsx)(Vm,{className:"w-6 h-6"}),colorClass:"text-orange-500"}),(0,mm.jsx)(_,{title:"Take Profit",value:o.takeProfit,icon:(0,mm.jsx)(Cm,{className:"w-6 h-6"}),colorClass:"text-purple-500"})]})]}),(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Analysis History"}),(0,mm.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:m?(0,mm.jsx)("p",{className:"text-center text-gray-500 py-4",children:"Loading history..."}):0===p.length?(0,mm.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No analyses saved yet."}):p.map(e=>(0,mm.jsxs)("div",{className:"relative group",children:[(0,mm.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e)},className:"absolute top-2 left-2 z-10 p-1 bg-gray-600 bg-opacity-50 text-white rounded-full hover:bg-red-500 transition-all opacity-0 group-hover:opacity-100",title:"Delete Analysis",children:(0,mm.jsx)(Am,{className:"w-4 h-4"})}),(0,mm.jsxs)("div",{onClick:()=>b(e),className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 transition",children:[(0,mm.jsxs)("div",{className:"flex items-start gap-4",children:[(0,mm.jsx)("img",{src:e.imageUrl,alt:"Chart thumbnail",className:"w-20 h-20 object-cover rounded-md flex-shrink-0 border border-gray-200 dark:border-gray-600"}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("p",{className:"font-bold",children:new Date(e.timestamp.toDate()).toLocaleDateString()}),(0,mm.jsx)("div",{className:"flex items-center text-sm mt-1",children:(0,mm.jsx)("span",{className:"font-semibold "+("Bullish"===e.analysis.sentiment?"text-green-500":"text-red-500"),children:e.analysis.sentiment})})]})]}),(0,mm.jsx)("div",{className:"flex-shrink-0 w-32 text-right",children:"pending"===e.outcome?(0,mm.jsxs)(mm.Fragment,{children:[(0,mm.jsx)("button",{onClick:t=>{t.stopPropagation(),k(e.id,"tp_hit")},className:"w-full mb-1 text-xs font-semibold py-1 px-3 rounded bg-green-200 text-green-800 hover:bg-green-300 dark:bg-green-900/50 dark:text-green-300 dark:hover:bg-green-900/80 transition",children:"Hit TP"}),(0,mm.jsx)("button",{onClick:t=>{t.stopPropagation(),k(e.id,"sl_hit")},className:"w-full mb-1 text-xs font-semibold py-1 px-3 rounded bg-red-200 text-red-800 hover:bg-red-300 dark:bg-red-900/50 dark:text-red-300 dark:hover:bg-red-900/80 transition",children:"Hit SL"}),(0,mm.jsx)("button",{onClick:t=>{t.stopPropagation(),k(e.id,"not_taken")},className:"w-full text-xs font-semibold py-1 px-3 rounded bg-gray-200 text-gray-800 hover:bg-gray-300 dark:bg-gray-600 dark:text-gray-300 dark:hover:bg-gray-500 transition",children:"Not Taken"})]}):(0,mm.jsx)("div",{className:"text-center font-bold text-sm py-1 px-3 rounded "+("tp_hit"===e.outcome?"bg-green-500/20 text-green-500":"sl_hit"===e.outcome?"bg-red-500/20 text-red-500":"bg-gray-500/20 text-gray-500"),children:"tp_hit"===e.outcome?"TP Hit":"sl_hit"===e.outcome?"SL Hit":"Not Taken"})})]})]},e.id))})]}),v&&(0,mm.jsx)(ry,{item:v,onClose:()=>b(null),onUpdateOutcome:k})]})},iy=e=>{let{user:t,profileData:n}=e;const[s,i]=(0,r.useState)([]),[a,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(""),[h,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(""),[m,y]=(0,r.useState)(!1),v=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=Vp(bp(Af(vm,"community_feed"),_p("createdAt","desc")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));i(t),o(!1)},e=>{console.error("Error fetching posts:",e),o(!1)});return()=>e()},[]);const b=()=>{f(null),g(""),v.current&&(v.current.value="")};return(0,mm.jsxs)("div",{className:"space-y-8",children:[(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Create a New Post"}),(0,mm.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l.trim()&&u.trim()&&!m){y(!0);try{const e=await Up(Af(vm,"community_feed"),{title:l,content:u,authorId:t.uid,authorDisplayName:n.displayName||t.email,createdAt:Gi.now(),likes:[],dislikes:[],commentCount:0,imageUrl:""});let r="";if(h){const t=pm(bm,`community_feed/${e.id}/${h.name}`);await dm(t,h),r=await hm(t),await Mp(e,{imageUrl:r})}c(""),d(""),b()}catch(r){console.error("Error creating post:",r)}finally{y(!1)}}},className:"space-y-4",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"post-title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Title"}),(0,mm.jsx)("input",{id:"post-title",type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"What's on your mind?",className:"mt-1 w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"post-content",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Content"}),(0,mm.jsx)("textarea",{id:"post-content",rows:"5",value:u,onChange:e=>d(e.target.value),placeholder:"Share your thoughts, strategies, or questions with the community...",className:"mt-1 w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,mm.jsxs)("div",{children:[p&&(0,mm.jsxs)("div",{className:"mt-2 relative",children:[(0,mm.jsx)("img",{src:p,alt:"Image preview",className:"max-h-48 rounded-md w-auto"}),(0,mm.jsx)("button",{type:"button",onClick:b,className:"absolute top-2 right-2 bg-black bg-opacity-50 text-white rounded-full p-1 hover:bg-opacity-75",children:(0,mm.jsx)(Am,{className:"w-4 h-4"})})]}),(0,mm.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,mm.jsxs)("button",{type:"button",onClick:()=>v.current.click(),className:"flex items-center space-x-2 text-sm font-semibold text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300",children:[(0,mm.jsx)(Pm,{className:"w-5 h-5"}),(0,mm.jsx)("span",{children:p?"Change Image":"Add Image"})]}),(0,mm.jsx)("input",{type:"file",ref:v,onChange:e=>{const t=e.target.files[0];t&&t.type.startsWith("image/")?(f(t),g(URL.createObjectURL(t))):(f(null),g(""))},className:"hidden",accept:"image/*"})]})]}),(0,mm.jsx)("div",{className:"text-right",children:(0,mm.jsx)("button",{type:"submit",disabled:m,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-md transition disabled:opacity-50",children:m?"Posting...":"Post"})})]})]}),(0,mm.jsxs)("div",{className:"space-y-6",children:[(0,mm.jsx)("h2",{className:"text-2xl font-bold",children:"Community Feed"}),a?(0,mm.jsx)("p",{className:"text-center text-gray-500",children:"Loading posts..."}):s.length>0?s.map(e=>(0,mm.jsx)(ny,{post:e,user:t,profileData:n},e.id)):(0,mm.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No posts yet. Be the first to start a conversation!"})]})]})},ay=e=>{let{onAddTransaction:t}=e;const[n,s]=(0,r.useState)("Buy"),[i,a]=(0,r.useState)(""),o="Buy"===n||"Sell"===n;return(0,mm.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),""===i||isNaN(parseFloat(i)))return void alert("Please enter a valid number for the amount.");let r=parseFloat(i);"Withdrawal"===n?r=-Math.abs(r):"Deposit"===n&&(r=Math.abs(r)),t({type:n,pnl:r}),a(""),s("Buy")},className:"p-6 space-y-4",children:(0,mm.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Type"}),(0,mm.jsxs)("select",{id:"type",value:n,onChange:e=>s(e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[(0,mm.jsx)("option",{children:"Buy"}),(0,mm.jsx)("option",{children:"Sell"}),(0,mm.jsx)("option",{children:"Deposit"}),(0,mm.jsx)("option",{children:"Withdrawal"})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"pnl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:o?"P&L ($)":"Amount ($)"}),(0,mm.jsx)("input",{type:"number",step:"any",id:"pnl",value:i,onChange:e=>a(e.target.value),required:!0,className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 rounded-md"})]}),(0,mm.jsx)("div",{className:"md:pt-6",children:(0,mm.jsx)("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Transaction"})})]})})},oy=e=>{let{transactions:t}=e;const[n,s]=(0,r.useState)(!1),[i,a]=(0,r.useState)([{role:"model",text:"Hello! I'm your AI trading coach. Ask me about your recent performance or how to use the app."}]),[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),d=(0,r.useRef)(null);(0,r.useEffect)(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[i]);return(0,mm.jsxs)(mm.Fragment,{children:[(0,mm.jsx)("button",{onClick:()=>s(!n),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg z-50 transition-transform hover:scale-110","aria-label":"Toggle AI Assistant",children:(0,mm.jsx)(Qm,{className:"w-8 h-8"})}),n&&(0,mm.jsxs)("div",{className:"fixed bottom-24 right-6 w-full max-w-sm h-[60vh] bg-white dark:bg-gray-800 rounded-lg shadow-2xl z-50 flex flex-col border border-gray-200 dark:border-gray-700",children:[(0,mm.jsxs)("header",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,mm.jsx)("h3",{className:"text-lg font-bold",children:"AI Assistant"}),(0,mm.jsx)("button",{onClick:()=>s(!1),className:"text-gray-500 hover:text-gray-800 dark:hover:text-white",children:(0,mm.jsx)(Am,{className:"w-6 h-6"})})]}),(0,mm.jsx)("div",{className:"flex-1 p-4 overflow-y-auto",children:(0,mm.jsxs)("div",{className:"space-y-4",children:[i.map((e,t)=>{return(0,mm.jsxs)("div",{className:"flex items-end gap-2 "+("user"===e.role?"justify-end":""),children:["model"===e.role&&(0,mm.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-teal-500 flex-shrink-0"}),(0,mm.jsx)("div",{className:"max-w-xs md:max-w-sm px-4 py-2 rounded-2xl "+("user"===e.role?"bg-blue-600 text-white rounded-br-none":"bg-gray-200 dark:bg-gray-700 rounded-bl-none"),children:(0,mm.jsx)("p",{className:"text-sm prose prose-sm dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:(n=e.text,n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br />"))}})})]},t);var n}),c&&(0,mm.jsxs)("div",{className:"flex items-end gap-2",children:[(0,mm.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-teal-500 flex-shrink-0"}),(0,mm.jsx)("div",{className:"max-w-xs md:max-w-sm px-4 py-2 rounded-2xl bg-gray-200 dark:bg-gray-700 rounded-bl-none",children:(0,mm.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,mm.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse delay-75"}),(0,mm.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse delay-150"}),(0,mm.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-pulse delay-300"})]})})]}),(0,mm.jsx)("div",{ref:d})]})}),(0,mm.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const n=o.trim();if(!n)return;a(e=>[...e,{role:"user",text:n}]),l(""),u(!0);const r=t.slice(0,20).map(e=>({date:e.date.toDate().toISOString().split("T")[0],type:e.type,pnl:e.pnl,status:e.status,tags:e.tags||[],rating:e.rating||0})),s=`\nBased on my recent trading data below, please answer my question.\n\nMy Recent Trading Data (JSON format):\n${JSON.stringify(r,null,2)}\n\nMy Question:\n"${n}"\n`;try{const e=await wm(s,"You are a friendly and helpful AI assistant and trading coach for a sophisticated \"Trading Journal\" web application. Your dual purpose is to:\n        1. Guide users on how to use the app's features.\n        2. Analyze the user's provided trading data to offer insights on past performance and answer questions about their trading history.\n\n        **App Feature Knowledge:**\n        - **Dashboard Tab**: Main overview page with stats, 'Daily Briefing', 'Consistency Tracker', and 'AI Weekly Review'.\n        - **Journal Tab**: Log trades ('Buy'/'Sell') and transactions ('Deposit'/'Withdrawal'). Shows the 'Equity Curve' chart and 'Transaction History'.\n        - **Analytics Tab**: Deeper insights with charts like 'Performance by Day' and a 'Profit Calculator'.\n        - **Calendar**: On the 'Dashboard', gives a monthly P&L overview.\n\n        **Data Analysis Rules:**\n        - You will be provided with a JSON summary of the user's recent trades.\n        - You can answer questions like \"What was my biggest loss recently?\", \"Am I trading too often?\", \"What patterns do you see in my losing trades based on my tags?\".\n        - Analyze the data provided to identify patterns in P&L, trade types, tags, and ratings.\n\n        **CRITICAL RULES:**\n        1.  **NO FINANCIAL ADVICE:** You MUST NOT provide any financial advice, predict market movements, or tell a user whether they should take a specific future trade. Do not give buy or sell signals. Your analysis is strictly historical, based ONLY on the data provided.\n        2.  **EDUCATE, DON'T RECOMMEND:** If a user asks for a direct trade recommendation (e.g., \"should I buy EUR/USD?\"), politely decline and offer to explain the underlying concepts they should consider when making their own decision.\n        3.  **STAY ON TOPIC:** For general app questions, answer concisely based on the feature summary. If asked something completely unrelated to trading or the app, politely state your purpose.");a(t=>[...t,{role:"model",text:e}])}catch(i){console.error("Chatbot API error:",i),a(e=>[...e,{role:"model",text:"Sorry, I'm having trouble connecting right now. Please try again later."}])}finally{u(!1)}},className:"p-4 border-t border-gray-200 dark:border-gray-700 flex items-center",children:[(0,mm.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"Ask about the app...",className:"w-full bg-gray-100 dark:bg-gray-600 border-transparent rounded-full py-2 px-4 focus:ring-2 focus:ring-blue-500 focus:outline-none",disabled:c}),(0,mm.jsx)("button",{type:"submit",className:"ml-3 text-blue-600 hover:text-blue-500 disabled:opacity-50",disabled:c||!o,children:(0,mm.jsx)(Ym,{className:"w-6 h-6"})})]})]})]})},ly=e=>{let{tags:t,transactions:n,onAddTag:s,onUpdateTag:i,onDeleteTag:a}=e;const[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)("#4A5568"),[d,h]=(0,r.useState)(null),f=(0,r.useMemo)(()=>{const e={};return t.forEach(t=>{e[t.name]=0}),n.forEach(t=>{(t.tags||[]).forEach(t=>{e.hasOwnProperty(t)&&e[t]++})}),e},[t,n]),p=()=>{d&&d.name.trim()&&(i(d.id,d.name.trim(),d.color),h(null))},g=["#EF4444","#F97316","#F59E0B","#EAB308","#84CC16","#22C55E","#10B981","#14B8A6","#06B6D4","#0EA5E9","#3B82F6","#6366F1","#8B5CF6","#A855F7","#D946EF","#EC4899"];return(0,mm.jsxs)("div",{className:"space-y-8",children:[(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Create New Tag"}),(0,mm.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.trim()&&(s(o.trim(),c),l(""),u("#4A5568"))},className:"flex flex-col sm:flex-row items-end gap-4",children:[(0,mm.jsxs)("div",{className:"flex-grow w-full",children:[(0,mm.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Tag Name"}),(0,mm.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"e.g., Breakout",className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Color"}),(0,mm.jsx)("div",{className:"flex flex-wrap items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded-md",children:g.map(e=>(0,mm.jsx)("button",{type:"button",onClick:()=>u(e),className:"w-6 h-6 rounded-full transition-transform hover:scale-125 "+(c===e?"ring-2 ring-offset-2 ring-offset-gray-50 dark:ring-offset-gray-700 ring-blue-500":""),style:{backgroundColor:e}},e))})]}),(0,mm.jsx)("button",{type:"submit",className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-md transition",children:"Add Tag"})]})]}),(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Manage Existing Tags"}),(0,mm.jsx)("div",{className:"max-h-96 overflow-y-auto pr-2",children:(0,mm.jsxs)("div",{className:"space-y-3",children:[t.map(e=>(0,mm.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[(null===d||void 0===d?void 0:d.id)===e.id?(0,mm.jsxs)("div",{className:"flex-grow flex items-center gap-4",children:[(0,mm.jsx)("input",{type:"text",value:d.name,onChange:e=>h({...d,name:e.target.value}),className:"bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md py-1 px-2"}),(0,mm.jsx)("div",{className:"flex items-center gap-1",children:g.slice(0,8).map(e=>(0,mm.jsx)("button",{type:"button",onClick:()=>h({...d,color:e}),className:"w-5 h-5 rounded-full "+(d.color===e?"ring-2 ring-blue-500":""),style:{backgroundColor:e}},e))}),(0,mm.jsx)("button",{onClick:p,className:"text-sm text-green-500 font-semibold",children:"Save"}),(0,mm.jsx)("button",{onClick:()=>h(null),className:"text-sm text-gray-500",children:"Cancel"})]}):(0,mm.jsxs)("div",{className:"flex items-center",children:[(0,mm.jsx)("span",{className:"font-semibold px-3 py-1 rounded-full text-sm text-white",style:{backgroundColor:e.color},children:e.name}),(0,mm.jsxs)("span",{className:"text-sm text-gray-400 ml-4",children:[f[e.name]||0," uses"]})]}),(null===d||void 0===d?void 0:d.id)!==e.id&&(0,mm.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,mm.jsx)("button",{onClick:()=>h({...e}),className:"text-gray-400 hover:text-blue-500",children:"Edit"}),(0,mm.jsx)("button",{onClick:()=>a(e.id),className:"text-gray-400 hover:text-red-500",children:(0,mm.jsx)(Em,{className:"w-4 h-4"})})]})]},e.id)),0===t.length&&(0,mm.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No tags created yet."})]})})]})]})},cy=e=>{let{title:t,value:n,icon:r,valueColor:s,subValue:i}=e;return(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md flex items-center transition-colors duration-300",children:[(0,mm.jsx)("div",{className:"p-3 bg-gray-100 dark:bg-gray-700 rounded-full mr-4",children:r}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t}),(0,mm.jsx)("p",{className:`text-xl font-bold ${s}`,children:n}),i&&(0,mm.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:i})]})]})},uy=e=>{var t;let{transactions:n,startingEquity:s}=e;const i=(0,r.useRef)(null),[a,o]=(0,r.useState)(null),l=(0,r.useMemo)(()=>{if(!n)return[];const e=[...n].sort((e,t)=>e.date.toDate()-t.date.toDate());let t=s;const r=[{date:null,equity:s}];return e.forEach(e=>{t+=e.pnl,r.push({date:e.date.toDate(),equity:t})}),r},[n,s]),{width:c,height:u,margin:d,xScale:h,yScale:f,equityPath:p,gridLines:g,xTicks:m}=(0,r.useMemo)(()=>{const e=i.current?i.current.offsetWidth:500,t=i.current?i.current.offsetHeight:300,n={top:20,right:20,bottom:40,left:60},r=e-n.left-n.right,s=t-n.top-n.bottom,a=l.map(e=>e.equity),o=Math.min(...a),c=Math.max(...a),u=e=>n.left+e/(l.length-1)*r,d=e=>n.top+s-(e-o)/(c-o||1)*s,h=l.map((e,t)=>`${0===t?"M":"L"} ${u(t)} ${d(e.equity)}`).join(" "),f=Array.from({length:5}).map((e,t)=>{const n=o+t/4*(c-o);return{y:d(n),label:km(n)}}),p=l.length>1?Math.min(l.length-1,7):1,g=Array.from({length:p}).map((e,t)=>{var n;const r=l.length>1?Math.floor(t*(l.length-1)/(p-1)):0,s=null===(n=l[r+1])||void 0===n?void 0:n.date;return{x:u(r+1),label:s?s.toLocaleDateString("en-US",{month:"short",day:"numeric"}):""}});return{width:e,height:t,margin:n,xScale:u,yScale:d,equityPath:h,gridLines:f,xTicks:g}},[l,null===(t=i.current)||void 0===t?void 0:t.offsetWidth]);if(l.length<2)return(0,mm.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500 dark:text-gray-400",children:"Not enough data to display chart for the selected period."});return(0,mm.jsxs)("div",{className:"w-full h-full relative",ref:i,children:[(0,mm.jsxs)("svg",{width:"100%",height:"100%",onMouseMove:e=>{const t=i.current.getBoundingClientRect(),n=e.clientX-t.left,r=Math.round((n-d.left)/(c-d.left-d.right)*(l.length-1));if(r>=0&&r<l.length){const n=l[r];o({x:h(r),y:e.clientY-t.top,data:n})}},onMouseLeave:()=>o(null),children:[(0,mm.jsx)("g",{className:"grid-lines",children:g.map((e,t)=>(0,mm.jsxs)("g",{children:[(0,mm.jsx)("line",{x1:d.left,y1:e.y,x2:c-d.right,y2:e.y,stroke:"currentColor",className:"text-gray-200 dark:text-gray-700",strokeWidth:"1"}),(0,mm.jsx)("text",{x:d.left-10,y:e.y,dy:"0.32em",textAnchor:"end",className:"text-xs fill-current text-gray-500 dark:text-gray-400",children:e.label})]},t))}),(0,mm.jsx)("g",{className:"x-axis-ticks",children:m.map((e,t)=>(0,mm.jsx)("text",{x:e.x,y:u-d.bottom+15,textAnchor:"middle",className:"text-xs fill-current text-gray-500 dark:text-gray-400",children:e.label},t))}),(0,mm.jsx)("path",{d:p,fill:"none",stroke:"#A0AEC0",strokeWidth:"2"}),a&&(0,mm.jsx)("g",{children:(0,mm.jsx)("line",{x1:a.x,y1:d.top,x2:a.x,y2:u-d.bottom,stroke:"currentColor",className:"text-gray-400 dark:text-gray-500",strokeWidth:"1",strokeDasharray:"4,2"})})]}),a&&(0,mm.jsxs)("div",{className:"absolute p-2 text-xs bg-white dark:bg-gray-900 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 pointer-events-none",style:{left:`${a.x+10}px`,top:`${a.y+10}px`,transform:"translateY(-100%)"},children:[(0,mm.jsx)("p",{className:"font-bold",children:a.data.date?a.data.date.toLocaleDateString():"Start"}),(0,mm.jsxs)("p",{children:[(0,mm.jsx)("span",{className:"font-semibold text-gray-500",children:"Equity:"})," ",km(a.data.equity)]})]}),(0,mm.jsx)("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 flex space-x-4 text-xs",children:(0,mm.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,mm.jsx)("div",{className:"w-3 h-3 rounded-full bg-[#A0AEC0]"}),(0,mm.jsx)("span",{children:"Equity"})]})})]})},dy=e=>{let{trade:t,user:n,allTags:s,onAddNewTag:i,onSave:a,onCancel:o}=e;const[l,c]=(0,r.useState)(new Date(t.date.toDate()).toISOString().split("T")[0]),[u,d]=(0,r.useState)(t.type),[h,f]=(0,r.useState)(t.pnl),[p,g]=(0,r.useState)(t.notes||""),[m,y]=(0,r.useState)(t.tags||[]),[v,b]=(0,r.useState)(t.rating||0),[x,w]=(0,r.useState)(null),[k,_]=(0,r.useState)(!1),[N,E]=(0,r.useState)(t.imageUrl||""),[S,T]=(0,r.useState)(""),C=r.useRef(null),[I,j]=(0,r.useState)(""),[A,R]=(0,r.useState)(!1),[D,P]=(0,r.useState)(""),[L,O]=(0,r.useState)(""),M="Buy"===u||"Sell"===u,F=e=>{y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,mm.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-2xl max-h-full overflow-y-auto",children:[(0,mm.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,mm.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Transaction Details & Edit"}),(0,mm.jsx)("button",{onClick:o,className:"text-gray-500 hover:text-gray-800 dark:hover:text-white",children:(0,mm.jsx)(Am,{className:"w-6 h-6"})})]}),(0,mm.jsxs)("div",{className:"space-y-6",children:[(0,mm.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"edit-date",className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Date"}),(0,mm.jsx)("input",{id:"edit-date",type:"date",value:l,onChange:e=>c(e.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"edit-type",className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Type"}),(0,mm.jsxs)("select",{id:"edit-type",value:u,onChange:e=>d(e.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[(0,mm.jsx)("option",{children:"Buy"}),(0,mm.jsx)("option",{children:"Sell"}),(0,mm.jsx)("option",{children:"Deposit"}),(0,mm.jsx)("option",{children:"Withdrawal"})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"edit-pnl",className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:M?"P&L ($)":"Amount ($)"}),(0,mm.jsx)("input",{id:"edit-pnl",type:"number",step:"any",value:h,onChange:e=>f(e.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"})]})]}),M&&(0,mm.jsxs)(mm.Fragment,{children:[(0,mm.jsx)("hr",{className:"border-gray-200 dark:border-gray-700"}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Chart Screenshot"}),(0,mm.jsxs)("div",{className:"w-full p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-center",children:[N&&!x&&(0,mm.jsx)("img",{src:N,alt:"Trade Screenshot",className:"max-h-64 mx-auto rounded-md"}),x&&(0,mm.jsx)("img",{src:URL.createObjectURL(x),alt:"Preview",className:"max-h-64 mx-auto rounded-md"}),!N&&!x&&(0,mm.jsxs)("div",{className:"text-gray-400 flex flex-col items-center justify-center h-48",children:[(0,mm.jsx)(Pm,{className:"w-16 h-16 mb-2"}),(0,mm.jsx)("p",{children:"No image uploaded"})]}),(0,mm.jsxs)("div",{className:"flex justify-center items-center space-x-4 mt-4",children:[(0,mm.jsx)("button",{onClick:()=>C.current.click(),className:"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-bold py-2 px-4 rounded-md transition",children:N||x?"Change Image":"Select Image"}),(N||x)&&(0,mm.jsx)("button",{onClick:()=>{w(null),E(""),C.current&&(C.current.value="")},className:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-md transition",children:"Remove"})]}),(0,mm.jsx)("input",{type:"file",accept:"image/*",ref:C,onChange:e=>w(e.target.files[0]),className:"hidden"})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"notes",className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Notes & Trade Rationale"}),(0,mm.jsx)("textarea",{id:"notes",value:p,onChange:e=>g(e.target.value),rows:"5",placeholder:"Write your analysis, entry reasons, and lessons learned...",className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"})]}),(0,mm.jsxs)("div",{className:"space-y-2",children:[(0,mm.jsxs)("button",{onClick:async()=>{if(!p)return void P("Please write some notes about your trade before analyzing.");R(!0),P(""),j("");const e=`\n            Please analyze my trade:\n            - Trade Type: ${u}\n            - Profit/Loss: ${km(h)} (${h>=0?"Win":"Loss"})\n            - My Tags: ${m||"None"}\n            - My Rating: ${v}/5\n            - My Notes: "${p}"\n        `;try{const t=await wm(e,"You are a professional trading coach. Analyze the following trade journal entry. The user will provide the trade type, P&L, and their personal notes. Your task is to:\n1.  Provide constructive feedback on their rationale.\n2.  Identify potential psychological biases (like FOMO, revenge trading, confirmation bias) based on their notes.\n3.  Offer actionable advice for future trades.\n4.  Do NOT give financial advice. Focus on the process, psychology, and execution based ONLY on the information provided.\n5.  Keep your analysis concise, empathetic, and encouraging. Use markdown for formatting. Start with a brief summary of the trade.");j(t)}catch(t){console.error("AI Analysis Error:",t),P("Sorry, the AI analysis failed. Please try again later.")}finally{R(!1)}},disabled:A,className:"w-full flex items-center justify-center space-x-2 bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700 text-white font-bold py-2 px-4 rounded-md transition duration-300 disabled:opacity-60",children:[(0,mm.jsx)(Km,{className:"w-5 h-5"}),(0,mm.jsx)("span",{children:A?"Analyzing...":"\u2728 Get AI Trade Analysis"})]}),D&&(0,mm.jsx)("p",{className:"text-red-500 text-sm text-center",children:D}),A&&(0,mm.jsx)("div",{className:"text-center text-sm text-gray-500 dark:text-gray-400",children:"The AI coach is reviewing your trade..."}),I&&(0,mm.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700 mt-2",children:[(0,mm.jsxs)("h4",{className:"font-bold text-md mb-2 text-gray-800 dark:text-gray-200 flex items-center",children:[(0,mm.jsx)(Km,{className:"w-5 h-5 mr-2 text-purple-500"})," AI Coach Feedback"]}),(0,mm.jsx)("div",{className:"prose prose-sm dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:I.replace(/\n/g,"<br />")}})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Tags"}),(0,mm.jsxs)("div",{className:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg flex flex-wrap gap-2",children:[s.map(e=>(0,mm.jsx)("button",{type:"button",onClick:()=>F(e.name),className:"px-3 py-1 rounded-full text-sm font-semibold transition-all duration-200 "+(m.includes(e.name)?"text-white shadow-md":"opacity-70 hover:opacity-100"),style:{backgroundColor:m.includes(e.name)?e.color:e.color+"40",color:m.includes(e.name)?"#fff":"#E2E8F0"},children:e.name},e.id)),0===s.length&&(0,mm.jsx)("p",{className:"text-xs text-gray-400",children:"No tags created. Go to the 'Tags' tab to add some."})]}),(0,mm.jsxs)("div",{className:"flex items-center mt-2",children:[(0,mm.jsx)("input",{type:"text",value:L,onChange:e=>O(e.target.value),placeholder:"Or create a new tag...",className:"flex-grow bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-l-md py-1 px-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"}),(0,mm.jsx)("button",{onClick:()=>{if(L.trim()&&!s.find(e=>e.name.toLowerCase()===L.trim().toLowerCase())){const e=["#EF4444","#F97316","#10B981","#3B82F6","#8B5CF6","#EC4899"],t=e[Math.floor(Math.random()*e.length)];i(L.trim(),t),F(L.trim()),O("")}},type:"button",className:"bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-sm font-semibold py-1 px-3 rounded-r-md",children:"Add"})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Execution Rating"}),(0,mm.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,mm.jsx)("button",{onClick:()=>b(e),className:"text-yellow-400 hover:text-yellow-500 transition",children:(0,mm.jsx)(jm,{className:"w-8 h-8",filled:e<=v})},e))})]})]})]}),S&&(0,mm.jsx)("p",{className:"text-red-500 text-sm mt-4 text-center bg-red-500/10 p-2 rounded-md",children:S}),(0,mm.jsx)("div",{className:"mt-8 flex justify-end",children:(0,mm.jsx)("button",{onClick:async()=>{if(n){_(!0),T("");try{let r=N;if(x){if(t.imageUrl)try{const e=pm(bm,t.imageUrl);await fm(e)}catch(e){console.warn("Could not delete old image, continuing with upload:",e)}const s=pm(bm,`screenshots/${n.uid}/${t.id}/${x.name}`),i=await dm(s,x);r=await hm(i.ref)}else if(!N&&t.imageUrl)try{const e=pm(bm,t.imageUrl);await fm(e),r=""}catch(e){return console.error("Failed to delete image from storage:",e),T(`Could not remove image. (Code: ${e.code||"unknown"})`),void _(!1)}let s=parseFloat(h);if(isNaN(s))throw new Error("P&L must be a number.");if(!l)throw new Error("Date cannot be empty.");"Withdrawal"===u?s=-Math.abs(s):"Deposit"===u&&(s=Math.abs(s));const i=M?s>=0?"Win":"Loss":null,c={...t,date:Gi.fromDate(new Date(l)),type:u,pnl:s,status:i,notes:p,tags:m,rating:v,imageUrl:r};await a(c),o()}catch(r){console.error("Detailed error during save:",r),T(`Save failed. Check console for details. (Code: ${r.code||"unknown"})`)}finally{_(!1)}}else T("Authentication error. Please log out and log in again.")},disabled:k,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-md transition disabled:opacity-50",children:k?"Saving...":"Save Changes"})})]})})},hy=e=>{let{currentPage:t,totalPages:n,onPageChange:r}=e;const s=Array.from({length:n},(e,t)=>t+1);return n<=1?null:(0,mm.jsxs)("div",{className:"flex justify-center items-center space-x-2 mt-6",children:[(0,mm.jsx)("button",{onClick:()=>r(t-1),disabled:1===t,className:"px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"\xab"}),s.map(e=>(0,mm.jsx)("button",{onClick:()=>r(e),className:"px-3 py-1 rounded-md "+(t===e?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700"),children:e},e)),(0,mm.jsx)("button",{onClick:()=>r(t+1),disabled:t===n,className:"px-3 py-1 rounded-md bg-gray-200 dark:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"\xbb"})]})},fy=e=>{let{data:t}=e;const n=t.reduce((e,t)=>e+t.value,0);if(0===n)return(0,mm.jsx)("div",{className:"flex items-center justify-center h-full w-full text-gray-500",children:"No data"});const r=2*Math.PI*40;let s=0;return(0,mm.jsx)("svg",{viewBox:"0 0 100 100",className:"w-full h-full transform -rotate-90",children:t.map(e=>{const t=r-e.value/n*r,i=(0,mm.jsx)("circle",{cx:"50",cy:"50",r:40,fill:"transparent",stroke:e.color,strokeWidth:10,strokeDasharray:r,strokeDashoffset:t,transform:`rotate(${s/n*360} 50 50)`},e.label);return s+=e.value,i})})},py=e=>{let{status:t}=e;const n={className:"w-3 h-3 absolute top-1 left-1"};switch(t){case"PROFIT_TARGET_HIT":case"DISCIPLINED_WIN":case"DISCIPLINED_LOSS":return(0,mm.jsx)(Fm,{...n,style:{color:"#48bb78"}});case"OVERTRADED_WIN":case"OVERTRADED_LOSS":return(0,mm.jsx)(Um,{...n,style:{color:"#f59e0b"}});case"LOSS_LIMIT_HIT":return(0,mm.jsx)(Vm,{...n,style:{color:"#ef4444"}});default:return null}},gy=e=>{let{transactions:t,currentDate:n,setCurrentDate:s,onDayClick:i,dailyJournals:a,consistencyByDay:o}=e;const l=n.getFullYear(),c=n.getMonth(),u=(0,r.useMemo)(()=>{const e={};return t.forEach(t=>{if("Buy"===t.type||"Sell"===t.type){const n=t.date.toDate(),r=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`;e[r]||(e[r]={pnl:0,count:0}),e[r].pnl+=t.pnl,e[r].count++}}),e},[t]),d=(0,r.useMemo)(()=>{const e=[],t=new Date(l,c,1);t.setDate(t.getDate()-t.getDay());for(let n=0;n<42;n++)e.push(new Date(t)),t.setDate(t.getDate()+1);return e},[l,c]),h=(0,r.useMemo)(()=>{const e=[];for(let t=0;t<d.length;t+=7)e.push(d.slice(t,t+7));return e},[d]),f=e=>s(new Date(l,c+e,1));return(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,mm.jsx)("button",{onClick:()=>f(-1),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,mm.jsx)(Lm,{className:"w-6 h-6"})}),(0,mm.jsxs)("h2",{className:"text-xl font-bold",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][c]," ",l]}),(0,mm.jsx)("button",{onClick:()=>f(1),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,mm.jsx)(Om,{className:"w-6 h-6"})})]}),(0,mm.jsx)("div",{className:"grid grid-cols-7 gap-1 text-center text-xs font-semibold text-gray-500 dark:text-gray-400",children:["Sun","Mon","Tue","Wed","Thu","Fri","Weekly"].map(e=>(0,mm.jsx)("div",{children:e},e))}),(0,mm.jsx)("div",{className:"mt-2 space-y-1",children:h.map((e,t)=>{const n=e.reduce((e,t)=>{var n;const r=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return e+((null===(n=u[r])||void 0===n?void 0:n.pnl)||0)},0);return(0,mm.jsx)("div",{className:"grid grid-cols-7 gap-1",children:e.map((e,r)=>{if(6===r){const e=n>=0?"bg-green-500/10 dark:bg-green-900/30":"bg-red-500/10 dark:bg-red-900/30",r=n>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400";return(0,mm.jsxs)("div",{className:`p-1 rounded-lg text-center h-20 flex flex-col justify-center items-center transition-colors ${e}`,children:[(0,mm.jsx)("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",children:"Weekly P&L"}),(0,mm.jsx)("span",{className:`mt-1 text-sm font-bold ${r}`,children:km(n)})]},`weekly-${t}`)}const s=e.getDate(),l=e.getMonth()===c,d=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(s).padStart(2,"0")}`,h=u[d],f=a[d]&&(a[d].notes||a[d].rating>0||a[d].bias),p=o[d],g=(new Date).toDateString()===e.toDateString();let m="hover:bg-gray-100 dark:hover:bg-gray-700/50";h&&(m=h.pnl>=0?"bg-green-500/20 hover:bg-green-500/30":"bg-red-500/20 hover:bg-red-500/30");const y=l?"text-gray-800 dark:text-white":"text-gray-400 dark:text-gray-500";return(0,mm.jsxs)("div",{className:`p-1 rounded-lg text-center h-20 flex flex-col justify-start items-center transition-colors cursor-pointer relative ${m}`,onClick:()=>i(e),children:[(0,mm.jsx)(py,{status:p}),f&&(0,mm.jsx)(Im,{className:"w-3 h-3 text-blue-500 absolute top-1 right-1"}),(0,mm.jsx)("span",{className:`w-6 h-6 flex items-center justify-center rounded-full text-sm ${g?"bg-blue-600 text-white":y}`,children:s}),h&&(0,mm.jsxs)("div",{className:"text-center mt-1",children:[(0,mm.jsx)("span",{className:"text-xs font-bold "+(h.pnl>=0?"text-green-500":"text-red-500"),children:km(h.pnl).replace(/\..*/,"")}),(0,mm.jsxs)("span",{className:"block text-gray-400 text-[10px]",children:[h.count," trade",h.count>1?"s":""]})]})]},e.toISOString())})},t)})}),(0,mm.jsxs)("div",{className:"mt-4 flex justify-center items-center space-x-4 text-xs text-gray-500 dark:text-gray-400",children:[(0,mm.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,mm.jsx)(Fm,{className:"w-4 h-4 text-green-500"}),(0,mm.jsx)("span",{children:"Disciplined"})]}),(0,mm.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,mm.jsx)(Um,{className:"w-4 h-4 text-yellow-500"}),(0,mm.jsx)("span",{children:"Overtraded"})]}),(0,mm.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,mm.jsx)(Vm,{className:"w-4 h-4 text-red-500"}),(0,mm.jsx)("span",{children:"Loss Exceeded"})]})]})]})},my=e=>{let{dayPerformance:t}=e;const[n,s]=(0,r.useState)(null),i=(0,r.useRef)(null),a=e=>{let{day:t,data:n,maxValue:s,color:a,onHover:o}=e;const l=s>0?Math.abs(n.pnl)/s*100:0,c=(0,r.useRef)(null);return(0,mm.jsxs)("div",{className:"flex flex-col items-center h-full",onMouseEnter:()=>{if(c.current){const e=c.current.getBoundingClientRect(),r=i.current.getBoundingClientRect();o({day:t,data:n,x:e.left-r.left+e.width/2,y:e.top-r.top})}},ref:c,children:[(0,mm.jsx)("div",{className:"w-full h-full flex items-end justify-center",children:(0,mm.jsx)("div",{className:`w-10 rounded-t-md transition-all duration-300 hover:opacity-80 ${a}`,style:{height:`${l}%`}})}),(0,mm.jsx)("span",{className:"text-xs mt-1 flex-shrink-0",children:t.substring(0,3)})]})},o=Math.max(.01,...Object.values(t).map(e=>Math.abs(e.pnl)));return(0,mm.jsxs)("div",{className:"relative h-full",ref:i,onMouseLeave:()=>{s(null)},children:[(0,mm.jsx)("div",{className:"grid grid-cols-7 gap-2 h-full",children:Object.entries(t).map(e=>{let[t,n]=e;return(0,mm.jsx)(a,{day:t,data:n,maxValue:o,color:n.pnl>=0?"bg-green-500":"bg-red-500",onHover:s},t)})}),n&&n.data.count>0&&(0,mm.jsxs)("div",{className:"absolute p-3 bg-white dark:bg-gray-900 rounded-lg shadow-2xl border border-gray-200 dark:border-gray-700 pointer-events-none z-10 w-48 text-xs transition-opacity duration-200",style:{left:`${n.x}px`,top:`${n.y}px`,transform:"translate(-50%, -110%)",opacity:1},children:[(0,mm.jsx)("h4",{className:"font-bold text-center mb-2 border-b border-gray-200 dark:border-gray-700 pb-1",children:n.day}),(0,mm.jsxs)("div",{className:"space-y-1",children:[(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Net P&L:"})," ",(0,mm.jsx)("span",{className:"font-bold "+(n.data.pnl>=0?"text-green-500":"text-red-500"),children:km(n.data.pnl)})]}),(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Win Rate:"})," ",(0,mm.jsxs)("span",{className:"font-bold",children:[(n.data.count>0?n.data.wins/n.data.count*100:0).toFixed(1),"%"]})]}),(0,mm.jsx)("hr",{className:"border-gray-200 dark:border-gray-600 my-1"}),(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Wins:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-green-500",children:n.data.wins})]}),(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Losses:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-red-500",children:n.data.losses})]}),(0,mm.jsx)("hr",{className:"border-gray-200 dark:border-gray-600 my-1"}),(0,mm.jsxs)("p",{className:"flex justify-between items-center",children:[(0,mm.jsx)("span",{children:"Avg. Rating:"}),(0,mm.jsxs)("span",{className:"font-semibold flex items-center",children:[n.data.ratedTrades>0?(n.data.totalRating/n.data.ratedTrades).toFixed(1):"N/A",n.data.ratedTrades>0&&(0,mm.jsx)(jm,{filled:!0,className:"w-4 h-4 ml-1 text-yellow-400"})]})]})]})]})]})},yy=e=>{let{stats:t}=e;const{tagPerformance:n,streaks:r,avgWinLossRatio:s,ratingPerformance:i,drawdown:a,winRate:o,totalTrades:l}=t,c=100*o;let u="N/A",d="Record at least 10 trades to receive a suggestion.";return l>=10&&(c>=50?(u="1 : 2",d="With your current win rate, targeting a 1:2 Risk/Reward ratio on trades can be an effective strategy for profitability."):c>=33?(u="1 : 3",d="To maintain profitability with this win rate, it is advisable to aim for a minimum Risk/Reward ratio of 1:3."):(u="1 : 3+",d="Your win rate is below 33%. Focus on improving your strategy or only taking trades with a very high Risk/Reward ratio.")),(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h2",{className:"text-xl font-bold mb-4 text-center",children:"Advanced Analytics Dashboard"}),(0,mm.jsxs)("div",{className:"space-y-6",children:[(0,mm.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,mm.jsxs)("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[(0,mm.jsx)("h3",{className:"font-bold text-lg mb-4 text-center",children:"Tag Performance Leaderboard"}),(0,mm.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("h4",{className:"font-semibold text-green-500 mb-2 text-center",children:"Best Strategies"}),(0,mm.jsx)("ul",{className:"space-y-2 text-sm",children:n.top3.length>0?n.top3.map((e,t)=>{const n=t<3?["text-yellow-400","text-gray-400","text-orange-400"][t]:"text-gray-500";return(0,mm.jsxs)("li",{className:"flex items-center justify-between p-2 rounded-md bg-white dark:bg-gray-800 shadow-sm",children:[(0,mm.jsxs)("div",{className:"flex items-center gap-2",children:[(0,mm.jsx)("span",{className:`font-black text-lg w-6 text-center ${n}`,children:t+1}),(0,mm.jsx)("span",{className:"bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 px-2 py-1 rounded font-semibold",children:e.name})]}),(0,mm.jsx)("span",{className:"font-mono font-semibold text-green-500",children:km(e.pnl)})]},e.name)}):(0,mm.jsx)("li",{className:"text-center text-gray-500 p-4",children:"No winning tags yet."})})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("h4",{className:"font-semibold text-red-500 mb-2 text-center",children:"Biggest Mistakes"}),(0,mm.jsx)("ul",{className:"space-y-2 text-sm",children:n.bottom3.length>0?n.bottom3.map((e,t)=>{const n=t<3?["text-yellow-400","text-gray-400","text-orange-400"][t]:"text-gray-500";return(0,mm.jsxs)("li",{className:"flex items-center justify-between p-2 rounded-md bg-white dark:bg-gray-800 shadow-sm",children:[(0,mm.jsxs)("div",{className:"flex items-center gap-2",children:[(0,mm.jsx)("span",{className:`font-black text-lg w-6 text-center ${n}`,children:t+1}),(0,mm.jsx)("span",{className:"bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 px-2 py-1 rounded font-semibold",children:e.name})]}),(0,mm.jsx)("span",{className:"font-mono font-semibold text-red-500",children:km(e.pnl)})]},e.name)}):(0,mm.jsx)("li",{className:"text-center text-gray-500 p-4",children:"No losing tags yet."})})]})]})]}),(0,mm.jsxs)("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[(0,mm.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Execution & Drawdown"}),(0,mm.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,mm.jsxs)("div",{className:"flex justify-between items-center",children:[(0,mm.jsx)("span",{children:"P&L on 5-Star Trades"}),(0,mm.jsx)("span",{className:"font-semibold "+(i.pnlByRating5>=0?"text-green-500":"text-red-500"),children:km(i.pnlByRating5)})]}),(0,mm.jsxs)("div",{className:"flex justify-between items-center",children:[(0,mm.jsx)("span",{children:"P&L on 1-Star Trades"}),(0,mm.jsx)("span",{className:"font-semibold "+(i.pnlByRating1>=0?"text-green-500":"text-red-500"),children:km(i.pnlByRating1)})]}),(0,mm.jsx)("hr",{className:"my-2 border-gray-200 dark:border-gray-700"}),(0,mm.jsxs)("div",{className:"flex justify-between items-center",children:[(0,mm.jsx)("span",{children:"Maximum Drawdown"}),(0,mm.jsx)("span",{className:"font-semibold text-red-500",children:km(a.maxDrawdownValue)})]}),(0,mm.jsxs)("div",{className:"flex justify-between items-center text-xs text-gray-500 dark:text-gray-400",children:[(0,mm.jsx)("span",{}),(0,mm.jsxs)("span",{children:["(",a.maxDrawdownPercent.toFixed(2),"%)"]})]}),(0,mm.jsxs)("div",{className:"flex justify-between items-center",children:[(0,mm.jsx)("span",{children:"Longest Drawdown Period"}),(0,mm.jsxs)("span",{className:"font-semibold",children:[a.longestDrawdownDuration," trades"]})]})]})]})]}),(0,mm.jsxs)("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[(0,mm.jsx)("h3",{className:"font-bold text-lg mb-4 text-center",children:"Risk/Reward Suggestion"}),(0,mm.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-center items-center",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Overall Win Rate"}),(0,mm.jsxs)("p",{className:"font-bold text-4xl text-blue-500",children:[c.toFixed(1),"%"]})]}),(0,mm.jsxs)("div",{className:"bg-blue-100 dark:bg-blue-900/50 p-3 rounded-lg",children:[(0,mm.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:"Suggested Minimum R:R"}),(0,mm.jsx)("p",{className:"font-bold text-4xl text-blue-700 dark:text-blue-200",children:u})]}),(0,mm.jsx)("div",{className:"md:col-span-2 mt-2",children:(0,mm.jsx)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:d})})]})]})]})]})},vy=e=>{var t,n,s,i,a;let{date:o,transactions:l,onClose:c,onTradeClick:u,dailyJournals:d,onSaveJournal:h}=e;const f=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`,[p,g]=(0,r.useState)((null===(t=d[f])||void 0===t?void 0:t.notes)||""),[m,y]=(0,r.useState)((null===(n=d[f])||void 0===n?void 0:n.rating)||0),[v,b]=(0,r.useState)((null===(s=d[f])||void 0===s?void 0:s.biasOutcome)||null),x=(0,r.useMemo)(()=>o?l.filter(e=>{const t=e.date.toDate();return t.getFullYear()===o.getFullYear()&&t.getMonth()===o.getMonth()&&t.getDate()===o.getDate()}).sort((e,t)=>e.date.toDate()-t.date.toDate()):[],[l,o]),w=new Intl.DateTimeFormat("en-US",{dateStyle:"full"}).format(o),k=null===(i=d[f])||void 0===i?void 0:i.bias,_=null===(a=d[f])||void 0===a?void 0:a.reason;return(0,mm.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-2xl max-h-full overflow-y-auto",children:[(0,mm.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Daily Details"}),(0,mm.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:w})]}),(0,mm.jsx)("button",{onClick:c,className:"text-gray-500 hover:text-gray-800 dark:hover:text-white",children:(0,mm.jsx)(Am,{className:"w-6 h-6"})})]}),(0,mm.jsxs)("div",{className:"space-y-6",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Today's Transaction History"}),(0,mm.jsx)("div",{className:"space-y-2",children:x.length>0?x.map(e=>(0,mm.jsxs)("div",{onClick:()=>u(e),className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("span",{className:"font-semibold "+("Buy"===e.type?"text-green-500":"Sell"===e.type?"text-red-500":"Deposit"===e.type?"text-blue-500":"text-orange-500"),children:e.type}),(0,mm.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:e.date.toDate().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),(0,mm.jsxs)("div",{className:"flex items-center",children:[(0,mm.jsx)("span",{className:"font-semibold "+(e.pnl>=0?"text-green-500":"text-red-500"),children:km(e.pnl)}),(e.notes||e.tags&&e.tags.length>0||e.rating>0)&&(0,mm.jsx)(Im,{className:"w-4 h-4 text-blue-500 ml-3"})]})]},e.id)):(0,mm.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No transactions on this day."})})]}),(0,mm.jsx)("hr",{className:"border-gray-200 dark:border-gray-700"}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Daily Journal & Bias"}),k&&(0,mm.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[(0,mm.jsxs)("p",{className:"text-sm font-bold text-gray-600 dark:text-gray-400",children:["Daily Bias: ",(0,mm.jsx)("span",{className:"bullish"===k?"text-green-500":"text-red-500",children:k.charAt(0).toUpperCase()+k.slice(1)})]}),(0,mm.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-300 mt-1",children:["Reason: ",_||"No reason provided."]}),(0,mm.jsxs)("div",{className:"mt-2",children:[(0,mm.jsx)("span",{className:"text-sm font-bold text-gray-600 dark:text-gray-400 mr-3",children:"Bias Outcome:"}),(0,mm.jsx)("button",{onClick:()=>b("correct"),className:"px-2 py-1 text-xs rounded "+("correct"===v?"bg-green-500 text-white":"bg-gray-200 dark:bg-gray-600"),children:"Correct"}),(0,mm.jsx)("button",{onClick:()=>b("incorrect"),className:"ml-2 px-2 py-1 text-xs rounded "+("incorrect"===v?"bg-red-500 text-white":"bg-gray-200 dark:bg-gray-600"),children:"Incorrect"})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"daily-notes",className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Today's Evaluation Notes"}),(0,mm.jsx)("textarea",{id:"daily-notes",value:p,onChange:e=>g(e.target.value),rows:"5",placeholder:"How was your trading performance today? What went well? What could be improved?",className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:outline-none"})]}),(0,mm.jsxs)("div",{className:"mt-4",children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Rate Today's Performance"}),(0,mm.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,mm.jsx)("button",{onClick:()=>y(e),className:"text-yellow-400 hover:text-yellow-500 transition",children:(0,mm.jsx)(jm,{className:"w-8 h-8",filled:e<=m})},e))})]})]})]}),(0,mm.jsxs)("div",{className:"mt-8 flex justify-end space-x-4",children:[(0,mm.jsx)("button",{onClick:c,className:"bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-800 dark:text-white font-bold py-2 px-4 rounded-md transition",children:"Cancel"}),(0,mm.jsx)("button",{onClick:()=>{const e=d[f]||{};h(f,{...e,notes:p,rating:m,biasOutcome:v}),c()},className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-md transition",children:"Save Journal"})]})]})})},by=e=>{let{winRate:t,avgTradesPerDay:n}=e;const[s,i]=(0,r.useState)({equity:"10000",target:"12000",risk:"1"}),[a,o]=(0,r.useState)("%"),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(""),h=e=>i(t=>({...t,[e.target.name]:e.target.value}));return(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h2",{className:"text-xl font-bold text-center mb-6",children:"Profit Calculator"}),(0,mm.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Initial Equity ($)"}),(0,mm.jsx)("input",{name:"equity",type:"number",value:s.equity,onChange:h,className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Target Equity ($)"}),(0,mm.jsx)("input",{name:"target",type:"number",value:s.target,onChange:h,className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Risk per Trade"}),(0,mm.jsxs)("div",{className:"flex",children:[(0,mm.jsx)("input",{name:"risk",type:"number",value:s.risk,onChange:h,className:"w-full bg-gray-50 dark:bg-gray-700 border rounded-l-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 z-10"}),(0,mm.jsxs)("div",{className:"flex",children:[(0,mm.jsx)("button",{onClick:()=>o("%"),className:"px-4 py-2 text-sm font-semibold border-t border-b "+("%"===a?"bg-blue-600 text-white z-10":"bg-gray-200 dark:bg-gray-600"),children:"%"}),(0,mm.jsx)("button",{onClick:()=>o("$"),className:"px-4 py-2 text-sm font-semibold border rounded-r-md "+("$"===a?"bg-blue-600 text-white z-10":"bg-gray-200 dark:bg-gray-600"),children:"$"})]})]})]}),(0,mm.jsx)("button",{onClick:()=>{const e=parseFloat(s.equity),r=parseFloat(s.target),i=parseFloat(s.risk);if(isNaN(e)||isNaN(r)||isNaN(i)||e<=0||r<=e||i<=0)return d("Invalid input. Please ensure all numbers are positive and target > initial equity."),c(null);if(0===t)return d("Your win rate is 0%. Projections cannot be calculated."),c(null);d("");const o=[1,2,3].map(s=>{let o=e,l=0;const c=e=>{const n="%"===a?e*(i/100):i;return n>e?-1/0:t*n*s-(1-t)*n};if(c(o)<=0)return{rr:s,trades:1/0,days:1/0};for(;o<r&&l<5e3;){const e=c(o);if(e===-1/0){l=1/0;break}o+=e,l++}return{rr:s,trades:l>=5e3?1/0:l,days:n>0?Math.ceil(l/n):1/0}});c(o)},className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition",children:"Calculate Projection"})]}),u&&(0,mm.jsx)("p",{className:"text-red-500 text-center mt-4",children:u}),l&&(0,mm.jsxs)("div",{className:"mt-6",children:[(0,mm.jsxs)("p",{className:"text-center text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Based on your historical win rate of ",(0,mm.jsxs)("span",{className:"font-bold text-blue-500",children:[(100*t).toFixed(1),"%"]})," and an average of ",(0,mm.jsx)("span",{className:"font-bold text-blue-500",children:n.toFixed(1)})," trades per day:"]}),(0,mm.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:l.map(e=>(0,mm.jsxs)("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[(0,mm.jsxs)("h4",{className:"font-bold text-lg",children:["R:R 1:",e.rr]}),e.trades===1/0?(0,mm.jsx)("p",{className:"text-red-500 mt-2",children:"Not achievable with this scenario."}):(0,mm.jsxs)(mm.Fragment,{children:[(0,mm.jsx)("p",{className:"text-3xl font-bold text-blue-500 my-2",children:e.trades}),(0,mm.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Trades"}),(0,mm.jsx)("p",{className:"text-xl font-semibold mt-3",children:e.days}),(0,mm.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Estimated Days"})]})]},e.rr))})]})]})},xy=e=>{let{settings:t,onSave:n,onCancel:s}=e;const[i,a]=(0,r.useState)(t),o=e=>{const{name:t,value:n}=e.target;a("dailyProfitTarget"===t||"dailyLossLimit"===t?e=>({...e,[t]:{...e[t],value:Number(n)}}):e=>({...e,[t]:Number(n)}))},l=(e,t)=>{a(n=>({...n,[e]:{...n[e],unit:t}}))};return(0,mm.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md",children:[(0,mm.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,mm.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Daily Target Settings"}),(0,mm.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-800 dark:hover:text-white",children:(0,mm.jsx)(Am,{className:"w-6 h-6"})})]}),(0,mm.jsxs)("div",{className:"space-y-4",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Starting Equity ($)"}),(0,mm.jsx)("input",{type:"number",name:"startingEquity",value:i.startingEquity,onChange:o,className:"w-full bg-gray-50 dark:bg-gray-700 border rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Daily Profit Target"}),(0,mm.jsxs)("div",{className:"flex",children:[(0,mm.jsx)("input",{type:"number",name:"dailyProfitTarget",value:i.dailyProfitTarget.value,onChange:o,className:"w-full bg-gray-50 dark:bg-gray-700 border rounded-l-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 z-10"}),(0,mm.jsxs)("div",{className:"flex",children:[(0,mm.jsx)("button",{onClick:()=>l("dailyProfitTarget","%"),className:"px-4 py-2 text-sm font-semibold border-t border-b "+("%"===i.dailyProfitTarget.unit?"bg-blue-600 text-white z-10":"bg-gray-200 dark:bg-gray-600"),children:"%"}),(0,mm.jsx)("button",{onClick:()=>l("dailyProfitTarget","$"),className:"px-4 py-2 text-sm font-semibold border rounded-r-md "+("$"===i.dailyProfitTarget.unit?"bg-blue-600 text-white z-10":"bg-gray-200 dark:bg-gray-600"),children:"$"})]})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Daily Loss Limit"}),(0,mm.jsxs)("div",{className:"flex",children:[(0,mm.jsx)("input",{type:"number",name:"dailyLossLimit",value:i.dailyLossLimit.value,onChange:o,className:"w-full bg-gray-50 dark:bg-gray-700 border rounded-l-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500 z-10"}),(0,mm.jsxs)("div",{className:"flex",children:[(0,mm.jsx)("button",{onClick:()=>l("dailyLossLimit","%"),className:"px-4 py-2 text-sm font-semibold border-t border-b "+("%"===i.dailyLossLimit.unit?"bg-blue-600 text-white z-10":"bg-gray-200 dark:bg-gray-600"),children:"%"}),(0,mm.jsx)("button",{onClick:()=>l("dailyLossLimit","$"),className:"px-4 py-2 text-sm font-semibold border rounded-r-md "+("$"===i.dailyLossLimit.unit?"bg-blue-600 text-white z-10":"bg-gray-200 dark:bg-gray-600"),children:"$"})]})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Max Trades Per Day"}),(0,mm.jsx)("input",{type:"number",name:"maxTradesPerDay",value:i.maxTradesPerDay,onChange:o,className:"w-full bg-gray-50 dark:bg-gray-700 border rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,mm.jsx)("div",{className:"mt-8 flex justify-end",children:(0,mm.jsx)("button",{onClick:()=>{n(i)},className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-md transition",children:"Save Settings"})})]})})},wy=e=>{let{dailyStats:t,settings:n,onOpenSettings:r}=e;const{pnl:s,tradeCount:i,profitTargetHit:a,lossLimitHit:o,maxTradesHit:l}=t,{dailyProfitTarget:c,dailyLossLimit:u,startingEquity:d}=n,h="%"===c.unit?d*c.value/100:c.value,f="%"===u.unit?-Math.abs(d*u.value/100):-Math.abs(u.value),p="$"===c.unit?km(c.value):`${c.value}%`,g="$"===u.unit?km(u.value):`${u.value}%`,m=h>0&&s>0?Math.min(s/h*100,100):0,y=f<0&&s<0?Math.min(s/f*100,100):0,v=a||o||l;let b="";return a?b="Profit Target Reached!":o?b="Loss Limit Reached!":l&&(b="Max Trades Reached!"),(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md relative",children:[(0,mm.jsx)("button",{onClick:r,className:"absolute top-4 right-4 p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition",children:(0,mm.jsx)(Mm,{className:"w-5 h-5"})}),(0,mm.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Consistency Tracker"}),(0,mm.jsxs)("div",{className:"space-y-4",children:[(0,mm.jsxs)("div",{className:"text-center",children:[(0,mm.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Today's P&L"}),(0,mm.jsx)("p",{className:"text-3xl font-bold "+(s>=0?"text-green-500":"text-red-500"),children:km(s)})]}),v&&(0,mm.jsxs)("div",{className:"p-3 rounded-md text-center bg-red-500/20 text-red-500 dark:text-red-400 font-bold",children:[(0,mm.jsx)("p",{children:"STOP TRADING"}),(0,mm.jsx)("p",{className:"text-sm font-normal",children:b})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,mm.jsxs)("span",{className:"font-semibold text-gray-600 dark:text-gray-300",children:["Profit Target (",p,")"]}),(0,mm.jsxs)("span",{className:"font-semibold text-green-500",children:[m.toFixed(0),"%"]})]}),(0,mm.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:(0,mm.jsx)("div",{className:"bg-green-500 h-2.5 rounded-full",style:{width:`${m}%`}})})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,mm.jsxs)("span",{className:"font-semibold text-gray-600 dark:text-gray-300",children:["Loss Limit (",g,")"]}),(0,mm.jsxs)("span",{className:"font-semibold text-red-500",children:[y.toFixed(0),"%"]})]}),(0,mm.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:(0,mm.jsx)("div",{className:"bg-red-500 h-2.5 rounded-full",style:{width:`${y}%`}})})]}),(0,mm.jsxs)("div",{className:"text-center pt-2",children:[(0,mm.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Trades Today"}),(0,mm.jsxs)("p",{className:"text-2xl font-bold",children:[i," ",(0,mm.jsxs)("span",{className:"text-base font-normal text-gray-400",children:["/ ",n.maxTradesPerDay]})]})]})]})]})},ky=e=>{let{todayBias:t,onSaveBias:n}=e;const[s,i]=(0,r.useState)(t.reason||""),[a,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)("");(0,r.useEffect)(()=>{i(t.reason||"")},[t]);return(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h3",{className:"font-bold text-lg mb-4",children:"Daily Briefing & Bias"}),(0,mm.jsxs)("div",{className:"space-y-4",children:[(0,mm.jsxs)("div",{className:"space-y-2",children:[(0,mm.jsxs)("button",{onClick:async()=>{o(!0),c("");try{const e=(await wm("What is the latest financial news and market sentiment for today?",'You are a financial analyst providing a morning briefing for a retail trader.\n1.  Analyze the most important global financial news from the last 24 hours that could impact the US stock market today using the provided search tool.\n2.  Provide a concise summary of your reasoning, under 150 words.\n3.  Based on the news, determine the overall market sentiment.\n4.  On the VERY LAST LINE of your response, and ONLY on the last line, write "Bias: bullish" or "Bias: bearish". Do not include any other text on this final line.',!0,null)).trim().split("\n"),t=e.pop().toLowerCase();let r="bullish";t.includes("bearish")&&(r="bearish");const s=e.join("\n").trim();i(s),n({bias:r,reason:s})}catch(e){console.error("AI Briefing Error:",e),c("Failed to generate briefing. Please try again later.")}finally{o(!1)}},disabled:a,className:"w-full flex items-center justify-center space-x-2 bg-gradient-to-r from-blue-500 to-teal-500 hover:from-blue-600 hover:to-teal-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 disabled:opacity-60",children:[(0,mm.jsx)(Km,{className:"w-5 h-5"}),(0,mm.jsx)("span",{children:a?"Generating...":"\u2728 Get Daily Market Briefing"})]}),l&&(0,mm.jsx)("p",{className:"text-red-500 text-sm text-center",children:l}),a&&(0,mm.jsx)("div",{className:"text-center text-sm text-gray-500 dark:text-gray-400",children:"Fetching latest market news..."})]}),(0,mm.jsx)("hr",{className:"border-gray-200 dark:border-gray-700"}),(0,mm.jsxs)("div",{className:"flex justify-around",children:[(0,mm.jsxs)("button",{onClick:()=>n({...t,bias:"bullish"}),className:"p-4 rounded-lg w-full mr-2 transition "+("bullish"===t.bias?"bg-green-500 text-white":"bg-gray-200 dark:bg-gray-700"),children:[(0,mm.jsx)($m,{className:"w-8 h-8 mx-auto"}),(0,mm.jsx)("span",{className:"text-sm font-semibold",children:"Bullish"})]}),(0,mm.jsxs)("button",{onClick:()=>n({...t,bias:"bearish"}),className:"p-4 rounded-lg w-full ml-2 transition "+("bearish"===t.bias?"bg-red-500 text-white":"bg-gray-200 dark:bg-gray-700"),children:[(0,mm.jsx)(qm,{className:"w-8 h-8 mx-auto"}),(0,mm.jsx)("span",{className:"text-sm font-semibold",children:"Bearish"})]})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:"Reason for Your Bias"}),(0,mm.jsx)("textarea",{value:s,onChange:e=>{i(e.target.value)},onBlur:()=>{n({...t,reason:s})},rows:"4",placeholder:"Click the button above to generate a briefing or write your own analysis.",className:"w-full bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 focus:ring-2 focus:ring-blue-500 focus:outline-none"})]})]})]})},_y=e=>{let{monthlyStats:t}=e;return(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Monthly Stats Breakdown"}),(0,mm.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[(0,mm.jsx)("div",{className:"w-32 h-32 flex-shrink-0",children:(0,mm.jsx)(fy,{data:[{label:"Profit",value:t.totalProfit,color:"#48bb78"},{label:"Loss",value:Math.abs(t.totalLoss),color:"#f56565"}]})}),(0,mm.jsxs)("div",{className:"w-full space-y-2 text-sm",children:[(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Profit:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-green-500",children:km(t.totalProfit)})]}),(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Loss:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-red-500",children:km(t.totalLoss)})]}),(0,mm.jsxs)("p",{className:"flex justify-between font-bold border-t border-gray-200 dark:border-gray-700 pt-2 mt-2",children:[(0,mm.jsx)("span",{children:"Net P&L:"})," ",(0,mm.jsx)("span",{className:t.netPnl>=0?"text-green-500":"text-red-500",children:km(t.netPnl)})]})]})]}),(0,mm.jsxs)("div",{className:"grid grid-cols-2 gap-x-6 gap-y-3 text-sm mt-6 border-t border-gray-200 dark:border-gray-700 pt-4",children:[(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Total Trades:"})," ",(0,mm.jsx)("span",{className:"font-semibold",children:t.total})]})}),(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Win Rate:"})," ",(0,mm.jsxs)("span",{className:"font-semibold",children:[t.winRate.toFixed(1),"%"]})]})}),(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Wins:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-green-500",children:t.wins})]})}),(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Losses:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-red-500",children:t.losses})]})}),(0,mm.jsx)("div",{className:"col-span-2",children:(0,mm.jsx)("hr",{className:"my-1 border-gray-200 dark:border-gray-700"})}),(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Bias Correct:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-green-500",children:t.biasCorrect})]})}),(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Bias Incorrect:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-red-500",children:t.biasIncorrect})]})}),(0,mm.jsx)("div",{className:"col-span-2",children:(0,mm.jsx)("hr",{className:"my-1 border-gray-200 dark:border-gray-700"})}),(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Disciplined:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-green-500",children:t.disciplinedDays})]})}),(0,mm.jsx)("div",{children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Overtraded:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-yellow-500",children:t.overtradedDays})]})}),(0,mm.jsx)("div",{className:"col-span-2",children:(0,mm.jsxs)("p",{className:"flex justify-between",children:[(0,mm.jsx)("span",{children:"Loss Exceeded:"})," ",(0,mm.jsx)("span",{className:"font-semibold text-red-500",children:t.lossExceededDays})]})})]})]})},Ny=e=>{let{user:t,profileData:n,onSave:s,onCancel:i}=e;const[a,o]=(0,r.useState)(n.displayName||""),[l,c]=(0,r.useState)(n.dob||"");return(0,mm.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl w-full max-w-md",children:[(0,mm.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,mm.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"My Profile"}),(0,mm.jsx)("button",{onClick:i,className:"text-gray-500 hover:text-gray-800 dark:hover:text-white",children:(0,mm.jsx)(Am,{className:"w-6 h-6"})})]}),(0,mm.jsxs)("div",{className:"space-y-4",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Display Name"}),(0,mm.jsx)("input",{type:"text",value:a,onChange:e=>o(e.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 border rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Email"}),(0,mm.jsx)("p",{className:"w-full bg-gray-100 dark:bg-gray-700/50 border rounded-md py-2 px-3 text-gray-500 dark:text-gray-400",children:t.email})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{className:"block text-sm font-bold text-gray-600 dark:text-gray-400 mb-2",children:"Date of Birth"}),(0,mm.jsx)("input",{type:"date",value:l,onChange:e=>c(e.target.value),className:"w-full bg-gray-50 dark:bg-gray-700 border rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,mm.jsx)("div",{className:"mt-8 flex justify-end",children:(0,mm.jsx)("button",{onClick:()=>{s({displayName:a,dob:l})},className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-md transition",children:"Save Profile"})})]})})};function Ey(e){let{user:t,handleLogout:n}=e;const[s,i]=(0,r.useState)([]),[a,o]=(0,r.useState)({}),[l,c]=(0,r.useState)([]),[u,d]=(0,r.useState)({}),[h,f]=(0,r.useState)(!0),[p,g]=(0,r.useState)(()=>"undefined"!==typeof window&&localStorage.getItem("themeV12")||"dark"),[m,y]=(0,r.useState)({startingEquity:1e4,dailyProfitTarget:{value:2,unit:"%"},dailyLossLimit:{value:1,unit:"%"},maxTradesPerDay:5}),[v,b]=(0,r.useState)(!1),[x,w]=(0,r.useState)(!1),[k,_]=(0,r.useState)(null),[N,E]=(0,r.useState)(null),[S,T]=(0,r.useState)("all"),[C,I]=(0,r.useState)("all"),[j,A]=(0,r.useState)({key:"date",direction:"descending"}),[R,D]=(0,r.useState)(1),[P,L]=(0,r.useState)(!0),[O,M]=(0,r.useState)(new Date),[F,U]=(0,r.useState)("Dashboard"),[V,z]=(0,r.useState)(null),[B,$]=(0,r.useState)(null),[q,H]=(0,r.useState)(!1),W=(0,r.useRef)(null),[G,K]=(0,r.useState)(""),[Q,Y]=(0,r.useState)(!1),[J,X]=(0,r.useState)("");(0,r.useEffect)(()=>{if(!t)return;f(!0);const e=`users/${t.uid}/trades`,n=`users/${t.uid}/dailyJournals`,r=`users/${t.uid}/profile/settings`,s=`users/${t.uid}/profile/info`,a=`users/${t.uid}/tags`,l=Vp(bp(Af(vm,e),_p("date","desc")),e=>{const t=[];e.forEach(e=>{t.push({...e.data(),id:e.id})}),i(t),f(!1)},e=>{console.error("Error fetching trades:",e),f(!1)}),u=Vp(bp(Af(vm,n)),e=>{const t={};e.forEach(e=>{t[e.id]=e.data()}),o(t)},e=>{console.error("Error fetching daily journals:",e)}),h=Vp(bp(Af(vm,a),_p("name")),e=>{const t=[];e.forEach(e=>{t.push({...e.data(),id:e.id})}),c(t)},e=>{console.error("Error fetching tags:",e)}),p=Vp(Rf(vm,r),e=>{if(e.exists()){const t=e.data();"number"===typeof t.dailyProfitTarget&&(t.dailyProfitTarget={value:t.dailyProfitTarget,unit:"%"}),"number"===typeof t.dailyLossLimit&&(t.dailyLossLimit={value:t.dailyLossLimit,unit:"%"}),y(e=>({...e,...t}))}else console.log("No settings document found for user. Using defaults.")},e=>{console.error("Error fetching settings:",e)}),g=Vp(Rf(vm,s),e=>{e.exists()&&d(e.data())},e=>{console.error("Error fetching profile data:",e)});return()=>{l(),u(),p(),g(),h()}},[t]),(0,r.useEffect)(()=>{"dark"===p?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("themeV12",p)},[p]),(0,r.useEffect)(()=>{function e(e){W.current&&!W.current.contains(e.target)&&H(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[W]);const Z=async(e,n)=>{if(!t||!e)return;const r=`users/${t.uid}/tags`;if(l.find(t=>t.name.toLowerCase()===e.toLowerCase()))console.error("Tag already exists.");else try{await Up(Af(vm,r),{name:e,color:n})}catch(s){console.error("Error adding tag: ",s)}},ee=async(e,n)=>{if(!t)return;const r=`users/${t.uid}/dailyJournals`,s=Rf(vm,r,e);try{await Op(s,n,{merge:!0})}catch(i){console.error("Error saving daily journal: ",i)}},te=(0,r.useMemo)(()=>V||B?s.filter(e=>{const t=e.date.toDate(),n=V?new Date(new Date(V).setHours(0,0,0,0)):null,r=B?new Date(new Date(B).setHours(23,59,59,999)):null;return(!n||t>=n)&&(!r||t<=r)}):s,[s,V,B]),ne=(0,r.useMemo)(()=>{if(!V)return 0;const e=new Date(new Date(V).setHours(0,0,0,0));return s.filter(t=>t.date.toDate()<e).reduce((e,t)=>e+t.pnl,0)},[s,V]),{dashboardStats:re,advancedStats:se,weeklyStats:ie,dailyStats:ae,consistencyByDay:oe}=(0,r.useMemo)(()=>{const e=te,t=e.filter(e=>"Buy"===e.type||"Sell"===e.type),n=e.filter(e=>"Deposit"===e.type).reduce((e,t)=>e+t.pnl,0),r=e.filter(e=>"Withdrawal"===e.type).reduce((e,t)=>e+t.pnl,0),i=e.reduce((e,t)=>e+t.pnl,0),a=ne+i,o=(new Date).toDateString(),l=s.filter(e=>("Buy"===e.type||"Sell"===e.type)&&e.date.toDate().toDateString()===o),c=l.reduce((e,t)=>e+t.pnl,0),u="%"===m.dailyProfitTarget.unit?m.startingEquity*m.dailyProfitTarget.value/100:m.dailyProfitTarget.value,d="%"===m.dailyLossLimit.unit?-Math.abs(m.startingEquity*m.dailyLossLimit.value/100):-Math.abs(m.dailyLossLimit.value),h={pnl:c,tradeCount:l.length,profitTargetHit:u>0&&c>=u,lossLimitHit:c<=d,maxTradesHit:l.length>=m.maxTradesPerDay},f=(e,t)=>{if(0===e.length)return"NO_TRADES";const n=e.reduce((e,t)=>e+t.pnl,0),r="%"===t.dailyProfitTarget.unit?t.startingEquity*t.dailyProfitTarget.value/100:t.dailyProfitTarget.value;return n<=("%"===t.dailyLossLimit.unit?-Math.abs(t.startingEquity*t.dailyLossLimit.value/100):-Math.abs(t.dailyLossLimit.value))?"LOSS_LIMIT_HIT":r>0&&n>=r?"PROFIT_TARGET_HIT":e.length>t.maxTradesPerDay?n>=0?"OVERTRADED_WIN":"OVERTRADED_LOSS":n>=0?"DISCIPLINED_WIN":"DISCIPLINED_LOSS"},p={},g=s.reduce((e,t)=>{const n=t.date.toDate().toISOString().split("T")[0];return e[n]||(e[n]=[]),e[n].push(t),e},{});for(const s in g){const e=g[s].filter(e=>"Buy"===e.type||"Sell"===e.type);p[s]=f(e,m)}const y=new Date;y.setDate(y.getDate()-7);const v=s.filter(e=>("Buy"===e.type||"Sell"===e.type)&&e.date.toDate()>=y),b=v.reduce((e,t)=>e+t.pnl,0),x=v.filter(e=>"Win"===e.status).length,w=v.filter(e=>"Loss"===e.status).length,k=v.length,_=k>0?x/k*100:0,N=v.length>0?Math.max(...v.map(e=>e.pnl)):0,E=v.length>0?Math.min(...v.map(e=>e.pnl)):0,S={disciplined:0,overtraded:0,lossExceeded:0};new Set(v.map(e=>e.date.toDate().toISOString().split("T")[0])).forEach(e=>{const t=p[e];"PROFIT_TARGET_HIT"===t||"DISCIPLINED_WIN"===t||"DISCIPLINED_LOSS"===t?S.disciplined++:"OVERTRADED_WIN"===t||"OVERTRADED_LOSS"===t?S.overtraded++:"LOSS_LIMIT_HIT"===t&&S.lossExceeded++});const T=t.reduce((e,t)=>e+t.pnl,0),C=t.filter(e=>"Win"===e.status),I=t.filter(e=>"Loss"===e.status),j=t.length>0?C.length/t.length:0,A=new Set(t.map(e=>e.date.toDate().toLocaleDateString())).size,R=A>0?t.length/A:0,D={};t.forEach(e=>(e.tags||[]).forEach(t=>{D[t]||(D[t]={pnl:0,count:0}),D[t].pnl+=e.pnl,D[t].count++}));const P=Object.entries(D).map(e=>{let[t,n]=e;return{name:t,...n}}).sort((e,t)=>t.pnl-e.pnl),L=P.filter(e=>e.pnl>0).slice(0,3),O=[...P.filter(e=>e.pnl<0)].reverse().slice(0,3),M=[...t].sort((e,t)=>e.date.toDate()-t.date.toDate());let F=0,U=0,V=0,z=0;M.forEach(e=>{"Win"===e.status?(U++,z=0,U>F&&(F=U)):(z++,U=0,z>V&&(V=z))});const B=C.reduce((e,t)=>e+t.pnl,0)/(C.length||1),$=Math.abs(I.reduce((e,t)=>e+t.pnl,0)/(I.length||1)),q=$>0?B/$:0,H=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],W=H.reduce((e,t)=>({...e,[t]:{pnl:0,count:0,wins:0,losses:0,totalRating:0,ratedTrades:0}}),{});t.forEach(e=>{const t=H[e.date.toDate().getDay()];W[t].pnl+=e.pnl,W[t].count++,"Win"===e.status?W[t].wins++:"Loss"===e.status&&W[t].losses++,e.rating>0&&(W[t].totalRating+=e.rating,W[t].ratedTrades++)});const G=t.filter(e=>1===e.rating).reduce((e,t)=>e+t.pnl,0),K=t.filter(e=>5===e.rating).reduce((e,t)=>e+t.pnl,0),Q=[...e].sort((e,t)=>e.date.toDate()-t.date.toDate());let Y=ne,J=0,X=0,Z=0,ee=!1,re=ne;Q.forEach(e=>{if(re+=e.pnl,re>Y)Y=re,ee&&(X>Z&&(Z=X),X=0,ee=!1);else{const t=Y-re;t>J&&(J=t),"Buy"!==e.type&&"Sell"!==e.type||(ee||(ee=!0),X++)}}),ee&&X>Z&&(Z=X);const se=Y>0?J/Y*100:0,ie=1-j,ae=j*B-ie*$,oe=j>0?ie/j:0;let le="Not enough data.";return t.length>=10&&(le=ae>0?`Your system is profitable. Aim for trades with an R:R above 1:${(oe+.5).toFixed(2)}.`:`Your system is not yet profitable. Focus on increasing Win Rate or aiming for an R:R above 1:${(oe+.5).toFixed(2)}.`),{dashboardStats:{totalPnl:T,currentEquity:a,totalDeposits:n,totalWithdrawals:r,winRate:j,totalTrades:t.length},advancedStats:{totalTrades:t.length,tagPerformance:{top3:L,bottom3:O},streaks:{maxWinStreak:F,maxLossStreak:V},dayPerformance:W,avgWinLossRatio:q,ratingPerformance:{pnlByRating1:G,pnlByRating5:K},drawdown:{maxDrawdownValue:J,maxDrawdownPercent:se,longestDrawdownDuration:Z},expectancy:{expectancyValue:ae,breakEvenRRR:oe,suggestion:le},winRate:j,avgTradesPerDay:R},weeklyStats:{pnl:b,wins:x,losses:w,totalTrades:k,winRate:_,bestTrade:N,worstTrade:E,consistency:S},dailyStats:h,consistencyByDay:p}},[te,m,a,s,ne]),le=(0,r.useMemo)(()=>[...s].filter(e=>{const t="all"===C||e.type===C,n="Buy"!==e.type&&"Sell"!==e.type||"all"===S||e.status===S;return t&&n}).sort((e,t)=>{if(!j.key)return 0;const n="date"===j.key?e.date.toDate():e[j.key],r="date"===j.key?t.date.toDate():t[j.key];return n<r?"ascending"===j.direction?-1:1:n>r?"ascending"===j.direction?1:-1:0}),[s,S,C,j]),ce=e=>{let t="ascending";j.key===e&&"ascending"===j.direction&&(t="descending"),A({key:e,direction:t})},ue=Math.ceil(le.length/10),de=le.slice(10*(R-1),10*R),he=(0,r.useMemo)(()=>{const e=s.filter(e=>{const t=e.date.toDate();return t.getFullYear()===O.getFullYear()&&t.getMonth()===O.getMonth()&&("Buy"===e.type||"Sell"===e.type)}),t=e.length,n=e.filter(e=>"Win"===e.status).length,r=e.filter(e=>"Loss"===e.status).length,i=t>0?n/t*100:0,o=e.filter(e=>e.pnl>0).reduce((e,t)=>e+t.pnl,0),l=e.filter(e=>e.pnl<0).reduce((e,t)=>e+t.pnl,0);let c=0,u=0,d=0,h=0,f=0;return new Set(e.map(e=>e.date.toDate().toISOString().split("T")[0])).forEach(e=>{switch(oe[e]){case"PROFIT_TARGET_HIT":case"DISCIPLINED_WIN":case"DISCIPLINED_LOSS":d++;break;case"OVERTRADED_WIN":case"OVERTRADED_LOSS":h++;break;case"LOSS_LIMIT_HIT":f++}}),Object.entries(a).forEach(e=>{let[t,n]=e;const r=new Date(t);r.getFullYear()===O.getFullYear()&&r.getMonth()===O.getMonth()&&("correct"===n.biasOutcome&&c++,"incorrect"===n.biasOutcome&&u++)}),{total:t,wins:n,losses:r,winRate:i,totalProfit:o,totalLoss:l,netPnl:o+l,biasCorrect:c,biasIncorrect:u,disciplinedDays:d,overtradedDays:h,lossExceededDays:f}},[s,O,a,oe]),fe=(new Date).toISOString().split("T")[0],pe=a[fe]||{},ge=e=>{let{tabName:t}=e;const n=F===t;return(0,mm.jsx)("button",{onClick:()=>U(t),className:"px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200 "+(n?"bg-blue-600 text-white":"text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"),children:t})},me=e=>{const t=new Date,n=new Date;n.setDate(t.getDate()-e+1),z(n.toISOString().split("T")[0]),$(t.toISOString().split("T")[0])},ye=e=>e?new Date(e).toISOString().split("T")[0]:"",ve=e=>{let{onGenerate:t,review:n,isLoading:s,error:i,stats:a}=e;const[o,l]=(0,r.useState)(0),c={"Weekly Snapshot":(0,mm.jsx)(Cm,{className:"w-5 h-5 mr-2 text-blue-500"}),"Major Wins":(0,mm.jsx)(Fm,{className:"w-5 h-5 mr-2 text-green-500"}),"Key Lessons":(0,mm.jsx)(Um,{className:"w-5 h-5 mr-2 text-yellow-500"}),"Action Plan":(0,mm.jsx)(zm,{className:"w-5 h-5 mr-2 text-indigo-500"}),"Motivational Tip":(0,mm.jsx)(jm,{className:"w-5 h-5 mr-2 text-amber-500",filled:!0})},u=(0,r.useMemo)(()=>{if(!n)return null;const e=n.split(/\*\*(.*?)\*\*/).filter(Boolean),t=[];for(let n=0;n<e.length;n+=2){var r;const s=e[n].trim(),i=null===(r=e[n+1])||void 0===r?void 0:r.trim().replace(/^- /gm,"").split("<br />").filter(e=>""!==e.trim());s&&i&&t.push({title:s,content:i,icon:c[s]||null})}return t.length>0?t:null},[n]);return(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h3",{className:"font-bold text-lg mb-4 text-center",children:"AI Weekly Performance Review"}),(0,mm.jsxs)("button",{onClick:t,disabled:s||a.totalTrades<1,className:"w-full flex items-center justify-center space-x-2 bg-gradient-to-r from-green-500 to-cyan-500 hover:from-green-600 hover:to-cyan-600 text-white font-bold py-2 px-4 rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,mm.jsx)(Km,{className:"w-5 h-5"}),(0,mm.jsx)("span",{children:s?"Generating...":"\u2728 Get My Weekly Review"})]}),a.totalTrades<1&&!n&&(0,mm.jsx)("p",{className:"text-xs text-center mt-2 text-gray-400",children:"Trade at least once this week to generate a review."}),i&&(0,mm.jsx)("p",{className:"text-red-500 text-sm text-center mt-2",children:i}),s&&(0,mm.jsx)("div",{className:"text-center text-sm text-gray-500 dark:text-gray-400 mt-2",children:"Your AI coach is analyzing your week..."}),u&&!s&&(0,mm.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,mm.jsx)("div",{className:"overflow-hidden relative h-48",children:u.map((e,t)=>(0,mm.jsxs)("div",{className:"absolute w-full h-full transition-opacity duration-500 ease-in-out",style:{opacity:t===o?1:0},children:[(0,mm.jsxs)("h4",{className:"font-bold text-md text-gray-800 dark:text-gray-200 flex items-center",children:[e.icon,e.title]}),(0,mm.jsx)("ul",{className:"mt-2 space-y-2 text-sm text-gray-600 dark:text-gray-300 list-disc list-inside",children:e.content.map((e,t)=>(0,mm.jsx)("li",{children:e},t))})]},t))}),(0,mm.jsxs)("div",{className:"flex items-center justify-center mt-4",children:[(0,mm.jsx)("button",{onClick:()=>{u&&l(e=>(e-1+u.length)%u.length)},className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:(0,mm.jsx)(Lm,{className:"w-5 h-5"})}),(0,mm.jsx)("div",{className:"flex space-x-2 mx-4",children:u.map((e,t)=>(0,mm.jsx)("button",{onClick:()=>l(t),className:"w-2 h-2 rounded-full transition-colors "+(o===t?"bg-blue-500":"bg-gray-300 dark:bg-gray-600")},t))}),(0,mm.jsx)("button",{onClick:()=>{u&&l(e=>(e+1)%u.length)},className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700",children:(0,mm.jsx)(Om,{className:"w-5 h-5"})})]})]})]})};return(0,mm.jsx)("div",{className:"bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-white min-h-screen font-sans p-4 sm:p-6 transition-colors duration-300",children:(0,mm.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,mm.jsxs)("header",{className:"mb-8 flex justify-between items-center",children:[(0,mm.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,mm.jsx)("button",{onClick:()=>w(!0),className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition",children:(0,mm.jsx)(Gm,{className:"w-6 h-6"})}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold",children:"Trading Journal"}),(0,mm.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:u.displayName||t.email})]})]}),(0,mm.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,mm.jsx)("button",{onClick:()=>g("light"===p?"dark":"light"),className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition",children:"light"===p?(0,mm.jsx)(Tm,{className:"w-6 h-6"}):(0,mm.jsx)(Sm,{className:"w-6 h-6"})}),(0,mm.jsx)("button",{onClick:n,className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition",children:(0,mm.jsx)(Hm,{className:"w-6 h-6"})})]})]}),(0,mm.jsx)("nav",{className:"mb-8",children:(0,mm.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700",children:(0,mm.jsxs)("div",{className:"-mb-px flex space-x-2 overflow-x-auto whitespace-nowrap pb-2 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 dark:scrollbar-thumb-gray-600 dark:scrollbar-track-gray-800",children:[(0,mm.jsx)(ge,{tabName:"Dashboard"}),(0,mm.jsx)(ge,{tabName:"Journal"}),(0,mm.jsx)(ge,{tabName:"Analytics"}),(0,mm.jsx)(ge,{tabName:"Chart Analyzer"}),(0,mm.jsx)(ge,{tabName:"Community"})]})})}),(0,mm.jsxs)("main",{children:["Dashboard"===F&&(0,mm.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,mm.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[(0,mm.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6",children:[(0,mm.jsx)(cy,{title:"Current Equity",value:km(re.currentEquity),valueColor:"text-blue-500",icon:(0,mm.jsx)(Cm,{className:"w-6 h-6 text-blue-500"})}),(0,mm.jsx)(cy,{title:"Total P&L (Trades)",value:km(re.totalPnl),valueColor:re.totalPnl>=0?"text-green-500":"text-red-500",icon:(0,mm.jsx)(Nm,{className:"w-6 h-6 text-green-500"})}),(0,mm.jsx)(cy,{title:"Win Rate",value:`${(100*re.winRate).toFixed(1)}%`,valueColor:"text-indigo-500",icon:(0,mm.jsx)(Bm,{className:"w-6 h-6 text-indigo-500"}),subValue:`${re.totalTrades} trades`}),(0,mm.jsx)(cy,{title:"Total Deposits",value:km(re.totalDeposits),valueColor:"text-yellow-500",icon:(0,mm.jsx)(Rm,{className:"w-6 h-6 text-yellow-500"})}),(0,mm.jsx)(cy,{title:"Total Withdrawals",value:km(re.totalWithdrawals),valueColor:"text-orange-500",icon:(0,mm.jsx)(Dm,{className:"w-6 h-6 text-orange-500"})})]}),(0,mm.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md",children:(0,mm.jsxs)("button",{onClick:()=>U("Journal"),className:"w-full p-4 flex justify-between items-center text-left text-blue-600 dark:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition",children:[(0,mm.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,mm.jsx)(Rm,{className:"w-6 h-6"}),(0,mm.jsx)("h2",{className:"text-xl font-bold",children:"Add a Trade"})]}),(0,mm.jsx)(Om,{className:"w-6 h-6"})]})}),(0,mm.jsx)(gy,{transactions:s,currentDate:O,setCurrentDate:M,onDayClick:e=>E(e),dailyJournals:a,consistencyByDay:oe})]}),(0,mm.jsxs)("div",{className:"lg:col-span-1 space-y-8",children:[(0,mm.jsx)(_y,{monthlyStats:he}),(0,mm.jsx)(wy,{dailyStats:ae,settings:m,onOpenSettings:()=>b(!0)}),(0,mm.jsx)(ky,{todayBias:pe,onSaveBias:e=>ee(fe,e)}),(0,mm.jsx)(ve,{onGenerate:async()=>{Y(!0),X(""),K("");const e=`Please generate a weekly performance review based on the following data for the last 7 days:\n- Total P&L: ${km(ie.pnl)}\n- Win Rate: ${ie.winRate.toFixed(1)}%\n- Total Trades: ${ie.totalTrades} (${ie.wins} wins, ${ie.losses} losses)\n- Best Trade P&L: ${km(ie.bestTrade)}\n- Worst Trade P&L: ${km(ie.worstTrade)}\n- Consistency Summary: ${ie.consistency.disciplined} disciplined days, ${ie.consistency.overtraded} overtraded days, ${ie.consistency.lossExceeded} loss-limit days.`;try{const t=await wm(e,"You are a trading performance coach providing a weekly review. Analyze the user's data and structure your response into exactly FIVE sections using the following markdown titles: **Weekly Snapshot**, **Major Wins**, **Key Lessons**, **Action Plan**, and **Motivational Tip**.\n- For **Weekly Snapshot**, briefly state the key metrics like P&L and Win Rate.\n- For **Major Wins**, highlight the best trade and disciplined performance.\n- For **Key Lessons**, discuss the worst trade and any patterns of overtrading or hitting loss limits.\n- For **Action Plan**, provide 1-2 concrete, actionable steps for the next week.\n- For **Motivational Tip**, give a short, encouraging closing thought.\nKeep each section concise and to the point. Do not add any other sections or introductory text.");K(t)}catch(t){console.error("AI Weekly Review Error:",t),X("Sorry, the AI review failed. Please try again later.")}finally{Y(!1)}},review:G,isLoading:Q,error:J,stats:ie})]})]}),"Journal"===F&&(0,mm.jsxs)("div",{className:"space-y-8",children:[(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md relative",children:[(0,mm.jsxs)("div",{className:"absolute top-6 left-6 z-20",ref:W,children:[(0,mm.jsxs)("button",{onClick:()=>H(!q),className:"flex items-center space-x-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-4 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-700 transition",children:[(0,mm.jsx)(_m,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),(0,mm.jsx)("span",{children:"Pick Date Range"})]}),q&&(0,mm.jsxs)("div",{className:"absolute top-full mt-2 bg-white dark:bg-gray-900/80 backdrop-blur-sm border border-gray-200 dark:border-gray-700 p-4 rounded-lg shadow-xl",children:[(0,mm.jsx)("h3",{className:"font-bold text-sm mb-3 text-gray-800 dark:text-gray-200",children:"Filter by Date"}),(0,mm.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"start-date",className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"From"}),(0,mm.jsx)("input",{type:"date",id:"start-date",value:ye(V),onChange:e=>z(e.target.value),className:"mt-1 w-full text-sm bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-1 px-2 focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"end-date",className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:"To"}),(0,mm.jsx)("input",{type:"date",id:"end-date",value:ye(B),onChange:e=>$(e.target.value),className:"mt-1 w-full text-sm bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-1 px-2 focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),(0,mm.jsxs)("div",{className:"col-span-2 flex space-x-2",children:[(0,mm.jsx)("button",{onClick:()=>me(7),className:"w-full text-xs bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 py-1.5 px-2 rounded-md transition",children:"7D"}),(0,mm.jsx)("button",{onClick:()=>me(30),className:"w-full text-xs bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 py-1.5 px-2 rounded-md transition",children:"30D"}),(0,mm.jsx)("button",{onClick:()=>me(90),className:"w-full text-xs bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 py-1.5 px-2 rounded-md transition",children:"90D"})]}),(0,mm.jsx)("div",{className:"col-span-2",children:(0,mm.jsx)("button",{onClick:()=>{z(null),$(null)},className:"w-full bg-red-500 hover:bg-red-600 text-white font-bold py-1.5 px-4 rounded-md transition text-xs",children:"Clear Filter"})})]})]})]}),(0,mm.jsx)("h2",{className:"text-xl font-bold mb-4 text-center",children:"Equity Curve"}),(0,mm.jsx)("div",{className:"h-96",children:(0,mm.jsx)(uy,{transactions:te,startingEquity:ne})})]}),(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[(0,mm.jsxs)("div",{className:"p-6 flex justify-between items-center",children:[(0,mm.jsx)("h2",{className:"text-xl font-bold",children:"Add New Transaction"}),(0,mm.jsx)("button",{onClick:()=>L(!P),className:"text-gray-500 hover:text-gray-800 dark:hover:text-white",children:P?(0,mm.jsx)(Dm,{className:"w-6 h-6"}):(0,mm.jsx)(Rm,{className:"w-6 h-6"})})]}),P&&(0,mm.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700",children:(0,mm.jsx)(ay,{onAddTransaction:async e=>{const n=`users/${t.uid}/trades`,r="Buy"===e.type||"Sell"===e.type?e.pnl>=0?"Win":"Loss":null,s={...e,date:Gi.fromDate(new Date),status:r,notes:"",tags:[],rating:0,imageUrl:""};try{await Up(Af(vm,n),s)}catch(i){console.error("Error adding transaction: ",i)}}})})]}),(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md transition-colors duration-300",children:[(0,mm.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[(0,mm.jsxs)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4 sm:mb-0",children:["Transaction History (",le.length,")"]}),(0,mm.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,mm.jsxs)("select",{onChange:e=>T(e.target.value),value:S,className:"bg-gray-50 dark:bg-gray-700 border rounded-md py-1 px-2 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[(0,mm.jsx)("option",{value:"all",children:"All Statuses"}),(0,mm.jsx)("option",{value:"Win",children:"Win"}),(0,mm.jsx)("option",{value:"Loss",children:"Loss"})]}),(0,mm.jsxs)("select",{onChange:e=>I(e.target.value),value:C,className:"bg-gray-50 dark:bg-gray-700 border rounded-md py-1 px-2 focus:ring-2 focus:ring-blue-500 focus:outline-none",children:[(0,mm.jsx)("option",{value:"all",children:"All Types"}),(0,mm.jsx)("option",{value:"Buy",children:"Buy"}),(0,mm.jsx)("option",{value:"Sell",children:"Sell"}),(0,mm.jsx)("option",{value:"Deposit",children:"Deposit"}),(0,mm.jsx)("option",{value:"Withdrawal",children:"Withdrawal"})]}),(0,mm.jsx)("button",{onClick:()=>(e=>{if(!e||0===e.length)return void console.log("No data to export.");const t=e=>{if(null===e||void 0===e)return"";const t=String(e);return t.search(/("|,|\n)/g)>=0?`"${t.replace(/"/g,'""')}"`:t},n=e.map(e=>[e.id,e.date.toDate().toISOString(),e.type,e.status||"N/A",e.pnl,t(e.notes||""),t((e.tags||[]).join("; ")),e.rating||0].join(",")),r=[["ID","Date","Type","Status","P&L","Notes","Tags","Rating"].join(","),...n].join("\n"),s=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(void 0!==i.download){const e=URL.createObjectURL(s);i.setAttribute("href",e),i.setAttribute("download","trading_journal_export.csv"),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}})(le),className:"p-2 rounded-md bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition",title:"Export to CSV",children:(0,mm.jsx)(Wm,{className:"w-5 h-5"})})]})]}),(0,mm.jsx)("div",{className:"overflow-x-auto",children:(0,mm.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,mm.jsx)("thead",{children:(0,mm.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,mm.jsx)("th",{className:"p-2 sm:p-3 font-semibold",children:"Details"}),(0,mm.jsx)("th",{className:"p-2 sm:p-3 font-semibold cursor-pointer",onClick:()=>ce("date"),children:"Date \u21c5"}),(0,mm.jsx)("th",{className:"p-2 sm:p-3 font-semibold",children:"Type"}),(0,mm.jsx)("th",{className:"p-2 sm:p-3 font-semibold",children:"Status"}),(0,mm.jsx)("th",{className:"p-2 sm:p-3 font-semibold cursor-pointer",onClick:()=>ce("pnl"),children:"Amount \u21c5"}),(0,mm.jsx)("th",{className:"p-2 sm:p-3 font-semibold",children:"Actions"})]})}),(0,mm.jsx)("tbody",{children:h?(0,mm.jsx)("tr",{children:(0,mm.jsx)("td",{colSpan:"6",className:"text-center p-8",children:"Loading data..."})}):de.length>0?de.map(e=>(0,mm.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50 cursor-pointer",onClick:()=>_(e),children:[(0,mm.jsx)("td",{className:"p-2 sm:p-3 text-center",children:(e.notes||e.tags&&e.tags.length>0||e.rating>0||e.imageUrl)&&(0,mm.jsx)(Im,{className:"w-5 h-5 text-blue-500 mx-auto"})}),(0,mm.jsx)("td",{className:"p-2 sm:p-3 whitespace-nowrap",children:e.date.toDate().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),(0,mm.jsx)("td",{className:"p-2 sm:p-3 font-semibold "+("Buy"===e.type?"text-green-500":"Sell"===e.type?"text-red-500":"Deposit"===e.type?"text-blue-500":"text-orange-500"),children:e.type}),(0,mm.jsx)("td",{className:"p-2 sm:p-3 font-semibold "+("Win"===e.status?"text-green-500":"Loss"===e.status?"text-red-500":""),children:e.status||"-"}),(0,mm.jsx)("td",{className:"p-2 sm:p-3 font-semibold whitespace-nowrap "+(e.pnl>=0?"text-green-500":"text-red-500"),children:km(e.pnl)}),(0,mm.jsx)("td",{className:"p-2 sm:p-3",children:(0,mm.jsx)("button",{onClick:n=>{n.stopPropagation(),(async(e,n)=>{if(!t)return;const r=`users/${t.uid}/trades`;try{if(await Fp(Rf(vm,r,e)),n){const e=pm(bm,n);await fm(e)}}catch(s){"storage/object-not-found"!==s.code&&console.error("Error deleting transaction or associated image: ",s)}})(e.id,e.imageUrl)},className:"text-gray-500 hover:text-red-500 transition",children:(0,mm.jsx)(Em,{className:"w-5 h-5"})})})]},e.id)):(0,mm.jsx)("tr",{children:(0,mm.jsx)("td",{colSpan:"6",className:"text-center p-8",children:"No matching data found."})})})]})}),ue>1&&(0,mm.jsx)(hy,{currentPage:R,totalPages:ue,onPageChange:D})]})]}),"Analytics"===F&&(0,mm.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,mm.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,mm.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[(0,mm.jsx)("h3",{className:"font-bold text-lg mb-4 text-center",children:"Trading Day Performance"}),(0,mm.jsx)("div",{className:"h-64",children:(0,mm.jsx)(my,{dayPerformance:se.dayPerformance})})]}),(0,mm.jsx)(yy,{stats:se}),(0,mm.jsx)(by,{winRate:se.winRate,avgTradesPerDay:se.avgTradesPerDay})]}),(0,mm.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,mm.jsx)(_y,{monthlyStats:he}),(0,mm.jsx)(ly,{tags:l,transactions:s,onAddTag:Z,onUpdateTag:async(e,n,r)=>{if(!t)return;const s=Rf(vm,`users/${t.uid}/tags`,e);try{await Mp(s,{name:n,color:r})}catch(i){console.error("Error updating tag: ",i)}},onDeleteTag:async e=>{if(!t)return;const n=Rf(vm,`users/${t.uid}/tags`,e);try{await Fp(n)}catch(r){console.error("Error deleting tag: ",r)}}})]})]}),"Chart Analyzer"===F&&(0,mm.jsx)(sy,{user:t}),"Community"===F&&(0,mm.jsx)(iy,{user:t,profileData:u})]}),k&&(0,mm.jsx)(dy,{trade:k,user:t,allTags:l,onAddNewTag:Z,onSave:async e=>{if(!t)return;const n=`users/${t.uid}/trades`,r=Rf(vm,n,e.id),{id:s,...i}=e;try{await Mp(r,i)}catch(a){console.error("Error updating transaction: ",a)}},onCancel:()=>_(null)}),N&&(0,mm.jsx)(vy,{date:N,transactions:s,dailyJournals:a,onSaveJournal:ee,onClose:()=>E(null),onTradeClick:e=>{E(null),_(e)}}),v&&(0,mm.jsx)(xy,{settings:m,onSave:async e=>{if(!t)return void console.error("Cannot save settings, no user logged in.");const n=`users/${t.uid}/profile/settings`;try{await Op(Rf(vm,n),e,{merge:!0}),y(e),b(!1)}catch(r){console.error("Error saving settings to Firestore:",r)}},onCancel:()=>b(!1)}),x&&(0,mm.jsx)(Ny,{user:t,profileData:u,onSave:async e=>{if(!t)return void console.error("Cannot save profile, no user logged in.");const n=`users/${t.uid}/profile/info`;try{await Op(Rf(vm,n),e,{merge:!0}),d(e),w(!1)}catch(r){console.error("Error saving profile to Firestore:",r)}},onCancel:()=>w(!1)}),(0,mm.jsx)(oy,{transactions:s})]})})}const Sy=e=>{let{onCancel:t}=e;const[n,s]=(0,r.useState)(""),[i,a]=(0,r.useState)(""),[o,l]=(0,r.useState)("");return(0,mm.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:(0,mm.jsxs)("div",{className:"w-full max-w-md p-8 space-y-8 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[(0,mm.jsxs)("div",{className:"flex justify-between items-center",children:[(0,mm.jsx)("h2",{className:"text-2xl font-extrabold text-gray-900 dark:text-white",children:"Reset Password"}),(0,mm.jsx)("button",{onClick:t,className:"text-gray-500 hover:text-gray-800 dark:hover:text-white",children:(0,mm.jsx)(Am,{className:"w-6 h-6"})})]}),o?(0,mm.jsxs)("div",{className:"text-center",children:[(0,mm.jsx)("p",{className:"text-green-500",children:o}),(0,mm.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"Check spam email if not in main inbox."})]}):(0,mm.jsxs)("form",{className:"space-y-6",onSubmit:async e=>{e.preventDefault(),a(""),l("");try{await async function(e,t,n){const r=Tn(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&gr(r,s,n),await Mn(r,s,"getOobCode",Wn,"EMAIL_PASSWORD_PROVIDER")}(xm,n),l("Password reset email sent!")}catch(t){a("Failed to send password reset email. Please check the address."),console.error("Password reset error:",t)}},children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"email-address-reset",className:"sr-only",children:"Email address"}),(0,mm.jsx)("input",{id:"email-address-reset",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:e=>s(e.target.value),className:"appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 text-gray-900 dark:text-white dark:bg-gray-700 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter your email address"})]}),i&&(0,mm.jsx)("p",{className:"text-sm text-red-500 text-center",children:i}),(0,mm.jsx)("div",{children:(0,mm.jsx)("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Send Reset Link"})})]})]})})};function Ty(){const[e,t]=(0,r.useState)(""),[n,s]=(0,r.useState)(""),[i,a]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1);return(0,mm.jsxs)(mm.Fragment,{children:[(0,mm.jsx)("div",{className:"bg-gray-100 dark:bg-gray-900 min-h-screen flex items-center justify-center",children:(0,mm.jsxs)("div",{className:"w-full max-w-md p-8 space-y-8 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[(0,mm.jsx)("div",{children:(0,mm.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Sign in to your account"})}),(0,mm.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{t.preventDefault(),a("");try{await function(e,t,n){return Qe(e.app)?Promise.reject(xt(e)):pr(M(e),er.credential(t,n)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&mr(e),t})}(xm,e,n)}catch(r){"auth/invalid-credential"===r.code||"auth/wrong-password"===r.code||"auth/user-not-found"===r.code?a("Wrong email or password."):(a("An error occurred. Please try again."),console.error("Authentication error:",r))}},children:[(0,mm.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),(0,mm.jsx)("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 text-gray-900 dark:text-white dark:bg-gray-700 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),(0,mm.jsxs)("div",{children:[(0,mm.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,mm.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:n,onChange:e=>s(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 text-gray-900 dark:text-white dark:bg-gray-700 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),(0,mm.jsx)("div",{className:"flex items-center justify-end",children:(0,mm.jsx)("div",{className:"text-sm",children:(0,mm.jsx)("button",{type:"button",onClick:()=>l(!0),className:"font-medium text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300",children:"Forgot your password?"})})}),i&&(0,mm.jsx)("p",{className:"text-sm text-red-500 text-center",children:i}),(0,mm.jsx)("div",{children:(0,mm.jsx)("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Sign in"})})]})]})}),o&&(0,mm.jsx)(Sy,{onCancel:()=>l(!1)})]})}function Cy(){const[e,t]=(0,r.useState)(null),[n,s]=(0,r.useState)(!0);(0,r.useEffect)(()=>{const e=function(e,t,n,r){return M(e).onAuthStateChanged(t,n,r)}(xm,e=>{t(e),s(!1)});return()=>e()},[]);return n?(0,mm.jsx)("div",{className:"bg-gray-100 dark:bg-gray-900 min-h-screen flex items-center justify-center",children:(0,mm.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading..."})}):e?(0,mm.jsx)(Ey,{user:e,handleLogout:async()=>{try{await function(e){return M(e).signOut()}(xm)}catch(e){console.error("Error signing out: ",e)}}}):(0,mm.jsx)(Ty,{})}s.createRoot(document.getElementById("root")).render((0,mm.jsx)(r.StrictMode,{children:(0,mm.jsx)(Cy,{})}))})();
//# sourceMappingURL=main.e445b715.js.map